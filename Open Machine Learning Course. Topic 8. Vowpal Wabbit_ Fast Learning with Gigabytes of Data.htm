<!DOCTYPE html>
<!-- saved from url=(0148)https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-8-vowpal-wabbit-fast-learning-with-gigabytes-of-data-60f750086237 -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data</title><link rel="canonical" href="https://gist.github.com/Yorko/bf41c3be2d0b9ef55dbbfb6b58cf942b"><meta name="title" content="Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data"><meta name="referrer" content="always"><meta name="description" content="This week, we’ll cover two reasons for Vowpal Wabbit’s exceptional training speed, namely, online learning and hashing trick, in both theory and practice. We will try it out with news, movie reviews…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data"><meta property="og:url" content="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-8-vowpal-wabbit-fast-learning-with-gigabytes-of-data-60f750086237"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*OYzZCTaTs41J4NyTTjBdHw.png"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="This week, we’ll cover two reasons for Vowpal Wabbit’s exceptional training speed, namely, online learning and hashing trick, in both…"><meta name="twitter:description" content="This week, we’ll cover two reasons for Vowpal Wabbit’s exceptional training speed, namely, online learning and hashing trick, in both…"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*OYzZCTaTs41J4NyTTjBdHw.png"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@yurykashnitskiy"><meta property="author" content="Yury Kashnitskiy"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Yury Kashnitskiy"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2018-04-02T10:55:38.059Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="20 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/60f750086237"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/60f750086237"><meta property="al:android:url" content="medium://p/60f750086237"><meta property="al:web:url" content="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-8-vowpal-wabbit-fast-learning-with-gigabytes-of-data-60f750086237"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/60f750086237"><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":400,"height":300,"url":"https://cdn-images-1.medium.com/max/800/1*OYzZCTaTs41J4NyTTjBdHw.png"},"datePublished":"2018-04-02T10:55:38.059Z","dateModified":"2018-05-07T20:47:24.415Z","headline":"Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data","name":"Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data","keywords":["Machine Learning","Data Science","Education","Python","Algorithms"],"author":{"@type":"Person","name":"Yury Kashnitskiy","url":"https://medium.com/@yurykashnitskiy"},"creator":["Yury Kashnitskiy"],"publisher":{"@type":"Organization","name":"Open Machine Learning Course","url":"https://medium.com/open-machine-learning-course","logo":{"@type":"ImageObject","width":107,"height":60,"url":"https://cdn-images-1.medium.com/max/214/1*MxsqShnPs3RXMScwl5HhsQ.jpeg"}},"mainEntityOfPage":"https://gist.github.com/Yorko/bf41c3be2d0b9ef55dbbfb6b58cf942b"}</script><link rel="stylesheet" type="text/css" id="glyph-8" href="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/m2.css"><link rel="stylesheet" href="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/main-branding-base.cbTc2bTSptidNvlM50PkCQ.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async="" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="apple-touch-icon" sizes="60x60" href="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome os-mac is-withMagicUnderlinesv-glyph v-glyph--m2 is-js is-withMagicUnderlines" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1525771858876" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1680" height="932"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><div class="metabar u-clearfix js-metabar is-hiddenWhenMinimized metabar--affixed is-maximized"><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1000 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingLeft20 u-paddingRight20"><div class="metabar-block u-flex1  u-flexCenter"><div class="js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-textColorDarker"><svg class="svgIcon-use" width="45" height="45" viewBox="0 0 45 45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56"><div class="u-alignBlock"><span class="u-inlineBlock u-height28 u-xs-height24 u-verticalAlignTop u-marginRight20 u-marginLeft15 u-borderRightLighter"></span></div></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56 u-marginRight18"><div class="u-alignBlock"><a class="js-collectionLogoOrName" href="https://medium.com/open-machine-learning-course?source=logo-a988255767e5---b76595fb6cfc"><img height="36" width="65" class="u-paddingTop5" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_MxsqShnPs3RXMScwl5HhsQ.jpeg" alt="Open Machine Learning Course"></a></div></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56 u-xs-hide"><div class="u-alignBlock"><div class="buttonSet"><button class="button button--primary button--filled button--smallest button--withChrome u-accentColor--buttonNormal button--withIcon button--withSvgIcon button--withIconRight button--withIconAndLabel js-relationshipButton is-smallPill" data-action="show-more-collection-actions" data-action-value="affixMenu" data-collection-id="b76595fb6cfc"><span class="button-label  js-buttonLabel">Following</span><span class="svgIcon svgIcon--arrowDown svgIcon--11px u-relative u-top1 u-paddingLeft6"><svg class="svgIcon-use" width="11" height="11" viewBox="0 0 11 11"><path d="M0 2.77l5.095 5.648.427.472.427-.472L10.99 2.83l-.85-.77-4.618 5.142L.85 2z" fill-rule="evenodd"></path></svg></span></button><a class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon" href="https://twitter.com/odsai_en" title="Visit “Open Machine Learning Course” on Twitter" aria-label="Visit “Open Machine Learning Course” on Twitter" rel="me" target="_blank"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></span></a><a class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-paddingLeft0" href="https://facebook.com/DataChallenges" title="Visit “Open Machine Learning Course” on Facebook" aria-label="Visit “Open Machine Learning Course” on Facebook" rel="me" target="_blank"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21 12.646C21 7.65 16.97 3.6 12 3.6s-9 4.05-9 9.046a9.026 9.026 0 0 0 7.59 8.924v-6.376H8.395V12.64h2.193v-1.88c0-2.186 1.328-3.375 3.267-3.375.93 0 1.728.07 1.96.1V9.77H14.47c-1.055 0-1.26.503-1.26 1.242v1.63h2.517l-.33 2.554H13.21V21.6c4.398-.597 7.79-4.373 7.79-8.954"></path></svg></span></span></a></div></div></div></div><div class="metabar-block u-flex0 u-flexCenter"><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56"><div class="u-alignBlock"><div class="buttonSet buttonSet--wide u-lineHeightInherit"><label class="button button--chromeless inputGroup u-sm-hide metabar-predictiveSearch u-baseColor--buttonNormal u-baseColor--placeholderNormal" title="Search"><span class="svgIcon svgIcon--search svgIcon--25px u-top0 u-baseColor--iconLight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span><input class="js-predictiveSearchInput textInput textInput--rounded textInput--darkText u-baseColor--textNormal textInput--transparent" type="search" placeholder="Search" required="true" data-collection-id="b76595fb6cfc"></label><a class="button button--small button--chromeless u-sm-show is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-xs-top2" href="https://medium.com/open-machine-learning-course/search" title="Search" aria-label="Search"><span class="button-defaultState"><span class="svgIcon svgIcon--search svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span></span></a><button class="button button--small button--chromeless is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--activity js-notificationsButton u-marginRight16 u-xs-marginRight5 u-lineHeight0 u-size25x25" title="Notifications" aria-label="Notifications" data-action="open-notifications"><span class="svgIcon svgIcon--bell svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-293 409 25 25"><path d="M-273.327 423.67l-1.673-1.52v-3.646a5.5 5.5 0 0 0-6.04-5.474c-2.86.273-4.96 2.838-4.96 5.71v3.41l-1.68 1.553c-.204.19-.32.456-.32.734V427a1 1 0 0 0 1 1h3.49a3.079 3.079 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59c0-.28-.12-.55-.327-.74zm-7.173 5.63c-.842 0-1.55-.546-1.812-1.3h3.624a1.92 1.92 0 0 1-1.812 1.3zm6.35-2.45h-12.7v-2.347l1.63-1.51c.236-.216.37-.522.37-.843v-3.41c0-2.35 1.72-4.356 3.92-4.565a4.353 4.353 0 0 1 4.78 4.33v3.645c0 .324.137.633.376.85l1.624 1.477v2.373z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-marginLeft4 is-inSiteNavBar js-userActions" aria-haspopup="true" data-action="open-userActions"><div class="avatar"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_P-t7h_lDOjJiWVxI" class="avatar-image avatar-image--icon" alt="陈辰"></div></button></div></div></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors" lang="en"><header class="container u-maxWidth740"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaLockup postMetaLockup--authorWithBio u-flexCenter js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@yurykashnitskiy?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="5572ec600139" data-action-type="hover" data-user-id="5572ec600139" dir="auto"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_JtleyoApNKIjJU5F" class="avatar-image avatar-image--small" alt="Go to the profile of Yury Kashnitskiy"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-lineHeightTightest"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker" href="https://medium.com/@yurykashnitskiy?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="5572ec600139" data-action-type="hover" data-user-id="5572ec600139" dir="auto">Yury Kashnitskiy</a><span class="followState js-followState" data-user-id="5572ec600139"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide" data-action="toggle-block-user" data-action-value="5572ec600139" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-xs-hide" data-action="toggle-subscribe-user" data-action-value="5572ec600139" data-action-source="post_header_lockup-5572ec600139-------------------------follow_byline" data-subscribe-source="post_header_lockup" data-follow-context-entity-id="60f750086237"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption ui-xs-clamp2 postMetaInline">Data Scientist at Mail.Ru Group</div><div class="ui-caption postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2018-04-02T10:55:38.059Z">Apr 2</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="20 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="60f750086237" data-source="post_page" data-collection-id="b76595fb6cfc" data-tracking-context="postPage" data-scroll="native"><section name="7e10" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="beb0" id="beb0" class="graf graf--h3 graf--leading graf--title">Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of&nbsp;Data</h1><figure name="808f" id="808f" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 400px; max-height: 300px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*OYzZCTaTs41J4NyTTjBdHw.png" data-width="400" data-height="300" data-is-featured="true" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_OYzZCTaTs41J4NyTTjBdHw.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*OYzZCTaTs41J4NyTTjBdHw.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_OYzZCTaTs41J4NyTTjBdHw(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*OYzZCTaTs41J4NyTTjBdHw.png"></noscript></div></div></figure><p name="1d93" id="1d93" class="graf graf--p graf-after--figure">This week, we’ll cover two reasons for Vowpal Wabbit’s exceptional training speed, namely, online learning and hashing trick, in both theory and practice. We will try it out with news, movie reviews, and StackOverflow questions.</p><h3 name="5b90" id="5b90" class="graf graf--h3 graf-after--p">Outline</h3><ol class="postList"><li name="8a76" id="8a76" class="graf graf--li graf-after--h3">Stochastic gradient descent and online learning</li></ol><ul class="postList"><li name="9613" id="9613" class="graf graf--li graf-after--li">1.1. SGD</li><li name="c0c1" id="c0c1" class="graf graf--li graf-after--li">1.2. Online approach to learning</li></ul><p name="543e" id="543e" class="graf graf--p graf-after--li">2. Categorical data processing: Label Encoding, One-Hot Encoding, Hashing trick</p><ul class="postList"><li name="997b" id="997b" class="graf graf--li graf-after--p">2.1. Label Encoding</li><li name="9a91" id="9a91" class="graf graf--li graf-after--li">2.2. One-Hot Encoding</li><li name="a11c" id="a11c" class="graf graf--li graf-after--li">2.3. Hashing trick</li></ul><p name="d332" id="d332" class="graf graf--p graf-after--li">3. Vowpal Wabbit</p><ul class="postList"><li name="a1bb" id="a1bb" class="graf graf--li graf-after--p">3.1. News. Binary classification</li><li name="476f" id="476f" class="graf graf--li graf-after--li">3.2. News. Multiclass classification</li><li name="8103" id="8103" class="graf graf--li graf-after--li">3.3. IMDB reviews</li><li name="e738" id="e738" class="graf graf--li graf-after--li">3.4. Classifying gigabytes of StackOverflow questions</li></ul><p name="6f25" id="6f25" class="graf graf--p graf-after--li">4. Assignment #8</p><p name="e9ae" id="e9ae" class="graf graf--p graf-after--p">5. Useful resources</p><p name="82f8" id="82f8" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">The following content is better viewed and reproduced as a </em><a href="http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic08_sgd_hashing_vowpal_wabbit/topic8_sgd_hashing_vowpal_wabbit.ipynb?flush_cache=true" data-href="http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic08_sgd_hashing_vowpal_wabbit/topic8_sgd_hashing_vowpal_wabbit.ipynb?flush_cache=true" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank"><em class="markup--em markup--p-em">Jupyter-notebook</em></a><em class="markup--em markup--p-em"> or a </em><a href="https://www.kaggle.com/kashnitsky/vowpal-wabbit-tutorial-blazingly-fast-learning" data-href="https://www.kaggle.com/kashnitsky/vowpal-wabbit-tutorial-blazingly-fast-learning" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Kaggle kernel</em></a><em class="markup--em markup--p-em">.</em></p><h3 name="0726" id="0726" class="graf graf--h3 graf-after--p">1. Stochastic gradient descent and online&nbsp;learning</h3><h3 name="c0e9" id="c0e9" class="graf graf--h3 graf-after--h3">1.1. Stochastic gradient&nbsp;descent</h3><p name="86f0" id="86f0" class="graf graf--p graf-after--h3">Despite the fact that gradient descent is one of the first things learned in machine learning and optimization courses, it is one of its modifications, Stochastic Gradient Descent (SGD), that is hard to top.</p><p name="6d3c" id="6d3c" class="graf graf--p graf-after--p">Recall that the idea of gradient descent is to minimize some function by making small steps in the direction of the fastest decrease. This method was named due to the following fact from calculus: vector</p><figure name="58db" id="58db" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 336px; max-height: 80px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 23.799999999999997%;"></div><img class="graf-image" data-image-id="1*VOJCm7l4-nm1bOnxBWf_pw.png" data-width="336" data-height="80" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_VOJCm7l4-nm1bOnxBWf_pw.png"></div></figure><p name="38ba" id="38ba" class="graf graf--p graf-after--figure">of partial derivatives of the function f(x) = f(x1,&nbsp;…, xn) points to the direction of the fastest function growth. It means that, by moving in the opposite direction (antigradient), it is possible to decrease the function value with the fastest rate.</p><figure name="eb42" id="eb42" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 394px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*tTTrP_gLIMONG55t.jpg" data-width="1280" data-height="720" data-action="zoom" data-action-value="0*tTTrP_gLIMONG55t.jpg" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_tTTrP_gLIMONG55t.jpg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="41"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*tTTrP_gLIMONG55t.jpg" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_tTTrP_gLIMONG55t(1).jpg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*tTTrP_gLIMONG55t.jpg"></noscript></div></div><figcaption class="imageCaption">A snowboarder (me) in Sheregesh, Russia’s most popular winter resort. Highly recommended it if you like skiing or snowboarding.</figcaption></figure><p name="dbde" id="dbde" class="graf graf--p graf-after--figure">In addition to advertising beautiful landscapes, this picture depicts the idea of gradient descent. If you want to ride as fast as possible, you need to choose the path of steepest descent. Calculating antigradients can be seen as evaluating the slope at various spots.</p><p name="09da" id="09da" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Example</strong></p><p name="02ee" id="02ee" class="graf graf--p graf-after--p">The paired regression problem can be solved with gradient descent. Let us predict one variable using another: height with weight. Assume that these variables are linearly dependent. We will use the <a href="http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data" data-href="http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">SOCR</a> dataset.</p><figure name="5059" id="5059" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 59.571%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/2f3f305f3fccf2b03c3f389bd62ec880?postId=60f750086237" data-media-id="2f3f305f3fccf2b03c3f389bd62ec880" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/2f3f305f3fccf2b03c3f389bd62ec880.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/2f3f305f3fccf2b03c3f389bd62ec880?postId=60f750086237" data-media-id="2f3f305f3fccf2b03c3f389bd62ec880" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="86fc" id="86fc" class="graf graf--figure graf--iframe graf-after--figure"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 25%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/ea80c6b8cb6cbf04e81cc15dc3238c34?postId=60f750086237" data-media-id="ea80c6b8cb6cbf04e81cc15dc3238c34" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/ea80c6b8cb6cbf04e81cc15dc3238c34.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/ea80c6b8cb6cbf04e81cc15dc3238c34?postId=60f750086237" data-media-id="ea80c6b8cb6cbf04e81cc15dc3238c34" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="ac93" id="ac93" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 381px; max-height: 261px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*8W7KT3ApZhiuu9GqRFUSVQ.png" data-width="381" data-height="261" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_8W7KT3ApZhiuu9GqRFUSVQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="51"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*8W7KT3ApZhiuu9GqRFUSVQ.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_8W7KT3ApZhiuu9GqRFUSVQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*8W7KT3ApZhiuu9GqRFUSVQ.png"></noscript></div></div></figure><p name="8ef9" id="8ef9" class="graf graf--p graf-after--figure">Here we have a vector <em class="markup--em markup--p-em">x </em>of dimension ℓ (weight of every person i.e. training sample) and <em class="markup--em markup--p-em">y</em>, a vector containing the height of every person in the dataset.</p><p name="118e" id="118e" class="graf graf--p graf-after--p">The task is the following: find weights <em class="markup--em markup--p-em">w0</em> and <em class="markup--em markup--p-em">w1</em> such that predicting height as <em class="markup--em markup--p-em">yi = w0 + w_1 xi</em> (where <em class="markup--em markup--p-em">yi</em> is <em class="markup--em markup--p-em">i</em>-th height value, <em class="markup--em markup--p-em">xi</em> is <em class="markup--em markup--p-em">i</em>-th weight value) minimizes the squared error (as well as mean squared error since 1/ℓ doesn’t make any difference):</p><figure name="8079" id="8079" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 101px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 14.499999999999998%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*m0ZHOM7spOMZUICtenyxfQ.png" data-width="1436" data-height="208" data-action="zoom" data-action-value="1*m0ZHOM7spOMZUICtenyxfQ.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_m0ZHOM7spOMZUICtenyxfQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="10"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*m0ZHOM7spOMZUICtenyxfQ.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_m0ZHOM7spOMZUICtenyxfQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*m0ZHOM7spOMZUICtenyxfQ.png"></noscript></div></div></figure><p name="aa27" id="aa27" class="graf graf--p graf-after--figure">We will use gradient descent, utilizing the partial derivatives of <em class="markup--em markup--p-em">SE(w0,w1)</em> over weights <em class="markup--em markup--p-em">w0</em> and <em class="markup--em markup--p-em">w1</em>. An iterative training procedure is then defined by simple update formulas (we change model weights in small steps, proportional to a small constant <em class="markup--em markup--p-em">η</em>, towards the antigradient of the function <em class="markup--em markup--p-em">SE(w0, w1))</em>:</p><figure name="7b31" id="7b31" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 485px; max-height: 202px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*EDPZnoeEi7C4kIW1fBp72w.png" data-width="485" data-height="202" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_EDPZnoeEi7C4kIW1fBp72w.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="30"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*EDPZnoeEi7C4kIW1fBp72w.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_EDPZnoeEi7C4kIW1fBp72w(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*EDPZnoeEi7C4kIW1fBp72w.png"></noscript></div></div></figure><p name="a34e" id="a34e" class="graf graf--p graf-after--figure">Computing the partial derivatives, we get the following:</p><figure name="f1cf" id="f1cf" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 598px; max-height: 110px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 18.4%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*395VXoPthjuRf3AVO7Z6fQ.png" data-width="598" data-height="110" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_395VXoPthjuRf3AVO7Z6fQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="13"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*395VXoPthjuRf3AVO7Z6fQ.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_395VXoPthjuRf3AVO7Z6fQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*395VXoPthjuRf3AVO7Z6fQ.png"></noscript></div></div></figure><p name="f38d" id="f38d" class="graf graf--p graf-after--figure">This math works quite well as long as the amount of data is not large (we will not discuss issues with local minima, saddle points, choosing the learning rate, moments and other stuff – these topics are covered very thoroughly in <a href="http://www.deeplearningbook.org/contents/numerical.html" data-href="http://www.deeplearningbook.org/contents/numerical.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">the Numeric Computation chapter</a> in “Deep Learning”). There is an issue with batch gradient descent — the gradient evaluation requires the summation of a number of values for every object from the training set. In other words, the algorithm requires a lot of iterations, and every iteration recomputes weights with formula which contains a sum over the whole training set. What happens when we have billions of training samples?</p><figure name="894a" id="894a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 600px; max-height: 336px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.00000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*HhCeBJdPY4OH1my-.jpeg" data-width="600" data-height="336" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_HhCeBJdPY4OH1my-.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="41"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*HhCeBJdPY4OH1my-.jpeg" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_HhCeBJdPY4OH1my-(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*HhCeBJdPY4OH1my-.jpeg"></noscript></div></div></figure><p name="4295" id="4295" class="graf graf--p graf-after--figure">Hence the motivation for stochastic gradient descent! Simply put, we throw away the summation sign and update the weights only over single training samples (or a small number of them). In our case, we have the following:</p><figure name="f860" id="f860" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 513px; max-height: 120px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 23.400000000000002%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*Hk42uEbVu1MbqbUBbyZWEQ.png" data-width="513" data-height="120" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_Hk42uEbVu1MbqbUBbyZWEQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="17"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*Hk42uEbVu1MbqbUBbyZWEQ.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_Hk42uEbVu1MbqbUBbyZWEQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*Hk42uEbVu1MbqbUBbyZWEQ.png"></noscript></div></div></figure><p name="b999" id="b999" class="graf graf--p graf-after--figure">With this approach, there is no guarantee that we will move in best possible direction at every iteration. Therefore, we may need many more iterations, but we get much faster weight updates.</p><p name="28d5" id="28d5" class="graf graf--p graf-after--p">Andrew Ng has a good illustration of this in his <a href="https://www.coursera.org/learn/machine-learning" data-href="https://www.coursera.org/learn/machine-learning" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">machine learning course</a>. Let’s take a look.</p><figure name="b4d1" id="b4d1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 388px; max-height: 309px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 79.60000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*o692cOFyNxfJzYSL.png" data-width="388" data-height="309" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_o692cOFyNxfJzYSL.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="58"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*o692cOFyNxfJzYSL.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_o692cOFyNxfJzYSL(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*o692cOFyNxfJzYSL.png"></noscript></div></div></figure><p name="97d8" id="97d8" class="graf graf--p graf-after--figure">These are the contour plots for some function, and we want to find the global minimum of this function. The red curve shows weight changes (in this picture, <em class="markup--em markup--p-em">θ0</em> and <em class="markup--em markup--p-em">θ1</em> correspond to our <em class="markup--em markup--p-em">w0</em> and <em class="markup--em markup--p-em">w1</em>). According to the properties of a gradient, the direction of change at every point is orthogonal to contour plots. With stochastic gradient descent, weights are changing in a less predictable manner, and it even may seem that some steps are wrong by leading away from minima; however, both procedures converge to the same solution.</p><h3 name="abf1" id="abf1" class="graf graf--h3 graf-after--p">1.2. Online approach to&nbsp;learning</h3><p name="cade" id="cade" class="graf graf--p graf-after--h3">Stochastic gradient descent gives us practical guidance for training both classifiers and regressors with large amounts of data up to hundreds of GBs (depending on computational resources).</p><p name="7367" id="7367" class="graf graf--p graf-after--p">Considering the case of paired regression, we can store the training data set <em class="markup--em markup--p-em">(X,y)</em> in HDD without loading it into RAM (where it simply won’t fit), read objects one by one, and update the weights of our model:</p><figure name="f33d" id="f33d" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 513px; max-height: 120px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 23.400000000000002%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*Hk42uEbVu1MbqbUBbyZWEQ.png" data-width="513" data-height="120" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_Hk42uEbVu1MbqbUBbyZWEQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="17"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*Hk42uEbVu1MbqbUBbyZWEQ.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_Hk42uEbVu1MbqbUBbyZWEQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*Hk42uEbVu1MbqbUBbyZWEQ.png"></noscript></div></div></figure><p name="1f39" id="1f39" class="graf graf--p graf-after--figure">After working through the whole training dataset, our loss function (for example, quadratic squared root error in regression or logistic loss in classification) will decrease, but it usually takes dozens of passes over the training set to make the loss small enough.</p><p name="6d9c" id="6d9c" class="graf graf--p graf-after--p">This approach to learning is called <strong class="markup--strong markup--p-strong">online learning</strong>, and this name emerged even before machine learning MOOC-s turned mainstream.</p><figure name="8415" id="8415" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 437px; max-height: 484px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 110.80000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*xuawoa5-SB2JAxOxVtLmrA.jpeg" data-width="437" data-height="484" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_xuawoa5-SB2JAxOxVtLmrA.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="68" height="75"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*xuawoa5-SB2JAxOxVtLmrA.jpeg" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_xuawoa5-SB2JAxOxVtLmrA(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*xuawoa5-SB2JAxOxVtLmrA.jpeg"></noscript></div></div></figure><p name="f2d8" id="f2d8" class="graf graf--p graf-after--figure">We did not discuss many specifics about SGD here. If you want dive into theory, I highly recommend <a href="https://www.amazon.com/Convex-Optimization-Stephen-Boyd/dp/0521833787" data-href="https://www.amazon.com/Convex-Optimization-Stephen-Boyd/dp/0521833787" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">“Convex Optimization” by Stephen Boyd</a>. Now, we will introduce the Vowpal Wabbit library, which is good for training simple models with huge data sets thanks to stochastic optimization and another trick, feature hashing.</p><p name="c21d" id="c21d" class="graf graf--p graf-after--p">In scikit-learn, classifiers and regressors trained with SGD are named <code class="markup--code markup--p-code">SGDClassifier</code> and <code class="markup--code markup--p-code">SGDRegressor</code> in <code class="markup--code markup--p-code">sklearn.linear_model</code>. These are nice implementations of SGD, but we'll focus on VW since it is more performant than sklearn's SGD models in many aspects.</p><h3 name="3671" id="3671" class="graf graf--h3 graf-after--p">2. Categorical feature processing: Label Encoding, One-Hot Encoding, and Hashing&nbsp;trick</h3><p name="2552" id="2552" class="graf graf--p graf-after--h3">Many classification and regression algorithms operate in Euclidean or metric space, implying that data is represented with vectors of real numbers. However, in real data, we often have categorical features with discrete values such as yes/no or January/February/…/December. We will see how to process this kind of data, particularly with linear models, and how to deal with many categorial features even when they have many unique values.</p><p name="abed" id="abed" class="graf graf--p graf-after--p">Let’s explore the <a href="https://archive.ics.uci.edu/ml/datasets/bank+marketing" data-href="https://archive.ics.uci.edu/ml/datasets/bank+marketing" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">UCI bank marketing dataset</a> where most of features are categorial. Actually, more features are present in this dataset, explore <a href="http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic08_sgd_hashing_vowpal_wabbit/topic8_sgd_hashing_vowpal_wabbit.ipynb?flush_cache=true" data-href="http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic08_sgd_hashing_vowpal_wabbit/topic8_sgd_hashing_vowpal_wabbit.ipynb?flush_cache=true" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this</a> Jupyter notebook.</p><figure name="bd6a" id="bd6a" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/32d2e16419d4f21256b402cfe0e5170b?postId=60f750086237" data-media-id="32d2e16419d4f21256b402cfe0e5170b" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/32d2e16419d4f21256b402cfe0e5170b.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/32d2e16419d4f21256b402cfe0e5170b?postId=60f750086237" data-media-id="32d2e16419d4f21256b402cfe0e5170b" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="60aa" id="60aa" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 207px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.599999999999998%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*-PNu9d3xC1gZi6M7l-eNrA.png" data-width="2224" data-height="658" data-action="zoom" data-action-value="1*-PNu9d3xC1gZi6M7l-eNrA.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_-PNu9d3xC1gZi6M7l-eNrA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="21"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*-PNu9d3xC1gZi6M7l-eNrA.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_-PNu9d3xC1gZi6M7l-eNrA(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*-PNu9d3xC1gZi6M7l-eNrA.png"></noscript></div></div></figure><p name="9b02" id="9b02" class="graf graf--p graf-after--figure">We can see that most of features are not represented by numbers. This poses a problem because we cannot use most machine learning methods (at least those implemented in <code class="markup--code markup--p-code">scikit-learn</code>) out-of-the-box.</p><p name="ac63" id="ac63" class="graf graf--p graf-after--p">Let’s dive into the “education” feature.</p><pre name="ffbc" id="ffbc" class="graf graf--pre graf-after--p">df['education'].value_counts().plot.barh();</pre><figure name="d88b" id="d88b" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 443px; max-height: 247px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 55.800000000000004%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*qQ9uuhYJYeLDGONr4n6S3g.png" data-width="443" data-height="247" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_qQ9uuhYJYeLDGONr4n6S3g.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="41"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*qQ9uuhYJYeLDGONr4n6S3g.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_qQ9uuhYJYeLDGONr4n6S3g(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*qQ9uuhYJYeLDGONr4n6S3g.png"></noscript></div></div></figure><p name="b48b" id="b48b" class="graf graf--p graf-after--figure">The most straightforward solution is to map each value of this feature into a unique number. For example, we can map <code class="markup--code markup--p-code">university.degree</code> to 0, <code class="markup--code markup--p-code">basic.9y</code> to 1, and so on. You can use <code class="markup--code markup--p-code">sklearn.preprocessing.LabelEncoder</code> to perform this mapping.</p><pre name="ae7f" id="ae7f" class="graf graf--pre graf-after--p">label_encoder = LabelEncoder()</pre><p name="f456" id="f456" class="graf graf--p graf-after--pre">The <code class="markup--code markup--p-code">fit</code> method of this class finds all unique values and builds the actual mapping between categories and numbers, and the <code class="markup--code markup--p-code">transform</code> method converts the categories into numbers. After <code class="markup--code markup--p-code">fit</code> is executed, <code class="markup--code markup--p-code">label_encoder</code> will have the <code class="markup--code markup--p-code">classes_</code> attribute with all unique values of the feature. Let us count them to make sure the transformation was correct.</p><figure name="6779" id="6779" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 18.714%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/3a2c5d6e3ed2ebd79c8c54b7d9dd4863?postId=60f750086237" data-media-id="3a2c5d6e3ed2ebd79c8c54b7d9dd4863" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/3a2c5d6e3ed2ebd79c8c54b7d9dd4863.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/3a2c5d6e3ed2ebd79c8c54b7d9dd4863?postId=60f750086237" data-media-id="3a2c5d6e3ed2ebd79c8c54b7d9dd4863" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="6391" id="6391" class="graf graf--pre graf-after--figure"><code class="markup--code markup--pre-code"># Output:<br> <br>{0: 'basic.4y', 1: 'basic.6y', 2: 'basic.9y', 3: 'high.school', 4: 'illiterate', 5: 'professional.course', 6: 'university.degree', 7: 'unknown'}</code></pre><pre name="7ef6" id="7ef6" class="graf graf--pre graf-after--pre">df['education'] = mapped_education df.head()</pre><figure name="455d" id="455d" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 209px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*LiRc1fhg7Rtd3bx1MxrMHQ.png" data-width="2094" data-height="626" data-action="zoom" data-action-value="1*LiRc1fhg7Rtd3bx1MxrMHQ.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_LiRc1fhg7Rtd3bx1MxrMHQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="21"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*LiRc1fhg7Rtd3bx1MxrMHQ.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_LiRc1fhg7Rtd3bx1MxrMHQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*LiRc1fhg7Rtd3bx1MxrMHQ.png"></noscript></div></div></figure><p name="a3ec" id="a3ec" class="graf graf--p graf-after--figure">Let’s apply the transformation to other columns of type <code class="markup--code markup--p-code">object</code>.</p><figure name="e432" id="e432" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/efd03e7666cc944267511390b950715c?postId=60f750086237" data-media-id="efd03e7666cc944267511390b950715c" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/efd03e7666cc944267511390b950715c.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/efd03e7666cc944267511390b950715c?postId=60f750086237" data-media-id="efd03e7666cc944267511390b950715c" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="4ebc" id="4ebc" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 242px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.599999999999994%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*oLYzIbspnplCxuedwnYOZQ.png" data-width="1844" data-height="638" data-action="zoom" data-action-value="1*oLYzIbspnplCxuedwnYOZQ.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_oLYzIbspnplCxuedwnYOZQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="25"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*oLYzIbspnplCxuedwnYOZQ.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_oLYzIbspnplCxuedwnYOZQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*oLYzIbspnplCxuedwnYOZQ.png"></noscript></div></div></figure><p name="cedd" id="cedd" class="graf graf--p graf-after--figure">The main issue with this approach is that we have now introduced some relative ordering where it might not exist.</p><p name="16e1" id="16e1" class="graf graf--p graf-after--p">For example, we implicitly introduced algebra over the values of the job feature where we can now substract the job of client #2 from the job of client #1&nbsp;:</p><pre name="369e" id="369e" class="graf graf--pre graf-after--p">df.loc[1].job - df.loc[2].job<br><code class="markup--code markup--pre-code"># -1.0</code></pre><p name="a89a" id="a89a" class="graf graf--p graf-after--pre">Does this operation make any sense? Not really. Let’s try to train logisitic regression with this feature transformation.</p><figure name="c323" id="c323" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/24a1afa55e36742957d5b9260866e5b7?postId=60f750086237" data-media-id="24a1afa55e36742957d5b9260866e5b7" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/24a1afa55e36742957d5b9260866e5b7.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/24a1afa55e36742957d5b9260866e5b7?postId=60f750086237" data-media-id="24a1afa55e36742957d5b9260866e5b7" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="2a05" id="2a05" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 162px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 23.200000000000003%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*QWZq5rCEPFREdnYOa48ipA.png" data-width="1838" data-height="426" data-action="zoom" data-action-value="1*QWZq5rCEPFREdnYOa48ipA.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_QWZq5rCEPFREdnYOa48ipA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="16"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*QWZq5rCEPFREdnYOa48ipA.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_QWZq5rCEPFREdnYOa48ipA(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*QWZq5rCEPFREdnYOa48ipA.png"></noscript></div></div></figure><p name="c9b7" id="c9b7" class="graf graf--p graf-after--figure">We can see that logistic regression never predicts class 1. In order to use linear models with categorial features, we will use a different approach: One-Hot Encoding.</p><h3 name="fadb" id="fadb" class="graf graf--h3 graf-after--p">2.2. One-Hot&nbsp;Encoding</h3><p name="35cc" id="35cc" class="graf graf--p graf-after--h3">Suppose that some feature can have one of 10 unique values. One-hot encoding creates 10 new features corresponding to these unique values, all of them <em class="markup--em markup--p-em">except one</em> are zeros.</p><figure name="5c8d" id="5c8d" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 15.571%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/95fabedc19bf0dab86abef8daa7c6288?postId=60f750086237" data-media-id="95fabedc19bf0dab86abef8daa7c6288" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/95fabedc19bf0dab86abef8daa7c6288.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/95fabedc19bf0dab86abef8daa7c6288?postId=60f750086237" data-media-id="95fabedc19bf0dab86abef8daa7c6288" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="d317" id="d317" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 339px; max-height: 74px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.8%;"></div><img class="graf-image" data-image-id="1*004LK2vgvRblVTx2dn164Q.png" data-width="339" data-height="74" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_004LK2vgvRblVTx2dn164Q.png"></div></figure><p name="3604" id="3604" class="graf graf--p graf-after--figure">This idea is implemented in the <code class="markup--code markup--p-code">OneHotEncoder</code> class from <code class="markup--code markup--p-code">sklearn.preprocessing</code>. By default <code class="markup--code markup--p-code">OneHotEncoder</code> transforms data into a sparse matrix to save memory space because most of the values are zeroes and because we do not want to take up more RAM. However, in this particular example, we do not encounter such problems, so we are going to use a "dense" matrix representation.</p><figure name="4df8" id="4df8" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/c38d11ada7b60024e0a43d78f43f04f1?postId=60f750086237" data-media-id="c38d11ada7b60024e0a43d78f43f04f1" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/c38d11ada7b60024e0a43d78f43f04f1.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/c38d11ada7b60024e0a43d78f43f04f1?postId=60f750086237" data-media-id="c38d11ada7b60024e0a43d78f43f04f1" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="ae9f" id="ae9f" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 186px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 26.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*3aV37glp1NSghP0o-H5HPA.png" data-width="749" data-height="199" data-action="zoom" data-action-value="1*3aV37glp1NSghP0o-H5HPA.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_3aV37glp1NSghP0o-H5HPA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="18"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*3aV37glp1NSghP0o-H5HPA.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_3aV37glp1NSghP0o-H5HPA(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*3aV37glp1NSghP0o-H5HPA.png"></noscript></div></div></figure><p name="188c" id="188c" class="graf graf--p graf-after--figure">We have 53 columns that correspond to the number of unique values of categorical features in our data set. When transformed with One-Hot Encoding, this data can be used with linear models:</p><pre name="d218" id="d218" class="graf graf--pre graf-after--p">print(logistic_regression_accuracy_on(encoded_categorical_columns,  labels))</pre><figure name="64ab" id="64ab" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 545px; max-height: 126px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 23.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*WRZth-h2pxxLRGO7GBuRfw.png" data-width="545" data-height="126" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_WRZth-h2pxxLRGO7GBuRfw.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="16"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*WRZth-h2pxxLRGO7GBuRfw.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_WRZth-h2pxxLRGO7GBuRfw(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*WRZth-h2pxxLRGO7GBuRfw.png"></noscript></div></div></figure><h3 name="d289" id="d289" class="graf graf--h3 graf-after--figure">2.3. Hashing&nbsp;trick</h3><p name="fbb4" id="fbb4" class="graf graf--p graf-after--h3">Real data can be volatile, meaning we cannot guarantee that new values of categorial features will not occur. This issue hampers using a trained model on new data. Besides that, <code class="markup--code markup--p-code">LabelEncoder</code> requires preliminary analysis of the whole dataset and storage of constructed mappings in memory, which makes it difficult to work with large datasets.</p><p name="8f45" id="8f45" class="graf graf--p graf-after--p">There is a simple approach to vectorization of categorial data based on hashing and is known as, not-so-surprisingly, the hashing trick.</p><p name="b6b9" id="b6b9" class="graf graf--p graf-after--p">Hash functions can help us find unique codes for different feature values, for example:</p><figure name="07e9" id="07e9" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.429%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/1956e90f1e7f9b08d6c7dac4928125bc?postId=60f750086237" data-media-id="1956e90f1e7f9b08d6c7dac4928125bc" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1956e90f1e7f9b08d6c7dac4928125bc.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/1956e90f1e7f9b08d6c7dac4928125bc?postId=60f750086237" data-media-id="1956e90f1e7f9b08d6c7dac4928125bc" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="27ad" id="27ad" class="graf graf--pre graf-after--figure"><code class="markup--code markup--pre-code"># university.degree -&gt; -6241459093488141593<br># high.school -&gt; 7728198035707179500<br># illiterate -&gt; -7360093633803373451</code></pre><p name="62ab" id="62ab" class="graf graf--p graf-after--pre">We will not use negative values or values of high magnitude, so we restrict the range of values for the hash function:</p><figure name="7762" id="7762" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 15.571%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/2650d9a3533670802189dcbe44a7b6ea?postId=60f750086237" data-media-id="2650d9a3533670802189dcbe44a7b6ea" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/2650d9a3533670802189dcbe44a7b6ea.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/2650d9a3533670802189dcbe44a7b6ea?postId=60f750086237" data-media-id="2650d9a3533670802189dcbe44a7b6ea" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="211d" id="211d" class="graf graf--pre graf-after--figure"><code class="markup--code markup--pre-code"># university.degree -&gt; 7<br># high.school -&gt; 0<br># illiterate -&gt; 24</code></pre><p name="d4b0" id="d4b0" class="graf graf--p graf-after--pre">Imagine that our data set contains a single (i.e. not married) student, who received a call on Monday. His feature vectors will be created similarly as in the case of One-Hot Encoding but in the space with fixed range for all features:</p><figure name="185d" id="185d" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/d6b26af94b4d838789fc7ddb092c07b1?postId=60f750086237" data-media-id="d6b26af94b4d838789fc7ddb092c07b1" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/d6b26af94b4d838789fc7ddb092c07b1.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/d6b26af94b4d838789fc7ddb092c07b1?postId=60f750086237" data-media-id="d6b26af94b4d838789fc7ddb092c07b1" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="6a85" id="6a85" class="graf graf--pre graf-after--figure"><code class="markup--code markup--pre-code"># job=student -&gt; 20<br># marital=single -&gt; 23<br># day_of_week=mon -&gt; 9</code></pre><p name="643e" id="643e" class="graf graf--p graf-after--pre">We want to point out that we hash not only feature values but also pairs of <strong class="markup--strong markup--p-strong">feature name + feature value</strong>. It is important to do this so that we can distinguish the same values of different features.</p><p name="9e0a" id="9e0a" class="graf graf--p graf-after--p">Is it possible to have a collision when using hash codes? Sure, it is possible, but it is a rare case with large enough hashing spaces. Even if collision occurs, regression or classification metrics will not suffer much. In this case, hash collisions work as a form of regularization.</p><figure name="0e1d" id="0e1d" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 496px; max-height: 360px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 72.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*aWJVQkWcJukZKIqn.jpeg" data-width="496" data-height="360" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_aWJVQkWcJukZKIqn.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="53"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*aWJVQkWcJukZKIqn.jpeg" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_aWJVQkWcJukZKIqn(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*aWJVQkWcJukZKIqn.jpeg"></noscript></div></div></figure><p name="7bc3" id="7bc3" class="graf graf--p graf-after--figure">You may be saying “WTF?”; hashing seems counterintuitive. This is true, but these heuristics sometimes are, in fact, the only plausible approach to work with categorial data. Moreover, this technique has proven to just work. As you work more with data, you may see this for yourself.</p><h3 name="9fdf" id="9fdf" class="graf graf--h3 graf-after--p">3. Vowpal&nbsp;Wabbit</h3><p name="37c0" id="37c0" class="graf graf--p graf-after--h3"><a href="https://github.com/JohnLangford/vowpal_wabbit" data-href="https://github.com/JohnLangford/vowpal_wabbit" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Vowpal Wabbit</a> (VW) is one of the most widespread machine learning libraries used in industry. It is prominent for its training speed and support of many training modes, especially for online learning with big and high-dimentional data. This is one of the major merits of the library. Also, with the hashing trick implemented, Vowpal Wabbit is a perfect choice for working with text data.</p><p name="addd" id="addd" class="graf graf--p graf-after--p">Shell is the main interface for VW. Try this command:</p><p name="8f4f" id="8f4f" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">!vw — help</code></p><p name="fb8f" id="fb8f" class="graf graf--p graf-after--p">Vowpal Wabbit reads data from files or from standard input stream (stdin) with the following format:</p><p name="d9c3" id="d9c3" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">[Label] [Importance] [Tag]|Namespace Features |Namespace Features&nbsp;... |Namespace Features</code></p><p name="9e1d" id="9e1d" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">Namespace=String[:Value]</code></p><p name="7c72" id="7c72" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">Features=(String[:Value] )*</code></p><p name="eeaf" id="eeaf" class="graf graf--p graf-after--p">here [] denotes non-mandatory elements, and (…)* means multiple inputs allowed.</p><ul class="postList"><li name="73f6" id="73f6" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Label</strong> is a number. In the case of classification, it is usually 1 and -1; for regression, it is a real float value</li><li name="6faf" id="6faf" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Importance</strong> is a number. It denotes the sample weight during training. Setting this helps when working with imbalanced data.</li><li name="edaf" id="edaf" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Tag</strong> is a string without spaces. It is the “name” of the sample that VW saves upon prediction. In order to separate Tag from Importance, it is better to start Tag with the ‘ character.</li><li name="1e9e" id="1e9e" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Namespace</strong> is for creating different feature spaces.</li><li name="f52a" id="f52a" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Features</strong> are object features inside a given <strong class="markup--strong markup--li-strong">Namespace</strong>. Features have weight 1.0 by default, but it can be changed, for example feature:0.1.</li></ul><p name="e8a1" id="e8a1" class="graf graf--p graf-after--li">The following string matches the VW format:</p><pre name="44a8" id="44a8" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">1 1.0 |Subject WHAT car is this |Organization University of Maryland:0.5 College Park</code></pre><p name="6896" id="6896" class="graf graf--p graf-after--pre">Let’s check the format by running VW with this training sample:</p><pre name="837d" id="837d" class="graf graf--pre graf-after--p">! echo '1 1.0 |Subject WHAT car is this |Organization University of Maryland:0.5 College Park' | vw</pre><pre name="3904" id="3904" class="graf graf--pre graf-after--pre"># Output:</pre><pre name="68e1" id="68e1" class="graf graf--pre graf-after--pre">Num weight bits = 18<br>learning rate = 0.5<br>initial_t = 0<br>power_t = 0.5<br>using no cache<br>Reading datafile = <br>num sources = 1<br>average  since         example        example  current  current  current<br>loss     last          counter         weight    label  predict features<br>1.000000 1.000000            1            1.0   1.0000   0.0000       10<br><br>finished run<br>number of examples per pass = 1<br>passes used = 1<br>weighted example sum = 1.000000<br>weighted label sum = 1.000000<br>average loss = 1.000000<br>best constant = 1.000000<br>best constant's loss = 0.000000<br>total feature number = 10</pre><p name="3eac" id="3eac" class="graf graf--p graf-after--pre">VW is a wonderful tool for working with text data. We’ll illustrate it with the <a href="http://scikit-learn.org/stable/datasets/twenty_newsgroups.html" data-href="http://scikit-learn.org/stable/datasets/twenty_newsgroups.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">20newsgroups dataset</a>, which contains letters from 20 different newsletters.</p><h3 name="92c4" id="92c4" class="graf graf--h3 graf-after--p">3.1. News. Binary classification.</h3><pre name="509c" id="509c" class="graf graf--pre graf-after--h3"># load data with sklearn's function<br>newsgroups = fetch_20newsgroups(PATH_TO_ALL_DATA)<br>newsgroups['target_names']</pre><p name="19c1" id="19c1" class="graf graf--p graf-after--pre">The 20 topics are <code class="markup--code markup--p-code">['alt.atheism', 'comp.graphics', 'comp.os.ms-windows.misc', 'comp.sys.ibm.pc.hardware', 'comp.sys.mac.hardware', 'comp.windows.x', 'misc.forsale', 'rec.autos', 'rec.motorcycles', 'rec.sport.baseball', 'rec.sport.hockey', 'sci.crypt', 'sci.electronics', 'sci.med', 'sci.space', 'soc.religion.christian', 'talk.politics.guns', 'talk.politics.mideast', 'talk.politics.misc', 'talk.religion.misc']</code></p><p name="3afc" id="3afc" class="graf graf--p graf-after--p">Lets look at the first document in this collection:</p><figure name="d804" id="d804" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 31.286%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/394b087cb907c3e2f3375b4092a142f3?postId=60f750086237" data-media-id="394b087cb907c3e2f3375b4092a142f3" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/394b087cb907c3e2f3375b4092a142f3.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/394b087cb907c3e2f3375b4092a142f3?postId=60f750086237" data-media-id="394b087cb907c3e2f3375b4092a142f3" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="8d40" id="8d40" class="graf graf--pre graf-after--figure"># Output:</pre><pre name="56a6" id="56a6" class="graf graf--pre graf-after--pre">-----<br>rec.autos<br>-----<br>From: lerxst@wam.umd.edu (where's my thing)<br>Subject: WHAT car is this!?<br>Nntp-Posting-Host: rac3.wam.umd.edu<br>Organization: University of Maryland, College Park<br>Lines: 15<br><br> I was wondering if anyone out there could enlighten me on this car I saw<br>the other day. It was a 2-door sports car, looked to be from the late 60s/<br>early 70s. It was called a Bricklin. The doors were really small. In addition,<br>the front bumper was separate from the rest of the body. This is <br>all I know. If anyone can tellme a model name, engine specs, years<br>of production, where this car is made, history, or whatever info you<br>have on this funky looking car, please e-mail.<br><br>Thanks,<br>- IL<br>   ---- brought to you by your neighborhood Lerxst ----<br>----</pre><p name="485c" id="485c" class="graf graf--p graf-after--pre">Now we convert the data into something Vowpal Wabbit can understand. We will throw away words shorter than 3 symbols. Here, we will skip some important NLP stages such as stemming and lemmatization; however, we will later see that VW solves the problem even without these steps.</p><figure name="a880" id="a880" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/2f16a87e3c281e87692afb695c31174a?postId=60f750086237" data-media-id="2f16a87e3c281e87692afb695c31174a" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/2f16a87e3c281e87692afb695c31174a.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/2f16a87e3c281e87692afb695c31174a?postId=60f750086237" data-media-id="2f16a87e3c281e87692afb695c31174a" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="4333" id="4333" class="graf graf--pre graf-after--figure"># Output:</pre><pre name="87c9" id="87c9" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">'1 |text from lerxst wam umd edu where thing subject what car this nntp posting host rac3 wam umd edu organization university maryland college park lines was wondering anyone out there could enlighten this car saw the other day was door sports car looked from the late 60s early 70s was called bricklin the doors were really small addition the front bumper was separate from the rest the body this all know anyone can tellme model name engine specs years production where this car made history whatever info you have this funky looking car please mail thanks brought you your neighborhood lerxst\n'</code></pre><p name="99ac" id="99ac" class="graf graf--p graf-after--pre">We split the dataset into train and test and write these into separate files. We will consider a document as positive if it corresponds to <strong class="markup--strong markup--p-strong">rec.autos</strong>. Thus, we are constructing a model which distinguishes articles about cars from other topics:</p><figure name="1424" id="1424" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/99d5ddefb5037b33ccb05ba708c62e1f?postId=60f750086237" data-media-id="99d5ddefb5037b33ccb05ba708c62e1f" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/99d5ddefb5037b33ccb05ba708c62e1f.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/99d5ddefb5037b33ccb05ba708c62e1f?postId=60f750086237" data-media-id="99d5ddefb5037b33ccb05ba708c62e1f" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="7798" id="7798" class="graf graf--p graf-after--figure">Now, we pass the created training file to Vowpal Wabbit. We solve the classification problem with a hinge loss function (linear SVM). The trained model will be saved in the <code class="markup--code markup--p-code">20news_model.vw</code> file:</p><pre name="bfbd" id="bfbd" class="graf graf--pre graf-after--p">!vw -d $PATH_TO_ALL_DATA/20news_train.vw \ --loss_function hinge -f $PATH_TO_ALL_DATA/20news_model.vw</pre><pre name="e5a0" id="e5a0" class="graf graf--pre graf-after--pre"># Output:</pre><pre name="8199" id="8199" class="graf graf--pre graf-after--pre">final_regressor = ../../data//20news_model.vw<br>Num weight bits = 18<br>learning rate = 0.5<br>initial_t = 0<br>power_t = 0.5<br>using no cache<br>Reading datafile = ../../data//20news_train.vw<br>num sources = 1<br>average  since         example        example  current  current  current<br>loss     last          counter         weight    label  predict features<br>1.000000 1.000000            1            1.0  -1.0000   0.0000      157<br>0.911276 0.822551            2            2.0  -1.0000  -0.1774      159<br>0.605793 0.300311            4            4.0  -1.0000  -0.3994       92<br>0.419594 0.233394            8            8.0  -1.0000  -0.8167      129<br>0.313998 0.208402           16           16.0  -1.0000  -0.6509      108<br>0.196014 0.078029           32           32.0  -1.0000  -1.0000      115<br>0.183158 0.170302           64           64.0  -1.0000  -0.7072      114<br>0.261046 0.338935          128          128.0   1.0000  -0.7900      110<br>0.262910 0.264774          256          256.0  -1.0000  -0.6425       44<br>0.216663 0.170415          512          512.0  -1.0000  -1.0000      160<br>0.176710 0.136757         1024         1024.0  -1.0000  -1.0000      194<br>0.134541 0.092371         2048         2048.0  -1.0000  -1.0000      438<br>0.104403 0.074266         4096         4096.0  -1.0000  -1.0000      644<br>0.081329 0.058255         8192         8192.0  -1.0000  -1.0000      174<br><br>finished run<br>number of examples per pass = 8485<br>passes used = 1<br>weighted example sum = 8485.000000<br>weighted label sum = -7555.000000<br>average loss = 0.079837<br>best constant = -1.000000<br>best constant's loss = 0.109605<br>total feature number = 2048932</pre><p name="8914" id="8914" class="graf graf--p graf-after--pre">VW prints a lot of interesting info while training (one can suppress it with the <code class="markup--code markup--p-code">--quiet</code> parameter). You can see documentation of the diagnostic output on <a href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial#vws-diagnostic-information" data-href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial#vws-diagnostic-information" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">GitHub</a>. Note how average loss drops while training. For loss computation, VW uses samples it has never seen before, so this measure is usually accurate. Now, we apply our trained model to the test set, saving predictions into a file with the <code class="markup--code markup--p-code">-p</code> flag:</p><pre name="1b7a" id="1b7a" class="graf graf--pre graf-after--p">!vw -i $PATH_TO_ALL_DATA/20news_model.vw -t -d $PATH_TO_ALL_DATA/20news_test.vw \ -p $PATH_TO_ALL_DATA/20news_test_predictions.txt</pre><p name="fced" id="fced" class="graf graf--p graf-after--pre">Now we load our predictions, compute AUC, and plot the ROC curve:</p><figure name="ed8e" id="ed8e" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 50.143%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/7f0a50cc67a2e090a4e5233cc6f85c9d?postId=60f750086237" data-media-id="7f0a50cc67a2e090a4e5233cc6f85c9d" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/7f0a50cc67a2e090a4e5233cc6f85c9d.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/7f0a50cc67a2e090a4e5233cc6f85c9d?postId=60f750086237" data-media-id="7f0a50cc67a2e090a4e5233cc6f85c9d" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><figure name="d1c1" id="d1c1" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 402px; max-height: 288px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 71.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*9cmeLXu__qM6Uw9Ju1oMgg.png" data-width="402" data-height="288" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_9cmeLXu__qM6Uw9Ju1oMgg.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="52"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*9cmeLXu__qM6Uw9Ju1oMgg.png" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_9cmeLXu__qM6Uw9Ju1oMgg(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*9cmeLXu__qM6Uw9Ju1oMgg.png"></noscript></div></div></figure><p name="9310" id="9310" class="graf graf--p graf-after--figure">The AUC value we get shows that we have achieved high classification quality.</p><h3 name="98f6" id="98f6" class="graf graf--h3 graf-after--p">3.2. News. Multiclass classification</h3><p name="5f8f" id="5f8f" class="graf graf--p graf-after--h3">We will use the same news dataset, but, this time, we will solve a multiclass classification problem. <code class="markup--code markup--p-code">Vowpal Wabbit</code> is a little picky – it wants labels starting from 1 till K, where K – is the number of classes in the classification task (20 in our case). So we will use LabelEncoder and add 1 afterwards (recall that <code class="markup--code markup--p-code">LabelEncoder</code> maps labels into range from 0 to K-1).</p><figure name="9094" id="9094" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 15.571%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/5f6422f5bea335ab95879bb585e7ee66?postId=60f750086237" data-media-id="5f6422f5bea335ab95879bb585e7ee66" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/5f6422f5bea335ab95879bb585e7ee66.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/5f6422f5bea335ab95879bb585e7ee66?postId=60f750086237" data-media-id="5f6422f5bea335ab95879bb585e7ee66" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="c20e" id="c20e" class="graf graf--p graf-after--figure">The data is the same, but we have changed the labels, <code class="markup--code markup--p-code">train_labels_mult</code> and <code class="markup--code markup--p-code">test_labels_mult</code>, into label vectors from 1 to 20.</p><figure name="37ed" id="37ed" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40.714%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/a9bd37a495dc62be5a5f90337698727f?postId=60f750086237" data-media-id="a9bd37a495dc62be5a5f90337698727f" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/a9bd37a495dc62be5a5f90337698727f.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/a9bd37a495dc62be5a5f90337698727f?postId=60f750086237" data-media-id="a9bd37a495dc62be5a5f90337698727f" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="6231" id="6231" class="graf graf--p graf-after--figure">We train Vowpal Wabbit in multiclass classification mode, passing the <code class="markup--code markup--p-code">oaa</code> parameter("one against all") with the number of classes. Also, let's see what parameters our model quality is dependent on (more info can be found in the <a href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial" data-href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">official Vowpal Wabbit tutorial</a>):</p><ul class="postList"><li name="b66f" id="b66f" class="graf graf--li graf-after--p">learning rate (-l, 0.5 default) — rate of weight change on every step</li><li name="c4a7" id="c4a7" class="graf graf--li graf-after--li">learning rate decay ( — power_t, 0.5 default) — it is proven in practice, that, if the learning rate drops with the number of steps in stochastic gradient descent, we approach the minimum loss better</li><li name="bde4" id="bde4" class="graf graf--li graf-after--li">loss function ( — loss_function) — the entire training algorithm depends on it. See <a href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Loss-functions" data-href="https://github.com/JohnLangford/vowpal_wabbit/wiki/Loss-functions" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">docs</a> for loss functions</li><li name="fe53" id="fe53" class="graf graf--li graf-after--li">Regularization (-l1) — note that VW calculates regularization for every object. That is why we usually set regularization values to about 1e-20.</li></ul><p name="9a74" id="9a74" class="graf graf--p graf-after--li">Additionally, we can try automatic Vowpal Wabbit parameter tuning with <a href="https://github.com/hyperopt/hyperopt" data-href="https://github.com/hyperopt/hyperopt" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Hyperopt</a>.</p><pre name="2af6" id="2af6" class="graf graf--pre graf-after--p">!vw — oaa 20 $PATH_TO_ALL_DATA/20news_train_mult.vw -f $PATH_TO_ALL_DATA/20news_model_mult.vw \<br> — loss_function=hinge</pre><pre name="efd3" id="efd3" class="graf graf--pre graf-after--pre">!vw -i $PATH_TO_ALL_DATA/20news_model_mult.vw -t -d $PATH_TO_ALL_DATA/20news_test_mult.vw \<br>-p $PATH_TO_ALL_DATA/20news_test_predictions_mult.txt</pre><figure name="8514" id="8514" class="graf graf--figure graf--iframe graf-after--pre"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 28.143%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/16fd124b365c00cd53aeade89a2c3d3a?postId=60f750086237" data-media-id="16fd124b365c00cd53aeade89a2c3d3a" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/16fd124b365c00cd53aeade89a2c3d3a.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/16fd124b365c00cd53aeade89a2c3d3a?postId=60f750086237" data-media-id="16fd124b365c00cd53aeade89a2c3d3a" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="480c" id="480c" class="graf graf--p graf-after--figure">Here is how often the model misclassifies atheism with other topics:</p><figure name="897c" id="897c" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 15.571%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/830f22705405e5b6f0b19b639413be1b?postId=60f750086237" data-media-id="830f22705405e5b6f0b19b639413be1b" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/830f22705405e5b6f0b19b639413be1b.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/830f22705405e5b6f0b19b639413be1b?postId=60f750086237" data-media-id="830f22705405e5b6f0b19b639413be1b" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="47fc" id="47fc" class="graf graf--pre graf-after--figure"># Output:</pre><pre name="9701" id="9701" class="graf graf--pre graf-after--pre">rec.autos 1<br>rec.sport.baseball 1<br>sci.med 1<br>soc.religion.christian 3<br>talk.religion.misc 5</pre><h3 name="1368" id="1368" class="graf graf--h3 graf-after--pre">3.3. IMDB movie&nbsp;reviews</h3><p name="f58c" id="f58c" class="graf graf--p graf-after--h3">In this part we will do binary classification of <a href="http://www.imdb.com/" data-href="http://www.imdb.com/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">IMDB</a> (International Movie DataBase) movie reviews. We will see how fast Vowpal Wabbit performs.</p><p name="fa95" id="fa95" class="graf graf--p graf-after--p">Using the <code class="markup--code markup--p-code">load_files</code> function from <code class="markup--code markup--p-code">sklearn.datasets</code>, we load the movie reviews <a href="https://drive.google.com/file/d/1xq4l5c0JrcxJdyBwJWvy0u9Ad_pvkJ1l/view?usp=sharing" data-href="https://drive.google.com/file/d/1xq4l5c0JrcxJdyBwJWvy0u9Ad_pvkJ1l/view?usp=sharing" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a>. If you want to reproduce the results, please download the archive, unzip it, and set the path to <code class="markup--code markup--p-code">imdb_reviews</code> (it already contains <em class="markup--em markup--p-em">train</em> and <em class="markup--em markup--p-em">test</em> subdirectories). Unpacking can take several minutes as there are 100k files. Both train and test sets hold 12.5k good and bad movie reviews. First, we split the texts and labels.</p><figure name="4481" id="4481" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/a1309bd6e1b73f72aa7ce78edebe4105?postId=60f750086237" data-media-id="a1309bd6e1b73f72aa7ce78edebe4105" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/a1309bd6e1b73f72aa7ce78edebe4105.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/a1309bd6e1b73f72aa7ce78edebe4105?postId=60f750086237" data-media-id="a1309bd6e1b73f72aa7ce78edebe4105" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="2b22" id="2b22" class="graf graf--p graf-after--figure">Take a look at examples of reviews and their corresponding labels.</p><pre name="e4db" id="e4db" class="graf graf--pre graf-after--p">text_train[0]</pre><pre name="8122" id="8122" class="graf graf--pre graf-after--pre"># Output:<br><code class="markup--code markup--pre-code">b"Zero Day leads you to think, even re-think why two boys/young men would do what they did - commit mutual suicide via slaughtering their classmates. It captures what must be beyond a bizarre mode of being for two humans who have decided to withdraw from common civility in order to define their own/mutual world via coupled destruction.&lt;br /&gt;&lt;br /&gt;It is not a perfect movie but given what money/time the filmmaker and actors had - it is a remarkable product. In terms of explaining the motives and actions of the two young suicide/murderers it is better than 'Elephant' - in terms of being a film that gets under our 'rationalistic' skin it is a far, far better film than almost anything you are likely to see. &lt;br /&gt;&lt;br /&gt;Flawed but honest with a terrible honesty."</code></pre><pre name="ea2d" id="ea2d" class="graf graf--pre graf-after--pre">y_train[0] # good review</pre><pre name="6912" id="6912" class="graf graf--pre graf-after--pre"># Output:<br><code class="markup--code markup--pre-code">1</code></pre><pre name="57d9" id="57d9" class="graf graf--pre graf-after--pre">text_train[1]</pre><pre name="cee2" id="cee2" class="graf graf--pre graf-after--pre"># Output:<br><code class="markup--code markup--pre-code">b'Words can\'t describe how bad this movie is. I can\'t explain it by writing only. You have too see it for yourself to get at grip of how horrible a movie really can be. Not that I recommend you to do that. There are so many clich\xc3\xa9s, mistakes (and all other negative things you can imagine) here that will just make you cry. To start with the technical first, there are a LOT of mistakes regarding the airplane. I won\'t list them here, but just mention the coloring of the plane. They didn\'t even manage to show an airliner in the colors of a fictional airline, but instead used a 747 painted in the original Boeing livery. Very bad. The plot is stupid and has been done many times before, only much, much better. There are so many ridiculous moments here that i lost count of it really early. Also, I was on the bad guys\' side all the time in the movie, because the good guys were so stupid. "Executive Decision" should without a doubt be you\'re choice over this one, even the "Turbulence"-movies are better. In fact, every other movie in the world is better than this one.'</code></pre><pre name="7377" id="7377" class="graf graf--pre graf-after--pre">y_train[1] # bad review</pre><pre name="27be" id="27be" class="graf graf--pre graf-after--pre"># Output:<br>0</pre><p name="fc6b" id="fc6b" class="graf graf--p graf-after--pre">Now, we prepare training (<code class="markup--code markup--p-code">movie_reviews_train.vw</code>), validation (<code class="markup--code markup--p-code">movie_reviews_valid.vw</code>), and test (<code class="markup--code markup--p-code">movie_reviews_test.vw</code>) sets for Vowpal Wabbit. We will use 70% for training, 30% for the hold-out set.</p><figure name="5028" id="5028" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53.286%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/8f6d550aae128e510de5d682eaa3c389?postId=60f750086237" data-media-id="8f6d550aae128e510de5d682eaa3c389" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/8f6d550aae128e510de5d682eaa3c389.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/8f6d550aae128e510de5d682eaa3c389?postId=60f750086237" data-media-id="8f6d550aae128e510de5d682eaa3c389" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="d3de" id="d3de" class="graf graf--p graf-after--figure">Now, launch Vowpal Wabbit with the following arguments:</p><ul class="postList"><li name="92d1" id="92d1" class="graf graf--li graf-after--p">-d, path to training set (corresponding&nbsp;.vw file)</li><li name="9b9b" id="9b9b" class="graf graf--li graf-after--li">— loss_function — hinge (feel free to experiment here)</li><li name="1f59" id="1f59" class="graf graf--li graf-after--li">-f — path to the output file (which can also be in the&nbsp;.vw format)</li></ul><pre name="58ea" id="58ea" class="graf graf--pre graf-after--li">!vw -d $PATH_TO_ALL_DATA/movie_reviews_train.vw --loss_function hinge -f $PATH_TO_ALL_DATA/movie_reviews_model.vw --quiet</pre><p name="4517" id="4517" class="graf graf--p graf-after--pre">Next, make the hold-out prediction with the following VW arguments:</p><ul class="postList"><li name="9d97" id="9d97" class="graf graf--li graf-after--p">-i –path to the trained model (.vw file)</li><li name="9413" id="9413" class="graf graf--li graf-after--li">-t -d — path to hold-out set (.vw file)</li><li name="65b1" id="65b1" class="graf graf--li graf-after--li">-p — path to a txt-file where the predictions will be stored</li></ul><pre name="3e87" id="3e87" class="graf graf--pre graf-after--li">!vw -i $PATH_TO_ALL_DATA/movie_reviews_model.vw -t \ <br>-d $PATH_TO_ALL_DATA/movie_reviews_valid.vw -p $PATH_TO_ALL_DATA/movie_valid_pred.txt --quiet</pre><p name="2e4d" id="2e4d" class="graf graf--p graf-after--pre">Read the predictions from the text file and estimate the accuracy and ROC AUC. Note that VW prints probability estimates of the +1 class. These estimates are distributed from -1 to 1, so we can convert these into binary answers, assuming that positive values belong to class 1.</p><figure name="380d" id="380d" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 25%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/cb18f181febb81e877283f67b227cc92?postId=60f750086237" data-media-id="cb18f181febb81e877283f67b227cc92" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/cb18f181febb81e877283f67b227cc92.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/cb18f181febb81e877283f67b227cc92?postId=60f750086237" data-media-id="cb18f181febb81e877283f67b227cc92" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="e4f6" id="e4f6" class="graf graf--pre graf-after--figure"><code class="markup--code markup--pre-code">Accuracy: 0.885<br>AUC: 0.942</code></pre><p name="e07e" id="e07e" class="graf graf--p graf-after--pre">Again, do the same for the test set.</p><pre name="d7d6" id="d7d6" class="graf graf--pre graf-after--p">!vw -i $PATH_TO_ALL_DATA/movie_reviews_model.vw -t \ -d $PATH_TO_ALL_DATA/movie_reviews_test.vw \ -p $PATH_TO_ALL_DATA/movie_test_pred.txt --quiet</pre><figure name="4df6" id="4df6" class="graf graf--figure graf--iframe graf-after--pre"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 25%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/88ee1e50024bdab151b0275a7951936d?postId=60f750086237" data-media-id="88ee1e50024bdab151b0275a7951936d" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/88ee1e50024bdab151b0275a7951936d.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/88ee1e50024bdab151b0275a7951936d?postId=60f750086237" data-media-id="88ee1e50024bdab151b0275a7951936d" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="04cb" id="04cb" class="graf graf--pre graf-after--figure"><code class="markup--code markup--pre-code">Accuracy: 0.88<br>AUC: 0.94</code></pre><p name="ceee" id="ceee" class="graf graf--p graf-after--pre">Let’s try to achieve a higher accuracy by incorporating bigrams.</p><pre name="50ed" id="50ed" class="graf graf--pre graf-after--p">!vw -d $PATH_TO_ALL_DATA/movie_reviews_train.vw \ --loss_function hinge --ngram 2 -f $PATH_TO_ALL_DATA/movie_reviews_model2.vw --quiet</pre><pre name="f442" id="f442" class="graf graf--pre graf-after--pre">!vw -i$PATH_TO_ALL_DATA/movie_reviews_model2.vw -t -d $PATH_TO_ALL_DATA/movie_reviews_valid.vw \ -p $PATH_TO_ALL_DATA/movie_valid_pred2.txt --quiet</pre><pre name="1d09" id="1d09" class="graf graf--pre graf-after--pre">!vw -i $PATH_TO_ALL_DATA/movie_reviews_model2.vw -t -d $PATH_TO_ALL_DATA/movie_reviews_test.vw \ -p $PATH_TO_ALL_DATA/movie_test_pred2.txt --quiet</pre><p name="2955" id="2955" class="graf graf--p graf-after--pre">Adding bigrams really helped to improve our model!</p><pre name="d48e" id="d48e" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Validation <br></code>Accuracy: 0.894<br>AUC: 0.954</pre><pre name="7f72" id="7f72" class="graf graf--pre graf-after--pre"># Test<br>Accuracy: 0.888<br>AUC: 0.952</pre><h3 name="68ec" id="68ec" class="graf graf--h3 graf-after--pre">3.4. Classifying gigabytes of StackOverflow questions</h3><p name="15e4" id="15e4" class="graf graf--p graf-after--h3">Now, let’s see Vowpal Wabbit work on large datasets. There is a 10GB dataset of StackOverflow questions <a href="https://drive.google.com/file/d/1ZU4J3KhJDrHVMj48fROFcTsTZKorPGlG/view?usp=sharing" data-href="https://drive.google.com/file/d/1ZU4J3KhJDrHVMj48fROFcTsTZKorPGlG/view?usp=sharing" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">here</a>. The original dataset is comprised of 10 million questions; each question can have several tags. The data is quite clean, so don’t call it “Big Data”, even in a pub.&nbsp;:)</p><figure name="52dd" id="52dd" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 638px; max-height: 359px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*Z0bVkk0iTYNOaD5I.jpg" data-width="638" data-height="359" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_Z0bVkk0iTYNOaD5I.jpg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="41"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*Z0bVkk0iTYNOaD5I.jpg" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_Z0bVkk0iTYNOaD5I(1).jpg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*Z0bVkk0iTYNOaD5I.jpg"></noscript></div></div></figure><p name="5c38" id="5c38" class="graf graf--p graf-after--figure">We chose only 10 tags: ‘javascript’, ‘java’, ‘python’, ‘ruby’, ‘php’, ‘c++’, ‘c#’, ‘go’, ‘scala’ and ‘swift’. Let’s solve the 10-class classification problem: we want to predict a tag corresponding to one of these 10 popular programming languages given only the text of the question. Your task in assignment is to</p><pre name="6733" id="6733" class="graf graf--pre graf-after--p"># change the path to data <br>PATH_TO_STACKOVERFLOW_DATA = 'stackoverflow_10mln'</pre><pre name="4655" id="4655" class="graf graf--pre graf-after--pre"># Print the first 3 lines from a sample of the dataset.</pre><pre name="b1c2" id="b1c2" class="graf graf--pre graf-after--pre">!head -3 $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_train.vw</pre><pre name="d597" id="d597" class="graf graf--pre graf-after--pre"># Output:</pre><pre name="a3cd" id="a3cd" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">1 | i ve got some code in window scroll that checks if an element is visible then triggers another function however only the first section of code is firing both bits of code work in and of themselves if i swap their order whichever is on top fires correctly my code is as follows fn isonscreen function use strict var win window viewport top win scrolltop left win scrollleft bounds this offset viewport right viewport left + win width viewport bottom viewport top + win height bounds right bounds left + this outerwidth bounds bottom bounds top + this outerheight return viewport right lt bounds left viewport left gt bounds right viewport bottom lt bounds top viewport top gt bounds bottom window scroll function use strict var load_more_results ajax load_more_results isonscreen if load_more_results true loadmoreresults var load_more_staff ajax load_more_staff isonscreen if load_more_staff true loadmorestaff what am i doing wrong can you only fire one event from window scroll i assume not <br>4 | redefining some constant in ruby ex foo bar generates the warning already initialized constant i m trying to write a sort of reallyconstants module where this code should have this behaviour reallyconstants define_constant foo bar gt sets the constant reallyconstants foo to bar reallyconstants foo gt bar reallyconstants foo foobar gt this should raise an exception that is constant redefinition should generate an exception is that possible 1 | in my form panel i added a checkbox setting stateful true stateid loginpanelremeberme then before sending form i save state calling this savestate on the panel all other componenets save their state and whe i reload the page they recall the previous state but checkbox alway start in unchecked state is there any way to force save value</code></pre><p name="4a85" id="4a85" class="graf graf--p graf-after--pre">After selecting our 10 tags, we have a 4.7G dataset that we divide into train and test.</p><pre name="209b" id="209b" class="graf graf--pre graf-after--p">!du -hs $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_*.vw</pre><pre name="557a" id="557a" class="graf graf--pre graf-after--pre"># Output:</pre><pre name="b5d3" id="b5d3" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">4,7G	<br>stackoverflow_10mln.vw <br>1,6G	<br>stackoverflow_test.vw <br>3,1G	<br>stackoverflow_train.vw</code></pre><p name="d1ab" id="d1ab" class="graf graf--p graf-after--pre">We will process the training set (3.1 GiB) with Vowpal Wabbit and the following arguments:</p><ul class="postList"><li name="5473" id="5473" class="graf graf--li graf-after--p">-oaa 10 — for multiclass classification with 10 classes</li><li name="98d0" id="98d0" class="graf graf--li graf-after--li">-d — path to data</li><li name="90c5" id="90c5" class="graf graf--li graf-after--li">-f — path to output file of the trained model</li><li name="8acc" id="8acc" class="graf graf--li graf-after--li">-b 28 — we will use 28 bits for hashing, resulting in a $2^{28}$-sized feature space</li><li name="5c18" id="5c18" class="graf graf--li graf-after--li">fix random seed for reproducibility</li></ul><pre name="fc94" id="fc94" class="graf graf--pre graf-after--li">%%time !vw --oaa 10 -d $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_train.vw \ -f vw_model1_10mln.vw -b 28 --random_seed 17 --quiet</pre><pre name="4f06" id="4f06" class="graf graf--pre graf-after--pre"># Output:</pre><pre name="a5af" id="a5af" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">CPU times: user 559 ms, sys: 171 ms, total: 730 ms Wall time: 38.5 s</code></pre><pre name="90b9" id="90b9" class="graf graf--pre graf-after--pre"><br>%%time !vw -t -i vw_model1_10mln.vw -d $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_test.vw \ -p vw_test_pred.csv --random_seed 17 --quiet</pre><pre name="622a" id="622a" class="graf graf--pre graf-after--pre"># Output:</pre><pre name="fb82" id="fb82" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code">CPU times: user 322 ms, sys: 97 ms, total: 420 ms Wall time: 22.8 s</code></pre><figure name="169d" id="169d" class="graf graf--figure graf--iframe graf-after--pre"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.857%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/790add7ab901b88cd621324bfb284dc4?postId=60f750086237" data-media-id="790add7ab901b88cd621324bfb284dc4" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/790add7ab901b88cd621324bfb284dc4.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/790add7ab901b88cd621324bfb284dc4?postId=60f750086237" data-media-id="790add7ab901b88cd621324bfb284dc4" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><pre name="1aad" id="1aad" class="graf graf--pre graf-after--figure"># Output:</pre><pre name="8757" id="8757" class="graf graf--pre graf-after--pre">0.91728604842865913</pre><p name="5832" id="5832" class="graf graf--p graf-after--pre">The model has trained itself and made predictions in less than a minute (check it, these results are reported for a MacBook Pro, mid 2015, 2.2 GHz Intel Core i7, 16GB RAM). Its accuracy is almost 92%. All of this without a Hadoop cluster!&nbsp;:) Impressive, isn’t it?</p><h3 name="900b" id="900b" class="graf graf--h3 graf-after--p">4. Assignment #8</h3><p name="0314" id="0314" class="graf graf--p graf-after--h3">A demo version is to appear soon (~ in the end of June 2018). Full version will be available in the new session of the course (starting on October, 1).</p><h3 name="c9e3" id="c9e3" class="graf graf--h3 graf-after--p">5. Useful resources</h3><ul class="postList"><li name="9eaf" id="9eaf" class="graf graf--li graf-after--h3">Official VW <a href="https://github.com/JohnLangford/vowpal_wabbit/wiki" data-href="https://github.com/JohnLangford/vowpal_wabbit/wiki" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">documentation</a> on Github</li><li name="a8ab" id="a8ab" class="graf graf--li graf--startsWithDoubleQuote graf-after--li"><a href="http://www.deeplearningbook.org/contents/numerical.html" data-href="http://www.deeplearningbook.org/contents/numerical.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">“Numeric Computation” Chapter</a> of the <a href="http://www.deeplearningbook.org/" data-href="http://www.deeplearningbook.org/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">Deep Learning book</a></li><li name="d82e" id="d82e" class="graf graf--li graf--startsWithDoubleQuote graf-after--li"><a href="https://www.amazon.com/Convex-Optimization-Stephen-Boyd/dp/0521833787" data-href="https://www.amazon.com/Convex-Optimization-Stephen-Boyd/dp/0521833787" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">“Convex Optimization” by Stephen Boyd</a></li><li name="0efd" id="0efd" class="graf graf--li graf--startsWithDoubleQuote graf-after--li">“Command-line Tools can be 235x Faster than your Hadoop Cluster” <a href="https://aadrake.com/command-line-tools-can-be-235x-faster-than-your-hadoop-cluster.html" data-href="https://aadrake.com/command-line-tools-can-be-235x-faster-than-your-hadoop-cluster.html" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">post</a></li><li name="d60d" id="d60d" class="graf graf--li graf-after--li">Benchmarking various ML algorithms on Criteo 1TB dataset on <a href="https://github.com/rambler-digital-solutions/criteo-1tb-benchmark" data-href="https://github.com/rambler-digital-solutions/criteo-1tb-benchmark" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">GitHub</a></li><li name="86db" id="86db" class="graf graf--li graf-after--li graf--trailing">VW on <a href="http://fastml.com/blog/categories/vw/" data-href="http://fastml.com/blog/categories/vw/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">FastML.com</a></li></ul></div></div></section><section name="9c99" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="a1d7" id="a1d7" class="graf graf--p graf--leading graf--trailing"><em class="markup--em markup--p-em">Author: </em><a href="https://yorko.github.io/" data-href="https://yorko.github.io/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Yury Kashnitsky</em></a><em class="markup--em markup--p-em">. Translated and edited by </em><a href="https://www.linkedin.com/in/sergeoreshkov/" data-href="https://www.linkedin.com/in/sergeoreshkov/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Serge Oreshkov</em></a><em class="markup--em markup--p-em">, and </em><a href="https://www.linkedin.com/in/yuanyuanpao/" data-href="https://www.linkedin.com/in/yuanyuanpao/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Yuanyuan Pao</em></a><em class="markup--em markup--p-em">.</em></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/data-science?source=post" data-action-source="post">Data Science</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/education?source=post" data-action-source="post">Education</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/python?source=post" data-action-source="post">Python</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/algorithms?source=post" data-action-source="post">Algorithms</a></li></ul></div></div></div><section class="uiScale uiScale-ui--small uiScale-caption--regular u-borderTopLightest u-marginTop10 u-paddingTop20"><div class="ui-h3 u-textColorDarker u-fontSize22">One clap, two clap, three clap, forty?</div><p class="ui-body u-marginBottom20 u-textColorDark u-fontSize16">By clapping more or less, you can signal to us which stories really stand out.</p></section><div class="postActions js-postActionsFooter"><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter u-width60" data-post-id="60f750086237" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----60f750086237---------------------clap_footer"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboardingcollection" data-action="multivote" data-action-value="60f750086237" data-action-type="long-press" data-action-source="post_actions_footer-----60f750086237---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="60f750086237"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft10"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="60f750086237">1.7K</button></span></div></div><div class="buttonSet u-flex0"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="respond" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse is-active u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="remove-from-bookmarks" data-action-value="60f750086237" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton" title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size6of12 u-xs-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="5572ec600139"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="toggle-block-user" data-action-value="5572ec600139" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="toggle-subscribe-user" data-action-value="5572ec600139" data-action-source="footer_card-5572ec600139-------------------------follow_footer" data-subscribe-source="footer_card" data-follow-context-entity-id="60f750086237"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar" href="https://medium.com/@yurykashnitskiy?source=footer_card" title="Go to the profile of Yury Kashnitskiy" aria-label="Go to the profile of Yury Kashnitskiy" data-action-source="footer_card" data-user-id="5572ec600139" dir="auto"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_JtleyoApNKIjJU5F" class="avatar-image avatar-image--small" alt="Go to the profile of Yury Kashnitskiy"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@yurykashnitskiy" property="cc:attributionName" title="Go to the profile of Yury Kashnitskiy" aria-label="Go to the profile of Yury Kashnitskiy" rel="author cc:attributionUrl" data-user-id="5572ec600139" dir="auto">Yury Kashnitskiy</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Data Scientist at Mail.Ru Group</p></div></li></div><div class="col u-size6of12 u-xs-size12of12 u-xs-marginTop30"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardCollection"><div class="u-marginLeft20 u-floatRight"><button class="button button--primary button--filled button--small button--withChrome u-accentColor--buttonNormal button--withIcon button--withSvgIcon button--withIconRight button--withIconAndLabel js-relationshipButton" data-action="show-more-collection-actions" data-collection-id="b76595fb6cfc"><span class="button-label  js-buttonLabel">Following</span><span class="svgIcon svgIcon--arrowDown svgIcon--21px"><svg class="svgIcon-use" width="21" height="21" viewBox="0 0 21 21"><path d="M4 7.331l6.032 6.67.495.547.495-.547 5.973-6.603-.989-.895-5.974 6.603h.99l-6.033-6.67z" fill-rule="evenodd"></path></svg></span></button></div><div class="u-tableCell "><a class="link u-baseColor--link avatar avatar--roundedRectangle" href="https://medium.com/open-machine-learning-course?source=footer_card" title="Go to Open Machine Learning Course" aria-label="Go to Open Machine Learning Course" data-action-source="footer_card"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_b5pfoCQz20rjh79OPSQWQg.jpeg" class="avatar-image u-size60x60" alt="Open Machine Learning Course"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/open-machine-learning-course?source=footer_card" rel="collection" data-action-source="footer_card">Open Machine Learning Course</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.</p><div class="buttonSet"></div></div></li></div></div></div><div class="js-postFooterPlacements"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1000 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="e2e79252aeba" data-source="placement_card_footer_grid---------0-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://towardsdatascience.com/what-metrics-should-we-use-on-imbalanced-data-set-precision-recall-roc-e2e79252aeba?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*Hu6cTPMo9wvMWr-HUZ_VUA.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://towardsdatascience.com/what-metrics-should-we-use-on-imbalanced-data-set-precision-recall-roc-e2e79252aeba?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">What metrics should be used for evaluating a model on an imbalanced data set?</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://towardsdatascience.com/@DataLady" data-action="show-user-card" data-action-value="a89cb824340d" data-action-type="hover" data-user-id="a89cb824340d" data-collection-slug="towards-data-science" dir="auto"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_LGxXWdWutilMOjlx93T0lw.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Shir Meir Lador"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://towardsdatascience.com/@DataLady?source=placement_card_footer_grid---------0-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-60" data-action-value="a89cb824340d" data-action-type="hover" data-user-id="a89cb824340d" data-collection-slug="towards-data-science" dir="auto">Shir Meir Lador</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="9 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="e2e79252aeba" data-is-label-padded="true" data-source="placement_card_footer_grid-----e2e79252aeba----0-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="e2e79252aeba" data-action-type="long-press" data-action-source="placement_card_footer_grid-----e2e79252aeba----0-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="e2e79252aeba">365</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="e2e79252aeba" data-action-source="placement_card_footer_grid-----e2e79252aeba----0-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="aea1752b1ad0" data-source="placement_card_footer_grid---------1-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/@andrewng/self-driving-cars-are-here-aea1752b1ad0?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*Rkd4uOPkU446v_QbcY-3lQ.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/@andrewng/self-driving-cars-are-here-aea1752b1ad0?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Machine Learning</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Self-driving cars are here</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@andrewng" data-action="show-user-card" data-action-value="592ce2a67248" data-action-type="hover" data-user-id="592ce2a67248" dir="auto"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_9xfnIxWCa313OO4OaT-v2w.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Andrew Ng"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@andrewng?source=placement_card_footer_grid---------1-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-43" data-action-value="592ce2a67248" data-action-type="hover" data-user-id="592ce2a67248" dir="auto">Andrew Ng</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="6 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="aea1752b1ad0" data-is-label-padded="true" data-source="placement_card_footer_grid-----aea1752b1ad0----1-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="aea1752b1ad0" data-action-type="long-press" data-action-source="placement_card_footer_grid-----aea1752b1ad0----1-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="aea1752b1ad0">4.6K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="aea1752b1ad0" data-action-source="placement_card_footer_grid-----aea1752b1ad0----1-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="b8c49e46422f" data-source="placement_card_footer_grid---------2-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/@dicegameteam/the-taste-of-victory-games-algorithm-of-the-dicegame-platform-explained-in-a-few-bullet-points-b8c49e46422f?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*5Qn4ht-DXqBX56cd3d5qPQ.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/@dicegameteam/the-taste-of-victory-games-algorithm-of-the-dicegame-platform-explained-in-a-few-bullet-points-b8c49e46422f?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Machine Learning</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">The Taste of Victory: Games Algorithm of the DICEGAME Platform Explained in a Few Bullet Points</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@dicegameteam" data-action="show-user-card" data-action-value="da97d398423d" data-action-type="hover" data-user-id="da97d398423d" dir="auto"><div class="u-relative u-inlineBlock u-flex0"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/1_MDuW5IbBVc_VhWB9RovTKQ.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Team DICEGAME"><div class="avatar-halo u-absolute u-textColorGreenNormal svgIcon" style="width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px"><svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M3.44615311,11.6601601 C6.57294867,5.47967718 12.9131553,1.5 19.9642857,1.5 C27.0154162,1.5 33.3556228,5.47967718 36.4824183,11.6601601 L37.3747245,11.2087295 C34.0793076,4.69494641 27.3961457,0.5 19.9642857,0.5 C12.5324257,0.5 5.84926381,4.69494641 2.55384689,11.2087295 L3.44615311,11.6601601 Z"></path><path d="M36.4824183,28.2564276 C33.3556228,34.4369105 27.0154162,38.4165876 19.9642857,38.4165876 C12.9131553,38.4165876 6.57294867,34.4369105 3.44615311,28.2564276 L2.55384689,28.7078582 C5.84926381,35.2216412 12.5324257,39.4165876 19.9642857,39.4165876 C27.3961457,39.4165876 34.0793076,35.2216412 37.3747245,28.7078582 L36.4824183,28.2564276 Z"></path></svg></div></div></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@dicegameteam?source=placement_card_footer_grid---------2-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-43" data-action-value="da97d398423d" data-action-type="hover" data-user-id="da97d398423d" dir="auto">Team DICEGAME</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="4 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="b8c49e46422f" data-is-label-padded="true" data-source="placement_card_footer_grid-----b8c49e46422f----2-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="b8c49e46422f" data-action-type="long-press" data-action-source="placement_card_footer_grid-----b8c49e46422f----2-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="b8c49e46422f">1K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="b8c49e46422f" data-action-source="placement_card_footer_grid-----b8c49e46422f----2-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container responsesStream-title u-paddingTop15"><div class="row"><header class="heading"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="responsesStream-editor cardChromeless u-marginBottom20 u-paddingLeft20 u-paddingRight20 js-responsesStreamEditor"><div class="inlineNewPostControl js-inlineNewPostControl" data-action-scope="_actionscope_6"><div class="inlineEditor is-collapsed is-postEditMode js-inlineEditor" data-action="focus-editor"><div class="u-paddingTop20 js-block js-inlineEditorContent"><div class="inlineEditor-header"><div class="inlineEditor-avatar u-paddingRight20"><div class="avatar u-inline"><img src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/0_P-t7h_lDOjJiWVxI(1)" class="avatar-image u-size36x36 u-xs-size32x32" alt="陈辰"></div></div><div class="inlineEditor-headerContent"><div class="inlineEditor-placeholder js-inlineEditorPrompt">Be the first to write a response…</div><div class="inlineEditor-author u-accentColor--textNormal">陈辰</div></div></div></div></div></div></div><div class="responsesStream js-responsesStream"></div><div class="container u-hide js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-sizeFullWidth u-marginVertical20 u-heightAuto" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1000 js-postLeftSidebar"><div class="u-foreground u-top0 u-sm-hide u-marginLeftNegative12 js-postShareWidget u-transition--fadeIn300 u-fixed" data-scroll="fixed" style="transform: translateY(150px);"><ul><li class="u-textAlignCenter u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexColumn u-marginBottom10 u-width60" data-post-id="60f750086237" data-is-icon-29px="true" data-is-vertical="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_share_widget-----60f750086237---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal" data-action="multivote" data-action-value="60f750086237" data-action-type="long-press" data-action-source="post_share_widget-----60f750086237---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="60f750086237"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-flexOrderNegative1 u-height20 u-marginBottom7"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-block u-marginAuto" data-action="show-recommends" data-action-value="60f750086237">1.7K</button></span></div></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse is-active u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="remove-from-bookmarks" data-action-value="60f750086237" data-action-source="post_share_widget-----60f750086237---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li></ul></div></aside><div class="postActionsBar uiScale uiScale-ui--regular uiScale-caption--regular js-postActionsBar is-visible"><div class="postActionsBar-container container"><div class="postActionsBar-content row u-boxShadowNormal js-postActionsBarContent"><div class="postActions"><div class="u-height44 u-maxWidth1250 u-marginAuto u-relative"><div class="u-absolute u-right0 u-marginRight20 u-sizeFullHeight u-flexCenter"><div class="u-floatLeft"><div class="u-floatRight buttonSet"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="respond" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse is-active u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="remove-from-bookmarks" data-action-value="60f750086237" data-action-source="post_actions_bar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></div></div><div class="u-xs-hide u-width255 u-height44 u-floatLeft js-readNextMetabarRight"><div class="streamItem streamItem--placementCardMetabar js-streamItem"><div class="readNextPromo readNextPromo--chromeless"><div class="buttonSet-separator u-floatLeft"></div><div class="js-trackedPost" data-post-id="c751538131ac" data-source="read_next_metabar----------41" data-tracking-context="placement" data-scroll="fixed"><a class="link link--noUnderline u-baseColor--link u-block" href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-10-gradient-boosting-c751538131ac?source=read_next_metabar----------41"><div class="uiScale uiScale-ui--small uiScale-caption--small readNextPromo-postInfo"><div class="ui-caption u-marginTop5 readNextPromo-callToAction u-accentColor--textNormal u-uiTextBold">Next story</div><h4 class="ui-h4 readNextPromo-postTitle u-block u-noWrapWithEllipsis u-contentSansBold">Open Machine Learning Course. Topic 10. Gradient Boosting</h4></div></a></div></div></div></div></div><div class="container u-maxWidth740 u-sizeFullHeight u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="60f750086237" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_actions_bar-----60f750086237---------------------clap_footer"><div class="u-relative u-foreground"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="60f750086237" data-action-type="long-press" data-action-source="post_actions_bar-----60f750086237---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><g fill-rule="evenodd"><path d="M13.739 1l.761 2.966L15.261 1z"></path><path d="M16.815 4.776l1.84-2.551-1.43-.471z"></path><path d="M10.378 2.224l1.84 2.551-.408-3.022z"></path><path d="M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><g fill-rule="evenodd"><path d="M13.738 1l.762 2.966L15.262 1z"></path><path d="M18.634 2.224l-1.432-.47-.408 3.022z"></path><path d="M11.79 1.754l-1.431.47 1.84 2.552z"></path><path d="M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="60f750086237">1.7K</button></span></div></div></div></div></div></div></div></div><style class="js-collectionStyle">
.u-accentColor--borderLight {border-color: #02B875 !important;}
.u-accentColor--borderNormal {border-color: #02B875 !important;}
.u-accentColor--borderDark {border-color: #1C9963 !important;}
.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #02B875 !important;}
.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #02B875 !important;}
.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #1C9963 !important;}
.u-accentColor--textNormal {color: #1C9963 !important;}
.u-accentColor--hoverTextNormal:hover {color: #1C9963 !important;}
.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #1C9963 !important;}
.u-accentColor--textDark {color: #1C9963 !important;}
.u-accentColor--backgroundLight {background-color: #02B875 !important;}
.u-accentColor--backgroundNormal {background-color: #02B875 !important;}
.u-accentColor--backgroundDark {background-color: #1C9963 !important;}
.u-accentColor--buttonDark {border-color: #1C9963 !important; color: #1C9963 !important;}
.u-accentColor--buttonDark:hover {border-color: #1C9963 !important;}
.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #1C9963 !important; fill: #1C9963 !important;}
.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #02B875 !important; color: #1C9963 !important;}
.u-accentColor--buttonNormal:hover {border-color: #1C9963 !important;}
.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #02B875 !important; fill: #02B875 !important;}
.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #1C9963 !important; border-color: #1C9963 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #02B875 !important; border-color: #02B875 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #1C9963 !important;}
.u-accentColor--highlightFaint {background-color: rgba(233, 253, 240, 1) !important;}
.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(125, 255, 179, 1) !important;}
.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(233, 253, 240, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(233, 253, 240, 1), rgba(233, 253, 240, 1));}
.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(173, 255, 207, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(173, 255, 207, 1), rgba(173, 255, 207, 1));}
.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(125, 255, 179, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}
.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(125, 255, 179, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}
.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(125, 255, 179, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class="js-collectionStyleConstant">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}
.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(255, 255, 255, 0.4) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(255, 255, 255, 0.4980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}
.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}
.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(0, 0, 0, 0.4) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="quote" data-action-source="quote_menu--------------------------highlight_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="quote-respond" data-action-source="quote_menu--------------------------respond_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="twitter" data-action-source="quote_menu" data-skip-onboarding="true"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="highlight" data-action-source="quote_menu--------------------------privatenote_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"33632-059e361","currentUser":{"userId":"a988255767e5","username":"0109chenchen","name":"陈辰","email":"0109chenchen@gmail.com","imageId":"0*P-t7h_lDOjJiWVxI.","twitterScreenName":"0109chenchen","createdAt":1463006784997,"isVerified":true,"subscriberEmail":"","onboardingStatus":1,"googleAccountId":"104969029311726520174","googleEmail":"0109chenchen@gmail.com","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":true,"hightowerLastLockedAt":0},"currentUserHasUnverifiedEmail":false,"isAuthenticated":true,"isCurrentUserVerified":true,"language":"zh-cn","mediumTwitterScreenName":"medium","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.sSNLBL0zi5BWVp4gJcuzqw.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.S7356n6LBseGGEx0Avxzng.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.R4Z1Bl6LohSM1oRSQ_gbJA.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.lFcVOa9Ax8v0ud745p9xIA.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.OM_Lvs_caTF1Fofc14d0Ng.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.CzX6ttriZ_q3KYPaiNXuzw.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.AxpoSoOIvhoAGzuOoj5orQ.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.BVQI0_KVa8XfbTvOLOVFsQ.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.oGj7bY7Ny-SWzMrYzccKeQ.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.mxIgO8Ehuyccn0jcgf68wg.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.VKeSHsc9Zb1ckcynwkC7KA.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1525771856196:799eb846d98e","useragent":{"browser":"chrome","family":"chrome","os":"mac","version":66,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":5,"isSearchBot":false,"isSyndicationBot":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"enable_export_members":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","enable_sms":true,"disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"disable_followed_tag_fan_out":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"enable_sequence_carousel":true,"enable_multirecommends":true,"enable_post_monger_v2":true,"enable_post_monger_v3":true,"enable_hightower_editor_copy_v2":true,"enable_user_post_metering":true,"max_premium_content_per_user_under_metering":3,"tag_intercom_user_on_metering_count":3,"enable_topic_writer_onboarding":true,"enable_strong_graph_chp_reorder":true,"enable_unsplash_images":true,"enable_top_stories_for_you":true,"enable_ios_member_post_labeling":true,"enable_lite_profile":true,"enable_li_search_collection":true,"enable_homepage_remodel":true,"enable_signin_wall_custom_domain":true,"enable_standalone_profile_edit_page":true,"enable_standalone_user_follow_pages":true,"enable_post_footer_copy":true,"app_download_email_template":"control","enable_email_sign_in_captcha":true,"enable_topic_lifecycle_email":true,"enable_curation_post_locking":true,"ios_hide_avatars_on_home":true,"raise_editors_picks_digest":"control","android_disable_author_avatars":true,"enable_persistent_user_id_for_dnt":true,"enable_truncated_rss_for_tags_and_topics":true,"enable_ios_related_reads_api_change":true,"enable_ios_related_reads_ui_large":true,"enable_ios_responses_collapsed":true},"xsrfToken":"mVkkZYUx0tcp","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"},{"id":10,"url":"https://glyph.medium.com/css/elv8.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"35cba0d82deaa7f8\",\"ot-tracer-traceid\":\"2ac8a72a65d65156\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email","user_friends"],"connect":["public_profile","email","user_friends"],"login":["public_profile","email","user_friends"],"share":["public_profile","email","user_friends","publish_actions"]}},"mailingListArchiveUploadSizeMb":2,"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":1,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"li_post_page","type":0,"url":"www.calendly.com"},{"promptId":"li_home_page","type":1,"url":"mediumuserfeedback.typeform.com/to/GcFjEO"},{"promptId":"li_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","paypalClientMode":"production","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"CA"}
// ]]></script><script charset="UTF-8" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/main-base.bundle.sSNLBL0zi5BWVp4gJcuzqw.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"60f750086237","versionId":"13481de034af","creatorId":"5572ec600139","creator":{"userId":"5572ec600139","name":"Yury Kashnitskiy","username":"yurykashnitskiy","createdAt":1490200873092,"lastPostCreatedAt":1525724892687,"imageId":"0*JtleyoApNKIjJU5F.","backgroundImageId":"","bio":"Data Scientist at Mail.Ru Group","twitterScreenName":"","socialStats":{"userId":"5572ec600139","usersFollowedCount":33,"usersFollowedByCount":650,"type":"SocialStats"},"social":{"userId":"a988255767e5","targetUserId":"5572ec600139","type":"Social"},"facebookAccountId":"1414603208563160","allowNotes":1,"isNsfw":false,"type":"User"},"homeCollection":{"id":"b76595fb6cfc","name":"Open Machine Learning Course","slug":"open-machine-learning-course","tags":["MACHINE LEARNING","DATA SCIENCE","DATA ANALYSIS","EDUCATION","KAGGLE"],"creatorId":"5572ec600139","description":"A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.","shortDescription":"A series of articles on basics of Machine Learning.","image":{"imageId":"1*b5pfoCQz20rjh79OPSQWQg.jpeg","filter":"","backgroundSize":"","originalWidth":271,"originalHeight":271,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":1394,"activeAt":1523869737051},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":true,"isNewsletterSubscribed":true,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*MxsqShnPs3RXMScwl5HhsQ.jpeg","filter":"","backgroundSize":"","originalWidth":1479,"originalHeight":822,"strategy":"resample","height":0,"width":0},"twitterUsername":"odsai_en","facebookPageName":"DataChallenges","publicEmail":"yury.kashnitsky@gmail.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":6,"number":10,"postIds":[]}}],"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF02B875","point":0},{"color":"#FF00AB6B","point":0.1},{"color":"#FF1C9963","point":0.2},{"color":"#FF092E20","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFE9FDF0","point":0.1},{"color":"#FFE2FAEE","point":0.2},{"color":"#FFADFFCF","point":0.6},{"color":"#FF7DFFB3","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"},"homeCollectionId":"b76595fb6cfc","title":"Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data","detectedLanguage":"en","latestVersion":"13481de034af","latestPublishedVersion":"13481de034af","hasUnpublishedEdits":false,"latestRev":2033,"createdAt":1522614874046,"updatedAt":1525726044415,"acceptedAt":0,"firstPublishedAt":1522666538059,"latestPublishedAt":1525726042975,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"This week, we’ll cover two reasons for Vowpal Wabbit’s exceptional training speed, namely, online learning and hashing trick, in both…","bodyModel":{"paragraphs":[{"name":"beb0","type":3,"text":"Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data","markups":[]},{"name":"808f","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*OYzZCTaTs41J4NyTTjBdHw.png","originalWidth":400,"originalHeight":300,"isFeatured":true}},{"name":"1d93","type":1,"text":"This week, we’ll cover two reasons for Vowpal Wabbit’s exceptional training speed, namely, online learning and hashing trick, in both theory and practice. We will try it out with news, movie reviews, and StackOverflow questions.","markups":[]},{"name":"5b90","type":3,"text":"Outline","markups":[]},{"name":"8a76","type":10,"text":"Stochastic gradient descent and online learning","markups":[]},{"name":"9613","type":9,"text":"1.1. SGD","markups":[]},{"name":"c0c1","type":9,"text":"1.2. Online approach to learning","markups":[]},{"name":"543e","type":1,"text":"2. Categorical data processing: Label Encoding, One-Hot Encoding, Hashing trick","markups":[]},{"name":"997b","type":9,"text":"2.1. Label Encoding","markups":[]},{"name":"9a91","type":9,"text":"2.2. One-Hot Encoding","markups":[]},{"name":"a11c","type":9,"text":"2.3. Hashing trick","markups":[]},{"name":"d332","type":1,"text":"3. Vowpal Wabbit","markups":[]},{"name":"a1bb","type":9,"text":"3.1. News. Binary classification","markups":[]},{"name":"476f","type":9,"text":"3.2. News. Multiclass classification","markups":[]},{"name":"8103","type":9,"text":"3.3. IMDB reviews","markups":[]},{"name":"e738","type":9,"text":"3.4. Classifying gigabytes of StackOverflow questions","markups":[]},{"name":"6f25","type":1,"text":"4. Assignment #8","markups":[]},{"name":"e9ae","type":1,"text":"5. Useful resources","markups":[]},{"name":"82f8","type":1,"text":"The following content is better viewed and reproduced as a Jupyter-notebook or a Kaggle kernel.","markups":[{"type":3,"start":59,"end":75,"href":"http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic08_sgd_hashing_vowpal_wabbit/topic8_sgd_hashing_vowpal_wabbit.ipynb?flush_cache=true","title":"","rel":"noopener","anchorType":0},{"type":3,"start":81,"end":94,"href":"https://www.kaggle.com/kashnitsky/vowpal-wabbit-tutorial-blazingly-fast-learning","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":95}]},{"name":"0726","type":3,"text":"1. Stochastic gradient descent and online learning","markups":[]},{"name":"c0e9","type":3,"text":"1.1. Stochastic gradient descent","markups":[]},{"name":"86f0","type":1,"text":"Despite the fact that gradient descent is one of the first things learned in machine learning and optimization courses, it is one of its modifications, Stochastic Gradient Descent (SGD), that is hard to top.","markups":[]},{"name":"6d3c","type":1,"text":"Recall that the idea of gradient descent is to minimize some function by making small steps in the direction of the fastest decrease. This method was named due to the following fact from calculus: vector","markups":[]},{"name":"58db","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*VOJCm7l4-nm1bOnxBWf_pw.png","originalWidth":336,"originalHeight":80}},{"name":"38ba","type":1,"text":"of partial derivatives of the function f(x) = f(x1, …, xn) points to the direction of the fastest function growth. It means that, by moving in the opposite direction (antigradient), it is possible to decrease the function value with the fastest rate.","markups":[]},{"name":"eb42","type":4,"text":"A snowboarder (me) in Sheregesh, Russia’s most popular winter resort. Highly recommended it if you like skiing or snowboarding.","markups":[],"layout":1,"metadata":{"id":"0*tTTrP_gLIMONG55t.jpg","originalWidth":1280,"originalHeight":720}},{"name":"dbde","type":1,"text":"In addition to advertising beautiful landscapes, this picture depicts the idea of gradient descent. If you want to ride as fast as possible, you need to choose the path of steepest descent. Calculating antigradients can be seen as evaluating the slope at various spots.","markups":[]},{"name":"09da","type":1,"text":"Example","markups":[{"type":1,"start":0,"end":7}]},{"name":"02ee","type":1,"text":"The paired regression problem can be solved with gradient descent. Let us predict one variable using another: height with weight. Assume that these variables are linearly dependent. We will use the SOCR dataset.","markups":[{"type":3,"start":198,"end":202,"href":"http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data","title":"","rel":"","anchorType":0}]},{"name":"5059","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"2f3f305f3fccf2b03c3f389bd62ec880","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"86fc","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"ea80c6b8cb6cbf04e81cc15dc3238c34","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"ac93","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*8W7KT3ApZhiuu9GqRFUSVQ.png","originalWidth":381,"originalHeight":261}},{"name":"8ef9","type":1,"text":"Here we have a vector x of dimension ℓ (weight of every person i.e. training sample) and y, a vector containing the height of every person in the dataset.","markups":[{"type":2,"start":22,"end":24},{"type":2,"start":89,"end":90}]},{"name":"118e","type":1,"text":"The task is the following: find weights w0 and w1 such that predicting height as yi = w0 + w_1 xi (where yi is i-th height value, xi is i-th weight value) minimizes the squared error (as well as mean squared error since 1/ℓ doesn’t make any difference):","markups":[{"type":2,"start":40,"end":42},{"type":2,"start":47,"end":49},{"type":2,"start":81,"end":97},{"type":2,"start":105,"end":107},{"type":2,"start":111,"end":112},{"type":2,"start":130,"end":132},{"type":2,"start":136,"end":137}]},{"name":"8079","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*m0ZHOM7spOMZUICtenyxfQ.png","originalWidth":1436,"originalHeight":208}},{"name":"aa27","type":1,"text":"We will use gradient descent, utilizing the partial derivatives of SE(w0,w1) over weights w0 and w1. An iterative training procedure is then defined by simple update formulas (we change model weights in small steps, proportional to a small constant η, towards the antigradient of the function SE(w0, w1)):","markups":[{"type":2,"start":67,"end":76},{"type":2,"start":90,"end":92},{"type":2,"start":97,"end":99},{"type":2,"start":249,"end":250},{"type":2,"start":293,"end":304}]},{"name":"7b31","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*EDPZnoeEi7C4kIW1fBp72w.png","originalWidth":485,"originalHeight":202}},{"name":"a34e","type":1,"text":"Computing the partial derivatives, we get the following:","markups":[]},{"name":"f1cf","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*395VXoPthjuRf3AVO7Z6fQ.png","originalWidth":598,"originalHeight":110}},{"name":"f38d","type":1,"text":"This math works quite well as long as the amount of data is not large (we will not discuss issues with local minima, saddle points, choosing the learning rate, moments and other stuff – these topics are covered very thoroughly in the Numeric Computation chapter in “Deep Learning”). There is an issue with batch gradient descent — the gradient evaluation requires the summation of a number of values for every object from the training set. In other words, the algorithm requires a lot of iterations, and every iteration recomputes weights with formula which contains a sum over the whole training set. What happens when we have billions of training samples?","markups":[{"type":3,"start":230,"end":261,"href":"http://www.deeplearningbook.org/contents/numerical.html","title":"","rel":"","anchorType":0}]},{"name":"894a","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*HhCeBJdPY4OH1my-.jpeg","originalWidth":600,"originalHeight":336}},{"name":"4295","type":1,"text":"Hence the motivation for stochastic gradient descent! Simply put, we throw away the summation sign and update the weights only over single training samples (or a small number of them). In our case, we have the following:","markups":[]},{"name":"f860","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*Hk42uEbVu1MbqbUBbyZWEQ.png","originalWidth":513,"originalHeight":120}},{"name":"b999","type":1,"text":"With this approach, there is no guarantee that we will move in best possible direction at every iteration. Therefore, we may need many more iterations, but we get much faster weight updates.","markups":[]},{"name":"28d5","type":1,"text":"Andrew Ng has a good illustration of this in his machine learning course. Let’s take a look.","markups":[{"type":3,"start":49,"end":72,"href":"https://www.coursera.org/learn/machine-learning","title":"","rel":"","anchorType":0}]},{"name":"b4d1","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*o692cOFyNxfJzYSL.png","originalWidth":388,"originalHeight":309}},{"name":"97d8","type":1,"text":"These are the contour plots for some function, and we want to find the global minimum of this function. The red curve shows weight changes (in this picture, θ0 and θ1 correspond to our w0 and w1). According to the properties of a gradient, the direction of change at every point is orthogonal to contour plots. With stochastic gradient descent, weights are changing in a less predictable manner, and it even may seem that some steps are wrong by leading away from minima; however, both procedures converge to the same solution.","markups":[{"type":2,"start":157,"end":159},{"type":2,"start":164,"end":166},{"type":2,"start":185,"end":187},{"type":2,"start":192,"end":194}]},{"name":"abf1","type":3,"text":"1.2. Online approach to learning","markups":[]},{"name":"cade","type":1,"text":"Stochastic gradient descent gives us practical guidance for training both classifiers and regressors with large amounts of data up to hundreds of GBs (depending on computational resources).","markups":[]},{"name":"7367","type":1,"text":"Considering the case of paired regression, we can store the training data set (X,y) in HDD without loading it into RAM (where it simply won’t fit), read objects one by one, and update the weights of our model:","markups":[{"type":2,"start":78,"end":83}]},{"name":"f33d","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*Hk42uEbVu1MbqbUBbyZWEQ.png","originalWidth":513,"originalHeight":120}},{"name":"1f39","type":1,"text":"After working through the whole training dataset, our loss function (for example, quadratic squared root error in regression or logistic loss in classification) will decrease, but it usually takes dozens of passes over the training set to make the loss small enough.","markups":[]},{"name":"6d9c","type":1,"text":"This approach to learning is called online learning, and this name emerged even before machine learning MOOC-s turned mainstream.","markups":[{"type":1,"start":36,"end":51}]},{"name":"8415","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*xuawoa5-SB2JAxOxVtLmrA.jpeg","originalWidth":437,"originalHeight":484}},{"name":"f2d8","type":1,"text":"We did not discuss many specifics about SGD here. If you want dive into theory, I highly recommend “Convex Optimization” by Stephen Boyd. Now, we will introduce the Vowpal Wabbit library, which is good for training simple models with huge data sets thanks to stochastic optimization and another trick, feature hashing.","markups":[{"type":3,"start":99,"end":136,"href":"https://www.amazon.com/Convex-Optimization-Stephen-Boyd/dp/0521833787","title":"","rel":"","anchorType":0}]},{"name":"c21d","type":1,"text":"In scikit-learn, classifiers and regressors trained with SGD are named SGDClassifier and SGDRegressor in sklearn.linear_model. These are nice implementations of SGD, but we'll focus on VW since it is more performant than sklearn's SGD models in many aspects.","markups":[{"type":10,"start":71,"end":84},{"type":10,"start":89,"end":101},{"type":10,"start":105,"end":125}]},{"name":"3671","type":3,"text":"2. Categorical feature processing: Label Encoding, One-Hot Encoding, and Hashing trick","markups":[]},{"name":"2552","type":1,"text":"Many classification and regression algorithms operate in Euclidean or metric space, implying that data is represented with vectors of real numbers. However, in real data, we often have categorical features with discrete values such as yes/no or January/February/…/December. We will see how to process this kind of data, particularly with linear models, and how to deal with many categorial features even when they have many unique values.","markups":[]},{"name":"abed","type":1,"text":"Let’s explore the UCI bank marketing dataset where most of features are categorial. Actually, more features are present in this dataset, explore this Jupyter notebook.","markups":[{"type":3,"start":18,"end":44,"href":"https://archive.ics.uci.edu/ml/datasets/bank+marketing","title":"","rel":"","anchorType":0},{"type":3,"start":145,"end":149,"href":"http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic08_sgd_hashing_vowpal_wabbit/topic8_sgd_hashing_vowpal_wabbit.ipynb?flush_cache=true","title":"","rel":"","anchorType":0}]},{"name":"bd6a","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"32d2e16419d4f21256b402cfe0e5170b","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"60aa","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*-PNu9d3xC1gZi6M7l-eNrA.png","originalWidth":2224,"originalHeight":658}},{"name":"9b02","type":1,"text":"We can see that most of features are not represented by numbers. This poses a problem because we cannot use most machine learning methods (at least those implemented in scikit-learn) out-of-the-box.","markups":[{"type":10,"start":169,"end":181}]},{"name":"ac63","type":1,"text":"Let’s dive into the “education” feature.","markups":[]},{"name":"ffbc","type":8,"text":"df['education'].value_counts().plot.barh();","markups":[]},{"name":"d88b","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*qQ9uuhYJYeLDGONr4n6S3g.png","originalWidth":443,"originalHeight":247}},{"name":"b48b","type":1,"text":"The most straightforward solution is to map each value of this feature into a unique number. For example, we can map university.degree to 0, basic.9y to 1, and so on. You can use sklearn.preprocessing.LabelEncoder to perform this mapping.","markups":[{"type":10,"start":117,"end":134},{"type":10,"start":141,"end":149},{"type":10,"start":179,"end":213}]},{"name":"ae7f","type":8,"text":"label_encoder = LabelEncoder()","markups":[]},{"name":"f456","type":1,"text":"The fit method of this class finds all unique values and builds the actual mapping between categories and numbers, and the transform method converts the categories into numbers. After fit is executed, label_encoder will have the classes_ attribute with all unique values of the feature. Let us count them to make sure the transformation was correct.","markups":[{"type":10,"start":4,"end":7},{"type":10,"start":123,"end":132},{"type":10,"start":184,"end":187},{"type":10,"start":201,"end":214},{"type":10,"start":229,"end":237}]},{"name":"6779","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"3a2c5d6e3ed2ebd79c8c54b7d9dd4863","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"6391","type":8,"text":"# Output:\n \n{0: 'basic.4y', 1: 'basic.6y', 2: 'basic.9y', 3: 'high.school', 4: 'illiterate', 5: 'professional.course', 6: 'university.degree', 7: 'unknown'}","markups":[{"type":10,"start":0,"end":156}]},{"name":"7ef6","type":8,"text":"df['education'] = mapped_education df.head()","markups":[]},{"name":"455d","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*LiRc1fhg7Rtd3bx1MxrMHQ.png","originalWidth":2094,"originalHeight":626}},{"name":"a3ec","type":1,"text":"Let’s apply the transformation to other columns of type object.","markups":[{"type":10,"start":56,"end":62}]},{"name":"e432","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"efd03e7666cc944267511390b950715c","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"4ebc","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*oLYzIbspnplCxuedwnYOZQ.png","originalWidth":1844,"originalHeight":638}},{"name":"cedd","type":1,"text":"The main issue with this approach is that we have now introduced some relative ordering where it might not exist.","markups":[]},{"name":"16e1","type":1,"text":"For example, we implicitly introduced algebra over the values of the job feature where we can now substract the job of client #2 from the job of client #1 :","markups":[]},{"name":"369e","type":8,"text":"df.loc[1].job - df.loc[2].job\n# -1.0","markups":[{"type":10,"start":30,"end":36}]},{"name":"a89a","type":1,"text":"Does this operation make any sense? Not really. Let’s try to train logisitic regression with this feature transformation.","markups":[]},{"name":"c323","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"24a1afa55e36742957d5b9260866e5b7","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"2a05","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*QWZq5rCEPFREdnYOa48ipA.png","originalWidth":1838,"originalHeight":426}},{"name":"c9b7","type":1,"text":"We can see that logistic regression never predicts class 1. In order to use linear models with categorial features, we will use a different approach: One-Hot Encoding.","markups":[]},{"name":"fadb","type":3,"text":"2.2. One-Hot Encoding","markups":[]},{"name":"35cc","type":1,"text":"Suppose that some feature can have one of 10 unique values. One-hot encoding creates 10 new features corresponding to these unique values, all of them except one are zeros.","markups":[{"type":2,"start":151,"end":161}]},{"name":"5c8d","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"95fabedc19bf0dab86abef8daa7c6288","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"d317","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*004LK2vgvRblVTx2dn164Q.png","originalWidth":339,"originalHeight":74}},{"name":"3604","type":1,"text":"This idea is implemented in the OneHotEncoder class from sklearn.preprocessing. By default OneHotEncoder transforms data into a sparse matrix to save memory space because most of the values are zeroes and because we do not want to take up more RAM. However, in this particular example, we do not encounter such problems, so we are going to use a \"dense\" matrix representation.","markups":[{"type":10,"start":32,"end":45},{"type":10,"start":57,"end":78},{"type":10,"start":91,"end":104}]},{"name":"4df8","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"c38d11ada7b60024e0a43d78f43f04f1","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"ae9f","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*3aV37glp1NSghP0o-H5HPA.png","originalWidth":749,"originalHeight":199}},{"name":"188c","type":1,"text":"We have 53 columns that correspond to the number of unique values of categorical features in our data set. When transformed with One-Hot Encoding, this data can be used with linear models:","markups":[]},{"name":"d218","type":8,"text":"print(logistic_regression_accuracy_on(encoded_categorical_columns,  labels))","markups":[]},{"name":"64ab","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*WRZth-h2pxxLRGO7GBuRfw.png","originalWidth":545,"originalHeight":126}},{"name":"d289","type":3,"text":"2.3. Hashing trick","markups":[]},{"name":"fbb4","type":1,"text":"Real data can be volatile, meaning we cannot guarantee that new values of categorial features will not occur. This issue hampers using a trained model on new data. Besides that, LabelEncoder requires preliminary analysis of the whole dataset and storage of constructed mappings in memory, which makes it difficult to work with large datasets.","markups":[{"type":10,"start":178,"end":190}]},{"name":"8f45","type":1,"text":"There is a simple approach to vectorization of categorial data based on hashing and is known as, not-so-surprisingly, the hashing trick.","markups":[]},{"name":"b6b9","type":1,"text":"Hash functions can help us find unique codes for different feature values, for example:","markups":[]},{"name":"07e9","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"1956e90f1e7f9b08d6c7dac4928125bc","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"27ad","type":8,"text":"# university.degree -\x3e -6241459093488141593\n# high.school -\x3e 7728198035707179500\n# illiterate -\x3e -7360093633803373451","markups":[{"type":10,"start":0,"end":117}]},{"name":"62ab","type":1,"text":"We will not use negative values or values of high magnitude, so we restrict the range of values for the hash function:","markups":[]},{"name":"7762","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"2650d9a3533670802189dcbe44a7b6ea","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"211d","type":8,"text":"# university.degree -\x3e 7\n# high.school -\x3e 0\n# illiterate -\x3e 24","markups":[{"type":10,"start":0,"end":62}]},{"name":"d4b0","type":1,"text":"Imagine that our data set contains a single (i.e. not married) student, who received a call on Monday. His feature vectors will be created similarly as in the case of One-Hot Encoding but in the space with fixed range for all features:","markups":[]},{"name":"185d","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"d6b26af94b4d838789fc7ddb092c07b1","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"6a85","type":8,"text":"# job=student -\x3e 20\n# marital=single -\x3e 23\n# day_of_week=mon -\x3e 9","markups":[{"type":10,"start":0,"end":65}]},{"name":"643e","type":1,"text":"We want to point out that we hash not only feature values but also pairs of feature name + feature value. It is important to do this so that we can distinguish the same values of different features.","markups":[{"type":1,"start":76,"end":104}]},{"name":"9e0a","type":1,"text":"Is it possible to have a collision when using hash codes? Sure, it is possible, but it is a rare case with large enough hashing spaces. Even if collision occurs, regression or classification metrics will not suffer much. In this case, hash collisions work as a form of regularization.","markups":[]},{"name":"0e1d","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*aWJVQkWcJukZKIqn.jpeg","originalWidth":496,"originalHeight":360}},{"name":"7bc3","type":1,"text":"You may be saying “WTF?”; hashing seems counterintuitive. This is true, but these heuristics sometimes are, in fact, the only plausible approach to work with categorial data. Moreover, this technique has proven to just work. As you work more with data, you may see this for yourself.","markups":[]},{"name":"9fdf","type":3,"text":"3. Vowpal Wabbit","markups":[]},{"name":"37c0","type":1,"text":"Vowpal Wabbit (VW) is one of the most widespread machine learning libraries used in industry. It is prominent for its training speed and support of many training modes, especially for online learning with big and high-dimentional data. This is one of the major merits of the library. Also, with the hashing trick implemented, Vowpal Wabbit is a perfect choice for working with text data.","markups":[{"type":3,"start":0,"end":13,"href":"https://github.com/JohnLangford/vowpal_wabbit","title":"","rel":"","anchorType":0}]},{"name":"addd","type":1,"text":"Shell is the main interface for VW. Try this command:","markups":[]},{"name":"8f4f","type":1,"text":"!vw — help","markups":[{"type":10,"start":0,"end":10}]},{"name":"fb8f","type":1,"text":"Vowpal Wabbit reads data from files or from standard input stream (stdin) with the following format:","markups":[]},{"name":"d9c3","type":1,"text":"[Label] [Importance] [Tag]|Namespace Features |Namespace Features ... |Namespace Features","markups":[{"type":10,"start":0,"end":89}]},{"name":"9e1d","type":1,"text":"Namespace=String[:Value]","markups":[{"type":10,"start":0,"end":24}]},{"name":"7c72","type":1,"text":"Features=(String[:Value] )*","markups":[{"type":10,"start":0,"end":27}]},{"name":"eeaf","type":1,"text":"here [] denotes non-mandatory elements, and (…)* means multiple inputs allowed.","markups":[]},{"name":"73f6","type":9,"text":"Label is a number. In the case of classification, it is usually 1 and -1; for regression, it is a real float value","markups":[{"type":1,"start":0,"end":5}]},{"name":"6faf","type":9,"text":"Importance is a number. It denotes the sample weight during training. Setting this helps when working with imbalanced data.","markups":[{"type":1,"start":0,"end":10}]},{"name":"edaf","type":9,"text":"Tag is a string without spaces. It is the “name” of the sample that VW saves upon prediction. In order to separate Tag from Importance, it is better to start Tag with the ‘ character.","markups":[{"type":1,"start":0,"end":3}]},{"name":"1e9e","type":9,"text":"Namespace is for creating different feature spaces.","markups":[{"type":1,"start":0,"end":9}]},{"name":"f52a","type":9,"text":"Features are object features inside a given Namespace. Features have weight 1.0 by default, but it can be changed, for example feature:0.1.","markups":[{"type":1,"start":0,"end":8},{"type":1,"start":44,"end":53}]},{"name":"e8a1","type":1,"text":"The following string matches the VW format:","markups":[]},{"name":"44a8","type":8,"text":"1 1.0 |Subject WHAT car is this |Organization University of Maryland:0.5 College Park","markups":[{"type":10,"start":0,"end":85}]},{"name":"6896","type":1,"text":"Let’s check the format by running VW with this training sample:","markups":[]},{"name":"837d","type":8,"text":"! echo '1 1.0 |Subject WHAT car is this |Organization University of Maryland:0.5 College Park' | vw","markups":[]},{"name":"3904","type":8,"text":"# Output:","markups":[]},{"name":"68e1","type":8,"text":"Num weight bits = 18\nlearning rate = 0.5\ninitial_t = 0\npower_t = 0.5\nusing no cache\nReading datafile = \nnum sources = 1\naverage  since         example        example  current  current  current\nloss     last          counter         weight    label  predict features\n1.000000 1.000000            1            1.0   1.0000   0.0000       10\n\nfinished run\nnumber of examples per pass = 1\npasses used = 1\nweighted example sum = 1.000000\nweighted label sum = 1.000000\naverage loss = 1.000000\nbest constant = 1.000000\nbest constant's loss = 0.000000\ntotal feature number = 10","markups":[]},{"name":"3eac","type":1,"text":"VW is a wonderful tool for working with text data. We’ll illustrate it with the 20newsgroups dataset, which contains letters from 20 different newsletters.","markups":[{"type":3,"start":80,"end":100,"href":"http://scikit-learn.org/stable/datasets/twenty_newsgroups.html","title":"","rel":"","anchorType":0}]},{"name":"92c4","type":3,"text":"3.1. News. Binary classification.","markups":[]},{"name":"509c","type":8,"text":"# load data with sklearn's function\nnewsgroups = fetch_20newsgroups(PATH_TO_ALL_DATA)\nnewsgroups['target_names']","markups":[]},{"name":"19c1","type":1,"text":"The 20 topics are ['alt.atheism', 'comp.graphics', 'comp.os.ms-windows.misc', 'comp.sys.ibm.pc.hardware', 'comp.sys.mac.hardware', 'comp.windows.x', 'misc.forsale', 'rec.autos', 'rec.motorcycles', 'rec.sport.baseball', 'rec.sport.hockey', 'sci.crypt', 'sci.electronics', 'sci.med', 'sci.space', 'soc.religion.christian', 'talk.politics.guns', 'talk.politics.mideast', 'talk.politics.misc', 'talk.religion.misc']","markups":[{"type":10,"start":18,"end":411}]},{"name":"3afc","type":1,"text":"Lets look at the first document in this collection:","markups":[]},{"name":"d804","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"394b087cb907c3e2f3375b4092a142f3","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"8d40","type":8,"text":"# Output:","markups":[]},{"name":"56a6","type":8,"text":"-----\nrec.autos\n-----\nFrom: lerxst@wam.umd.edu (where's my thing)\nSubject: WHAT car is this!?\nNntp-Posting-Host: rac3.wam.umd.edu\nOrganization: University of Maryland, College Park\nLines: 15\n\n I was wondering if anyone out there could enlighten me on this car I saw\nthe other day. It was a 2-door sports car, looked to be from the late 60s/\nearly 70s. It was called a Bricklin. The doors were really small. In addition,\nthe front bumper was separate from the rest of the body. This is \nall I know. If anyone can tellme a model name, engine specs, years\nof production, where this car is made, history, or whatever info you\nhave on this funky looking car, please e-mail.\n\nThanks,\n- IL\n   ---- brought to you by your neighborhood Lerxst ----\n----","markups":[]},{"name":"485c","type":1,"text":"Now we convert the data into something Vowpal Wabbit can understand. We will throw away words shorter than 3 symbols. Here, we will skip some important NLP stages such as stemming and lemmatization; however, we will later see that VW solves the problem even without these steps.","markups":[]},{"name":"a880","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"2f16a87e3c281e87692afb695c31174a","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"4333","type":8,"text":"# Output:","markups":[]},{"name":"87c9","type":8,"text":"'1 |text from lerxst wam umd edu where thing subject what car this nntp posting host rac3 wam umd edu organization university maryland college park lines was wondering anyone out there could enlighten this car saw the other day was door sports car looked from the late 60s early 70s was called bricklin the doors were really small addition the front bumper was separate from the rest the body this all know anyone can tellme model name engine specs years production where this car made history whatever info you have this funky looking car please mail thanks brought you your neighborhood lerxst\\n'","markups":[{"type":10,"start":0,"end":598}]},{"name":"99ac","type":1,"text":"We split the dataset into train and test and write these into separate files. We will consider a document as positive if it corresponds to rec.autos. Thus, we are constructing a model which distinguishes articles about cars from other topics:","markups":[{"type":1,"start":139,"end":148}]},{"name":"1424","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"99d5ddefb5037b33ccb05ba708c62e1f","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"7798","type":1,"text":"Now, we pass the created training file to Vowpal Wabbit. We solve the classification problem with a hinge loss function (linear SVM). The trained model will be saved in the 20news_model.vw file:","markups":[{"type":10,"start":173,"end":188}]},{"name":"bfbd","type":8,"text":"!vw -d $PATH_TO_ALL_DATA/20news_train.vw \\ --loss_function hinge -f $PATH_TO_ALL_DATA/20news_model.vw","markups":[]},{"name":"e5a0","type":8,"text":"# Output:","markups":[]},{"name":"8199","type":8,"text":"final_regressor = ../../data//20news_model.vw\nNum weight bits = 18\nlearning rate = 0.5\ninitial_t = 0\npower_t = 0.5\nusing no cache\nReading datafile = ../../data//20news_train.vw\nnum sources = 1\naverage  since         example        example  current  current  current\nloss     last          counter         weight    label  predict features\n1.000000 1.000000            1            1.0  -1.0000   0.0000      157\n0.911276 0.822551            2            2.0  -1.0000  -0.1774      159\n0.605793 0.300311            4            4.0  -1.0000  -0.3994       92\n0.419594 0.233394            8            8.0  -1.0000  -0.8167      129\n0.313998 0.208402           16           16.0  -1.0000  -0.6509      108\n0.196014 0.078029           32           32.0  -1.0000  -1.0000      115\n0.183158 0.170302           64           64.0  -1.0000  -0.7072      114\n0.261046 0.338935          128          128.0   1.0000  -0.7900      110\n0.262910 0.264774          256          256.0  -1.0000  -0.6425       44\n0.216663 0.170415          512          512.0  -1.0000  -1.0000      160\n0.176710 0.136757         1024         1024.0  -1.0000  -1.0000      194\n0.134541 0.092371         2048         2048.0  -1.0000  -1.0000      438\n0.104403 0.074266         4096         4096.0  -1.0000  -1.0000      644\n0.081329 0.058255         8192         8192.0  -1.0000  -1.0000      174\n\nfinished run\nnumber of examples per pass = 8485\npasses used = 1\nweighted example sum = 8485.000000\nweighted label sum = -7555.000000\naverage loss = 0.079837\nbest constant = -1.000000\nbest constant's loss = 0.109605\ntotal feature number = 2048932","markups":[]},{"name":"8914","type":1,"text":"VW prints a lot of interesting info while training (one can suppress it with the --quiet parameter). You can see documentation of the diagnostic output on GitHub. Note how average loss drops while training. For loss computation, VW uses samples it has never seen before, so this measure is usually accurate. Now, we apply our trained model to the test set, saving predictions into a file with the -p flag:","markups":[{"type":10,"start":81,"end":88},{"type":10,"start":397,"end":399},{"type":3,"start":155,"end":161,"href":"https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial#vws-diagnostic-information","title":"","rel":"","anchorType":0}]},{"name":"1b7a","type":8,"text":"!vw -i $PATH_TO_ALL_DATA/20news_model.vw -t -d $PATH_TO_ALL_DATA/20news_test.vw \\ -p $PATH_TO_ALL_DATA/20news_test_predictions.txt","markups":[]},{"name":"fced","type":1,"text":"Now we load our predictions, compute AUC, and plot the ROC curve:","markups":[]},{"name":"ed8e","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"7f0a50cc67a2e090a4e5233cc6f85c9d","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"d1c1","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*9cmeLXu__qM6Uw9Ju1oMgg.png","originalWidth":402,"originalHeight":288}},{"name":"9310","type":1,"text":"The AUC value we get shows that we have achieved high classification quality.","markups":[]},{"name":"98f6","type":3,"text":"3.2. News. Multiclass classification","markups":[]},{"name":"5f8f","type":1,"text":"We will use the same news dataset, but, this time, we will solve a multiclass classification problem. Vowpal Wabbit is a little picky – it wants labels starting from 1 till K, where K – is the number of classes in the classification task (20 in our case). So we will use LabelEncoder and add 1 afterwards (recall that LabelEncoder maps labels into range from 0 to K-1).","markups":[{"type":10,"start":102,"end":115},{"type":10,"start":318,"end":330}]},{"name":"9094","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"5f6422f5bea335ab95879bb585e7ee66","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"c20e","type":1,"text":"The data is the same, but we have changed the labels, train_labels_mult and test_labels_mult, into label vectors from 1 to 20.","markups":[{"type":10,"start":54,"end":71},{"type":10,"start":76,"end":92}]},{"name":"37ed","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"a9bd37a495dc62be5a5f90337698727f","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"6231","type":1,"text":"We train Vowpal Wabbit in multiclass classification mode, passing the oaa parameter(\"one against all\") with the number of classes. Also, let's see what parameters our model quality is dependent on (more info can be found in the official Vowpal Wabbit tutorial):","markups":[{"type":10,"start":70,"end":73},{"type":3,"start":228,"end":259,"href":"https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial","title":"","rel":"","anchorType":0}]},{"name":"b66f","type":9,"text":"learning rate (-l, 0.5 default) — rate of weight change on every step","markups":[]},{"name":"c4a7","type":9,"text":"learning rate decay ( — power_t, 0.5 default) — it is proven in practice, that, if the learning rate drops with the number of steps in stochastic gradient descent, we approach the minimum loss better","markups":[]},{"name":"bde4","type":9,"text":"loss function ( — loss_function) — the entire training algorithm depends on it. See docs for loss functions","markups":[{"type":3,"start":84,"end":88,"href":"https://github.com/JohnLangford/vowpal_wabbit/wiki/Loss-functions","title":"","rel":"","anchorType":0}]},{"name":"fe53","type":9,"text":"Regularization (-l1) — note that VW calculates regularization for every object. That is why we usually set regularization values to about 1e-20.","markups":[]},{"name":"9a74","type":1,"text":"Additionally, we can try automatic Vowpal Wabbit parameter tuning with Hyperopt.","markups":[{"type":3,"start":71,"end":79,"href":"https://github.com/hyperopt/hyperopt","title":"","rel":"","anchorType":0}]},{"name":"2af6","type":8,"text":"!vw — oaa 20 $PATH_TO_ALL_DATA/20news_train_mult.vw -f $PATH_TO_ALL_DATA/20news_model_mult.vw \\\n — loss_function=hinge","markups":[]},{"name":"efd3","type":8,"text":"!vw -i $PATH_TO_ALL_DATA/20news_model_mult.vw -t -d $PATH_TO_ALL_DATA/20news_test_mult.vw \\\n-p $PATH_TO_ALL_DATA/20news_test_predictions_mult.txt","markups":[]},{"name":"8514","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"16fd124b365c00cd53aeade89a2c3d3a","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"480c","type":1,"text":"Here is how often the model misclassifies atheism with other topics:","markups":[]},{"name":"897c","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"830f22705405e5b6f0b19b639413be1b","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"47fc","type":8,"text":"# Output:","markups":[]},{"name":"9701","type":8,"text":"rec.autos 1\nrec.sport.baseball 1\nsci.med 1\nsoc.religion.christian 3\ntalk.religion.misc 5","markups":[]},{"name":"1368","type":3,"text":"3.3. IMDB movie reviews","markups":[]},{"name":"f58c","type":1,"text":"In this part we will do binary classification of IMDB (International Movie DataBase) movie reviews. We will see how fast Vowpal Wabbit performs.","markups":[{"type":3,"start":49,"end":53,"href":"http://www.imdb.com/","title":"","rel":"","anchorType":0}]},{"name":"fa95","type":1,"text":"Using the load_files function from sklearn.datasets, we load the movie reviews here. If you want to reproduce the results, please download the archive, unzip it, and set the path to imdb_reviews (it already contains train and test subdirectories). Unpacking can take several minutes as there are 100k files. Both train and test sets hold 12.5k good and bad movie reviews. First, we split the texts and labels.","markups":[{"type":10,"start":10,"end":20},{"type":10,"start":35,"end":51},{"type":10,"start":182,"end":194},{"type":3,"start":79,"end":83,"href":"https://drive.google.com/file/d/1xq4l5c0JrcxJdyBwJWvy0u9Ad_pvkJ1l/view?usp=sharing","title":"","rel":"","anchorType":0},{"type":2,"start":216,"end":221},{"type":2,"start":226,"end":230}]},{"name":"4481","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"a1309bd6e1b73f72aa7ce78edebe4105","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"2b22","type":1,"text":"Take a look at examples of reviews and their corresponding labels.","markups":[]},{"name":"e4db","type":8,"text":"text_train[0]","markups":[]},{"name":"8122","type":8,"text":"# Output:\nb\"Zero Day leads you to think, even re-think why two boys/young men would do what they did - commit mutual suicide via slaughtering their classmates. It captures what must be beyond a bizarre mode of being for two humans who have decided to withdraw from common civility in order to define their own/mutual world via coupled destruction.\x3cbr /\x3e\x3cbr /\x3eIt is not a perfect movie but given what money/time the filmmaker and actors had - it is a remarkable product. In terms of explaining the motives and actions of the two young suicide/murderers it is better than 'Elephant' - in terms of being a film that gets under our 'rationalistic' skin it is a far, far better film than almost anything you are likely to see. \x3cbr /\x3e\x3cbr /\x3eFlawed but honest with a terrible honesty.\"","markups":[{"type":10,"start":10,"end":777}]},{"name":"ea2d","type":8,"text":"y_train[0] # good review","markups":[]},{"name":"6912","type":8,"text":"# Output:\n1","markups":[{"type":10,"start":10,"end":11}]},{"name":"57d9","type":8,"text":"text_train[1]","markups":[]},{"name":"cee2","type":8,"text":"# Output:\nb'Words can\\'t describe how bad this movie is. I can\\'t explain it by writing only. You have too see it for yourself to get at grip of how horrible a movie really can be. Not that I recommend you to do that. There are so many clich\\xc3\\xa9s, mistakes (and all other negative things you can imagine) here that will just make you cry. To start with the technical first, there are a LOT of mistakes regarding the airplane. I won\\'t list them here, but just mention the coloring of the plane. They didn\\'t even manage to show an airliner in the colors of a fictional airline, but instead used a 747 painted in the original Boeing livery. Very bad. The plot is stupid and has been done many times before, only much, much better. There are so many ridiculous moments here that i lost count of it really early. Also, I was on the bad guys\\' side all the time in the movie, because the good guys were so stupid. \"Executive Decision\" should without a doubt be you\\'re choice over this one, even the \"Turbulence\"-movies are better. In fact, every other movie in the world is better than this one.'","markups":[{"type":10,"start":10,"end":1097}]},{"name":"7377","type":8,"text":"y_train[1] # bad review","markups":[]},{"name":"27be","type":8,"text":"# Output:\n0","markups":[]},{"name":"fc6b","type":1,"text":"Now, we prepare training (movie_reviews_train.vw), validation (movie_reviews_valid.vw), and test (movie_reviews_test.vw) sets for Vowpal Wabbit. We will use 70% for training, 30% for the hold-out set.","markups":[{"type":10,"start":26,"end":48},{"type":10,"start":63,"end":85},{"type":10,"start":98,"end":119}]},{"name":"5028","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"8f6d550aae128e510de5d682eaa3c389","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"d3de","type":1,"text":"Now, launch Vowpal Wabbit with the following arguments:","markups":[]},{"name":"92d1","type":9,"text":"-d, path to training set (corresponding .vw file)","markups":[]},{"name":"9b9b","type":9,"text":"— loss_function — hinge (feel free to experiment here)","markups":[]},{"name":"1f59","type":9,"text":"-f — path to the output file (which can also be in the .vw format)","markups":[]},{"name":"58ea","type":8,"text":"!vw -d $PATH_TO_ALL_DATA/movie_reviews_train.vw --loss_function hinge -f $PATH_TO_ALL_DATA/movie_reviews_model.vw --quiet","markups":[]},{"name":"4517","type":1,"text":"Next, make the hold-out prediction with the following VW arguments:","markups":[]},{"name":"9d97","type":9,"text":"-i –path to the trained model (.vw file)","markups":[]},{"name":"9413","type":9,"text":"-t -d — path to hold-out set (.vw file)","markups":[]},{"name":"65b1","type":9,"text":"-p — path to a txt-file where the predictions will be stored","markups":[]},{"name":"3e87","type":8,"text":"!vw -i $PATH_TO_ALL_DATA/movie_reviews_model.vw -t \\ \n-d $PATH_TO_ALL_DATA/movie_reviews_valid.vw -p $PATH_TO_ALL_DATA/movie_valid_pred.txt --quiet","markups":[]},{"name":"2e4d","type":1,"text":"Read the predictions from the text file and estimate the accuracy and ROC AUC. Note that VW prints probability estimates of the +1 class. These estimates are distributed from -1 to 1, so we can convert these into binary answers, assuming that positive values belong to class 1.","markups":[]},{"name":"380d","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"cb18f181febb81e877283f67b227cc92","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"e4f6","type":8,"text":"Accuracy: 0.885\nAUC: 0.942","markups":[{"type":10,"start":0,"end":26}]},{"name":"e07e","type":1,"text":"Again, do the same for the test set.","markups":[]},{"name":"d7d6","type":8,"text":"!vw -i $PATH_TO_ALL_DATA/movie_reviews_model.vw -t \\ -d $PATH_TO_ALL_DATA/movie_reviews_test.vw \\ -p $PATH_TO_ALL_DATA/movie_test_pred.txt --quiet","markups":[]},{"name":"4df6","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"88ee1e50024bdab151b0275a7951936d","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"04cb","type":8,"text":"Accuracy: 0.88\nAUC: 0.94","markups":[{"type":10,"start":0,"end":24}]},{"name":"ceee","type":1,"text":"Let’s try to achieve a higher accuracy by incorporating bigrams.","markups":[]},{"name":"50ed","type":8,"text":"!vw -d $PATH_TO_ALL_DATA/movie_reviews_train.vw \\ --loss_function hinge --ngram 2 -f $PATH_TO_ALL_DATA/movie_reviews_model2.vw --quiet","markups":[]},{"name":"f442","type":8,"text":"!vw -i$PATH_TO_ALL_DATA/movie_reviews_model2.vw -t -d $PATH_TO_ALL_DATA/movie_reviews_valid.vw \\ -p $PATH_TO_ALL_DATA/movie_valid_pred2.txt --quiet","markups":[]},{"name":"1d09","type":8,"text":"!vw -i $PATH_TO_ALL_DATA/movie_reviews_model2.vw -t -d $PATH_TO_ALL_DATA/movie_reviews_test.vw \\ -p $PATH_TO_ALL_DATA/movie_test_pred2.txt --quiet","markups":[]},{"name":"2955","type":1,"text":"Adding bigrams really helped to improve our model!","markups":[]},{"name":"d48e","type":8,"text":"# Validation \nAccuracy: 0.894\nAUC: 0.954","markups":[{"type":10,"start":0,"end":14}]},{"name":"7f72","type":8,"text":"# Test\nAccuracy: 0.888\nAUC: 0.952","markups":[]},{"name":"68ec","type":3,"text":"3.4. Classifying gigabytes of StackOverflow questions","markups":[]},{"name":"15e4","type":1,"text":"Now, let’s see Vowpal Wabbit work on large datasets. There is a 10GB dataset of StackOverflow questions here. The original dataset is comprised of 10 million questions; each question can have several tags. The data is quite clean, so don’t call it “Big Data”, even in a pub. :)","markups":[{"type":3,"start":104,"end":108,"href":"https://drive.google.com/file/d/1ZU4J3KhJDrHVMj48fROFcTsTZKorPGlG/view?usp=sharing","title":"","rel":"noopener","anchorType":0}]},{"name":"52dd","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*Z0bVkk0iTYNOaD5I.jpg","originalWidth":638,"originalHeight":359}},{"name":"5c38","type":1,"text":"We chose only 10 tags: ‘javascript’, ‘java’, ‘python’, ‘ruby’, ‘php’, ‘c++’, ‘c#’, ‘go’, ‘scala’ and ‘swift’. Let’s solve the 10-class classification problem: we want to predict a tag corresponding to one of these 10 popular programming languages given only the text of the question. Your task in assignment is to","markups":[]},{"name":"6733","type":8,"text":"# change the path to data \nPATH_TO_STACKOVERFLOW_DATA = 'stackoverflow_10mln'","markups":[]},{"name":"4655","type":8,"text":"# Print the first 3 lines from a sample of the dataset.","markups":[]},{"name":"b1c2","type":8,"text":"!head -3 $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_train.vw","markups":[]},{"name":"d597","type":8,"text":"# Output:","markups":[]},{"name":"a3cd","type":8,"text":"1 | i ve got some code in window scroll that checks if an element is visible then triggers another function however only the first section of code is firing both bits of code work in and of themselves if i swap their order whichever is on top fires correctly my code is as follows fn isonscreen function use strict var win window viewport top win scrolltop left win scrollleft bounds this offset viewport right viewport left + win width viewport bottom viewport top + win height bounds right bounds left + this outerwidth bounds bottom bounds top + this outerheight return viewport right lt bounds left viewport left gt bounds right viewport bottom lt bounds top viewport top gt bounds bottom window scroll function use strict var load_more_results ajax load_more_results isonscreen if load_more_results true loadmoreresults var load_more_staff ajax load_more_staff isonscreen if load_more_staff true loadmorestaff what am i doing wrong can you only fire one event from window scroll i assume not \n4 | redefining some constant in ruby ex foo bar generates the warning already initialized constant i m trying to write a sort of reallyconstants module where this code should have this behaviour reallyconstants define_constant foo bar gt sets the constant reallyconstants foo to bar reallyconstants foo gt bar reallyconstants foo foobar gt this should raise an exception that is constant redefinition should generate an exception is that possible 1 | in my form panel i added a checkbox setting stateful true stateid loginpanelremeberme then before sending form i save state calling this savestate on the panel all other componenets save their state and whe i reload the page they recall the previous state but checkbox alway start in unchecked state is there any way to force save value","markups":[{"type":10,"start":0,"end":1785}]},{"name":"4a85","type":1,"text":"After selecting our 10 tags, we have a 4.7G dataset that we divide into train and test.","markups":[]},{"name":"209b","type":8,"text":"!du -hs $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_*.vw","markups":[]},{"name":"557a","type":8,"text":"# Output:","markups":[]},{"name":"b5d3","type":8,"text":"4,7G\t\nstackoverflow_10mln.vw \n1,6G\t\nstackoverflow_test.vw \n3,1G\t\nstackoverflow_train.vw","markups":[{"type":10,"start":0,"end":87}]},{"name":"d1ab","type":1,"text":"We will process the training set (3.1 GiB) with Vowpal Wabbit and the following arguments:","markups":[]},{"name":"5473","type":9,"text":"-oaa 10 — for multiclass classification with 10 classes","markups":[]},{"name":"98d0","type":9,"text":"-d — path to data","markups":[]},{"name":"90c5","type":9,"text":"-f — path to output file of the trained model","markups":[]},{"name":"8acc","type":9,"text":"-b 28 — we will use 28 bits for hashing, resulting in a $2^{28}$-sized feature space","markups":[]},{"name":"5c18","type":9,"text":"fix random seed for reproducibility","markups":[]},{"name":"fc94","type":8,"text":"%%time !vw --oaa 10 -d $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_train.vw \\ -f vw_model1_10mln.vw -b 28 --random_seed 17 --quiet","markups":[]},{"name":"4f06","type":8,"text":"# Output:","markups":[]},{"name":"a5af","type":8,"text":"CPU times: user 559 ms, sys: 171 ms, total: 730 ms Wall time: 38.5 s","markups":[{"type":10,"start":0,"end":68}]},{"name":"90b9","type":8,"text":"\n%%time !vw -t -i vw_model1_10mln.vw -d $PATH_TO_STACKOVERFLOW_DATA/stackoverflow_test.vw \\ -p vw_test_pred.csv --random_seed 17 --quiet","markups":[]},{"name":"622a","type":8,"text":"# Output:","markups":[]},{"name":"fb82","type":8,"text":"CPU times: user 322 ms, sys: 97 ms, total: 420 ms Wall time: 22.8 s","markups":[{"type":10,"start":0,"end":67}]},{"name":"169d","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"790add7ab901b88cd621324bfb284dc4","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F3973673%3Fs%3D400%26v%3D4&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"1aad","type":8,"text":"# Output:","markups":[]},{"name":"8757","type":8,"text":"0.91728604842865913","markups":[]},{"name":"5832","type":1,"text":"The model has trained itself and made predictions in less than a minute (check it, these results are reported for a MacBook Pro, mid 2015, 2.2 GHz Intel Core i7, 16GB RAM). Its accuracy is almost 92%. All of this without a Hadoop cluster! :) Impressive, isn’t it?","markups":[]},{"name":"900b","type":3,"text":"4. Assignment #8","markups":[]},{"name":"0314","type":1,"text":"A demo version is to appear soon (~ in the end of June 2018). Full version will be available in the new session of the course (starting on October, 1).","markups":[]},{"name":"c9e3","type":3,"text":"5. Useful resources","markups":[]},{"name":"9eaf","type":9,"text":"Official VW documentation on Github","markups":[{"type":3,"start":12,"end":25,"href":"https://github.com/JohnLangford/vowpal_wabbit/wiki","title":"","rel":"","anchorType":0}]},{"name":"a8ab","type":9,"text":"“Numeric Computation” Chapter of the Deep Learning book","markups":[{"type":3,"start":0,"end":29,"href":"http://www.deeplearningbook.org/contents/numerical.html","title":"","rel":"","anchorType":0},{"type":3,"start":37,"end":55,"href":"http://www.deeplearningbook.org/","title":"","rel":"","anchorType":0}]},{"name":"d82e","type":9,"text":"“Convex Optimization” by Stephen Boyd","markups":[{"type":3,"start":0,"end":37,"href":"https://www.amazon.com/Convex-Optimization-Stephen-Boyd/dp/0521833787","title":"","rel":"","anchorType":0}]},{"name":"0efd","type":9,"text":"“Command-line Tools can be 235x Faster than your Hadoop Cluster” post","markups":[{"type":3,"start":65,"end":69,"href":"https://aadrake.com/command-line-tools-can-be-235x-faster-than-your-hadoop-cluster.html","title":"","rel":"","anchorType":0}]},{"name":"d60d","type":9,"text":"Benchmarking various ML algorithms on Criteo 1TB dataset on GitHub","markups":[{"type":3,"start":60,"end":66,"href":"https://github.com/rambler-digital-solutions/criteo-1tb-benchmark","title":"","rel":"","anchorType":0}]},{"name":"86db","type":9,"text":"VW on FastML.com","markups":[{"type":3,"start":6,"end":16,"href":"http://fastml.com/blog/categories/vw/","title":"","rel":"","anchorType":0}]},{"name":"a1d7","type":1,"text":"Author: Yury Kashnitsky. Translated and edited by Serge Oreshkov, and Yuanyuan Pao.","markups":[{"type":3,"start":8,"end":23,"href":"https://yorko.github.io/","title":"","rel":"","anchorType":0},{"type":3,"start":50,"end":64,"href":"https://www.linkedin.com/in/sergeoreshkov/","title":"","rel":"","anchorType":0},{"type":3,"start":70,"end":82,"href":"https://www.linkedin.com/in/yuanyuanpao/","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":83}]}],"sections":[{"name":"7e10","startIndex":0},{"name":"9c99","startIndex":247}]},"postDisplay":{"coverless":true}},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"1*OYzZCTaTs41J4NyTTjBdHw.png","filter":"","backgroundSize":"","originalWidth":400,"originalHeight":300,"strategy":"resample","height":0,"width":0},"wordCount":4600,"imageCount":23,"readingTime":19.258490566037736,"subtitle":"This week, we’ll cover two reasons for Vowpal Wabbit’s exceptional training speed, namely, online learning and hashing trick, in both…","userPostRelation":{"userId":"a988255767e5","postId":"60f750086237","readAt":1525187646300,"readLaterAddedAt":1523803138430,"votedAt":0,"collaboratorAddedAt":0,"notesAddedAt":0,"subscribedAt":0,"lastReadSectionName":"9c99","lastReadVersionId":"467a89abf232","lastReadAt":1525187637999,"lastReadParagraphName":"a1d7","lastReadPercentage":1,"viewedAt":1525187588563,"presentedCountInResponseManagement":0,"clapCount":0,"seriesUpdateNotifsOptedInAt":0,"queuedAt":1523803138430,"seriesFirstViewedAt":0,"presentedCountInStream":10,"seriesLastViewedAt":0,"audioProgressSec":0},"publishedInCount":1,"usersBySocialRecommends":[],"recommends":75,"socialRecommends":[],"isBookmarked":true,"tags":[{"slug":"machine-learning","name":"Machine Learning","postCount":34432,"virtuals":{"isFollowing":false},"metadata":{"followerCount":23747,"postCount":34432,"coverImage":{"id":"1*Rkd4uOPkU446v_QbcY-3lQ.jpeg","originalWidth":1011,"originalHeight":628}},"type":"Tag"},{"slug":"data-science","name":"Data Science","postCount":22666,"virtuals":{"isFollowing":false},"metadata":{"followerCount":14313,"postCount":22666,"coverImage":{"id":"1*YryHJzKJy0ZYOWjlS2shMQ.jpeg","originalWidth":4102,"originalHeight":2560}},"type":"Tag"},{"slug":"education","name":"Education","postCount":172633,"virtuals":{"isFollowing":false},"metadata":{"followerCount":636062,"postCount":172633,"coverImage":{"id":"1*dVmAyTviHMkGJq46uvrLcg.jpeg"}},"type":"Tag"},{"slug":"python","name":"Python","postCount":13322,"virtuals":{"isFollowing":false},"metadata":{"followerCount":9180,"postCount":13322,"coverImage":{"id":"1*zutLn_-fZZhy7Ari-x-JWQ.jpeg","originalWidth":1800,"originalHeight":931}},"type":"Tag"},{"slug":"algorithms","name":"Algorithms","postCount":5284,"virtuals":{"isFollowing":false},"metadata":{"followerCount":2400,"postCount":5284,"coverImage":{"id":"1*zSBIHbvIoyVVhjI5MhW1XA.png","originalWidth":1138,"originalHeight":894,"focusPercentX":51,"focusPercentY":47}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":0,"links":{"entries":[{"url":"https://www.linkedin.com/in/yuanyuanpao/","alts":[],"httpStatus":999},{"url":"http://www.deeplearningbook.org/","alts":[],"httpStatus":200},{"url":"http://scikit-learn.org/stable/datasets/twenty_newsgroups.html","alts":[],"httpStatus":200},{"url":"https://yorko.github.io/","alts":[],"httpStatus":200},{"url":"https://aadrake.com/command-line-tools-can-be-235x-faster-than-your-hadoop-cluster.html","alts":[],"httpStatus":200},{"url":"http://www.deeplearningbook.org/contents/numerical.html","alts":[],"httpStatus":200},{"url":"https://www.linkedin.com/in/sergeoreshkov/","alts":[],"httpStatus":999},{"url":"https://drive.google.com/file/d/1ZU4J3KhJDrHVMj48fROFcTsTZKorPGlG/view?usp=sharing","alts":[],"httpStatus":200},{"url":"https://drive.google.com/file/d/1xq4l5c0JrcxJdyBwJWvy0u9Ad_pvkJ1l/view?usp=sharing","alts":[],"httpStatus":200},{"url":"https://github.com/JohnLangford/vowpal_wabbit/wiki","alts":[],"httpStatus":200},{"url":"https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial","alts":[],"httpStatus":200},{"url":"https://github.com/hyperopt/hyperopt","alts":[],"httpStatus":200},{"url":"http://www.imdb.com/","alts":[],"httpStatus":200},{"url":"https://github.com/JohnLangford/vowpal_wabbit/wiki/Tutorial#vws-diagnostic-information","alts":[],"httpStatus":200},{"url":"https://github.com/rambler-digital-solutions/criteo-1tb-benchmark","alts":[],"httpStatus":200},{"url":"https://archive.ics.uci.edu/ml/datasets/bank+marketing","alts":[],"httpStatus":200},{"url":"https://github.com/JohnLangford/vowpal_wabbit/wiki/Loss-functions","alts":[],"httpStatus":200},{"url":"https://github.com/JohnLangford/vowpal_wabbit","alts":[],"httpStatus":200},{"url":"http://nbviewer.jupyter.org/github/Yorko/mlcourse_open/blob/master/jupyter_english/topic08_sgd_hashing_vowpal_wabbit/topic8_sgd_hashing_vowpal_wabbit.ipynb?flush_cache=true","alts":[],"httpStatus":200},{"url":"http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data","alts":[],"httpStatus":200},{"url":"https://www.coursera.org/learn/machine-learning","alts":[],"httpStatus":200},{"url":"https://www.amazon.com/Convex-Optimization-Stephen-Boyd/dp/0521833787","alts":[],"httpStatus":200},{"url":"http://fastml.com/blog/categories/vw/","alts":[],"httpStatus":200},{"url":"https://www.kaggle.com/kashnitsky/vowpal-wabbit-tutorial-blazingly-fast-learning","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1525726053700},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":1761,"sectionCount":2,"readingList":1},"coverless":true,"slug":"open-machine-learning-course-topic-8-vowpal-wabbit-fast-learning-with-gigabytes-of-data","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"https://gist.github.com/Yorko/bf41c3be2d0b9ef55dbbfb6b58cf942b","importedPublishedAt":0,"visibility":0,"uniqueSlug":"open-machine-learning-course-topic-8-vowpal-wabbit-fast-learning-with-gigabytes-of-data-60f750086237","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*OYzZCTaTs41J4NyTTjBdHw.png","originalWidth":400,"originalHeight":300,"isFeatured":true}},{"name":"beb0","type":3,"text":"Open Machine Learning Course. Topic 8. Vowpal Wabbit: Fast Learning with Gigabytes of Data","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-8-vowpal-wabbit-fast-learning-with-gigabytes-of-data-60f750086237","approvedHomeCollectionId":"b76595fb6cfc","approvedHomeCollection":{"id":"b76595fb6cfc","name":"Open Machine Learning Course","slug":"open-machine-learning-course","tags":["MACHINE LEARNING","DATA SCIENCE","DATA ANALYSIS","EDUCATION","KAGGLE"],"creatorId":"5572ec600139","description":"A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.","shortDescription":"A series of articles on basics of Machine Learning.","image":{"imageId":"1*b5pfoCQz20rjh79OPSQWQg.jpeg","filter":"","backgroundSize":"","originalWidth":271,"originalHeight":271,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":1394,"activeAt":1523869737051},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":true,"isNewsletterSubscribed":true,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*MxsqShnPs3RXMScwl5HhsQ.jpeg","filter":"","backgroundSize":"","originalWidth":1479,"originalHeight":822,"strategy":"resample","height":0,"width":0},"twitterUsername":"odsai_en","facebookPageName":"DataChallenges","publicEmail":"yury.kashnitsky@gmail.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":6,"number":10,"postIds":[]}}],"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF02B875","point":0},{"color":"#FF00AB6B","point":0.1},{"color":"#FF1C9963","point":0.2},{"color":"#FF092E20","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFE9FDF0","point":0.1},{"color":"#FFE2FAEE","point":0.2},{"color":"#FFADFFCF","point":0.6},{"color":"#FF7DFFB3","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"},"newsletterId":"","webCanonicalUrl":"https://gist.github.com/Yorko/bf41c3be2d0b9ef55dbbfb6b58cf942b","mediumUrl":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-8-vowpal-wabbit-fast-learning-with-gigabytes-of-data-60f750086237","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"featureLockRequestMinimumGuaranteeAmount":0,"isElevate":false,"mongerRequestType":1,"type":"Post"},"mentionedUsers":[],"collaborators":[],"membershipPlans":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"5572ec600139":{"userId":"5572ec600139","name":"Yury Kashnitskiy","username":"yurykashnitskiy","createdAt":1490200873092,"lastPostCreatedAt":1525724892687,"imageId":"0*JtleyoApNKIjJU5F.","backgroundImageId":"","bio":"Data Scientist at Mail.Ru Group","twitterScreenName":"","socialStats":{"userId":"5572ec600139","usersFollowedCount":33,"usersFollowedByCount":650,"type":"SocialStats"},"social":{"userId":"a988255767e5","targetUserId":"5572ec600139","type":"Social"},"facebookAccountId":"1414603208563160","allowNotes":1,"isNsfw":false,"type":"User"}},"Collection":{"b76595fb6cfc":{"id":"b76595fb6cfc","name":"Open Machine Learning Course","slug":"open-machine-learning-course","tags":["MACHINE LEARNING","DATA SCIENCE","DATA ANALYSIS","EDUCATION","KAGGLE"],"creatorId":"5572ec600139","description":"A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.","shortDescription":"A series of articles on basics of Machine Learning.","image":{"imageId":"1*b5pfoCQz20rjh79OPSQWQg.jpeg","filter":"","backgroundSize":"","originalWidth":271,"originalHeight":271,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":1394,"activeAt":1523869737051},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":true,"isNewsletterSubscribed":true,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*MxsqShnPs3RXMScwl5HhsQ.jpeg","filter":"","backgroundSize":"","originalWidth":1479,"originalHeight":822,"strategy":"resample","height":0,"width":0},"twitterUsername":"odsai_en","facebookPageName":"DataChallenges","publicEmail":"yury.kashnitsky@gmail.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":6,"number":10,"postIds":[]}}],"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF02B875","point":0},{"color":"#FF00AB6B","point":0.1},{"color":"#FF1C9963","point":0.2},{"color":"#FF092E20","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFE9FDF0","point":0.1},{"color":"#FFE2FAEE","point":0.2},{"color":"#FFADFFCF","point":0.6},{"color":"#FF7DFFB3","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"}},"Social":{"5572ec600139":{"userId":"a988255767e5","targetUserId":"5572ec600139","type":"Social"}},"SocialStats":{"5572ec600139":{"userId":"5572ec600139","usersFollowedCount":33,"usersFollowedByCount":650,"type":"SocialStats"}}}})
// ]]></script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/main-common-async.bundle.S7356n6LBseGGEx0Avxzng.js"></script><script charset="UTF-8" src="./Open Machine Learning Course. Topic 8. Vowpal Wabbit_ Fast Learning with Gigabytes of Data_files/main-notes.bundle.CzX6ttriZ_q3KYPaiNXuzw.js"></script></body></html>