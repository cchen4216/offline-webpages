<!DOCTYPE html>
<!-- saved from url=(0139)https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection</title><link rel="canonical" href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a"><meta name="title" content="Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection"><meta name="referrer" content="always"><meta name="description" content="In this course, we have already seen several key machine learning algorithms. However, before moving on to the more fancy ones, we’d like to take a small detour and talk about data preparation. The…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection"><meta property="og:url" content="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/0*NZRVMpxF8oSBwumh."><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="In this course, we have already seen several key machine learning algorithms. However, before moving on to the more fancy ones, we’d like…"><meta name="twitter:description" content="In this course, we have already seen several key machine learning algorithms. However, before moving on to the more fancy ones, we’d like…"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/0*NZRVMpxF8oSBwumh."><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@arseny_info"><meta property="author" content="Arseny Kravchenko"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Arseny Kravchenko"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2018-03-12T11:01:01.240Z"><meta name="twitter:creator" content="@arseny_info"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="22 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/8b94f870706a"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/8b94f870706a"><meta property="al:android:url" content="medium://p/8b94f870706a"><meta property="al:web:url" content="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/8b94f870706a"><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":454,"height":491,"url":"https://cdn-images-1.medium.com/max/908/0*NZRVMpxF8oSBwumh."},"datePublished":"2018-03-12T11:01:01.240Z","dateModified":"2018-05-16T23:19:08.464Z","headline":"Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection","name":"Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection","keywords":["Machine Learning","Data Science","Feature Engineering","Feature Extraction","Feature Selection"],"author":{"@type":"Person","name":"Arseny Kravchenko","url":"https://medium.com/@arseny_info"},"creator":["Arseny Kravchenko"],"publisher":{"@type":"Organization","name":"Open Machine Learning Course","url":"https://medium.com/open-machine-learning-course","logo":{"@type":"ImageObject","width":107,"height":60,"url":"https://cdn-images-1.medium.com/max/214/1*MxsqShnPs3RXMScwl5HhsQ.jpeg"}},"mainEntityOfPage":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a"}</script><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-12" href="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/m2.css"><link rel="stylesheet" href="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/main-branding-base.7yvz-twGm_-KNykk_dGs8Q.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async="" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="apple-touch-icon" sizes="60x60" href="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_b5pfoCQz20rjh79OPSQWQg.jpeg"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome os-mac is-withMagicUnderlinesv-glyph v-glyph--m2 is-js is-withMagicUnderlines" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1526797314021" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1680" height="932"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><div class="metabar u-clearfix js-metabar is-hiddenWhenMinimized metabar--affixed is-maximized"><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1000 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingLeft20 u-paddingRight20"><div class="metabar-block u-flex1  u-flexCenter"><div class="js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-textColorDarker"><svg class="svgIcon-use" width="45" height="45" viewBox="0 0 45 45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56"><div class="u-alignBlock"><span class="u-inlineBlock u-height28 u-xs-height24 u-verticalAlignTop u-marginRight20 u-marginLeft15 u-borderRightLighter"></span></div></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56 u-marginRight18"><div class="u-alignBlock"><a class="js-collectionLogoOrName" href="https://medium.com/open-machine-learning-course?source=logo-a988255767e5---b76595fb6cfc"><img height="36" width="65" class="u-paddingTop5" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_MxsqShnPs3RXMScwl5HhsQ.jpeg" alt="Open Machine Learning Course"></a></div></div><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56 u-xs-hide"><div class="u-alignBlock"><div class="buttonSet"><button class="button button--primary button--filled button--smallest button--withChrome u-accentColor--buttonNormal button--withIcon button--withSvgIcon button--withIconRight button--withIconAndLabel js-relationshipButton is-smallPill" data-action="show-more-collection-actions" data-action-value="affixMenu" data-collection-id="b76595fb6cfc"><span class="button-label  js-buttonLabel">Following</span><span class="svgIcon svgIcon--arrowDown svgIcon--11px u-relative u-top1 u-paddingLeft6"><svg class="svgIcon-use" width="11" height="11" viewBox="0 0 11 11"><path d="M0 2.77l5.095 5.648.427.472.427-.472L10.99 2.83l-.85-.77-4.618 5.142L.85 2z" fill-rule="evenodd"></path></svg></span></button><a class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon" href="https://twitter.com/odsai_en" title="Visit “Open Machine Learning Course” on Twitter" aria-label="Visit “Open Machine Learning Course” on Twitter" rel="me" target="_blank"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></span></a><a class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-paddingLeft0" href="https://facebook.com/DataChallenges" title="Visit “Open Machine Learning Course” on Facebook" aria-label="Visit “Open Machine Learning Course” on Facebook" rel="me" target="_blank"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21 12.646C21 7.65 16.97 3.6 12 3.6s-9 4.05-9 9.046a9.026 9.026 0 0 0 7.59 8.924v-6.376H8.395V12.64h2.193v-1.88c0-2.186 1.328-3.375 3.267-3.375.93 0 1.728.07 1.96.1V9.77H14.47c-1.055 0-1.26.503-1.26 1.242v1.63h2.517l-.33 2.554H13.21V21.6c4.398-.597 7.79-4.373 7.79-8.954"></path></svg></span></span></a></div></div></div></div><div class="metabar-block u-flex0 u-flexCenter"><div class="u-alignMiddle u-inlineBlock u-verticalAlignTop u-height65 u-xs-height56"><div class="u-alignBlock"><div class="buttonSet buttonSet--wide u-lineHeightInherit"><label class="button button--chromeless inputGroup u-sm-hide metabar-predictiveSearch u-baseColor--buttonNormal u-baseColor--placeholderNormal" title="Search"><span class="svgIcon svgIcon--search svgIcon--25px u-top0 u-baseColor--iconLight"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span><input class="js-predictiveSearchInput textInput textInput--rounded textInput--darkText u-baseColor--textNormal textInput--transparent" type="search" placeholder="Search" required="true" data-collection-id="b76595fb6cfc"></label><a class="button button--small button--chromeless u-sm-show is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-xs-top2" href="https://medium.com/open-machine-learning-course/search" title="Search" aria-label="Search"><span class="button-defaultState"><span class="svgIcon svgIcon--search svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span></span></a><button class="button button--primary button--filled button--small button--circle button--chromeless is-inSiteNavBar u-accentColor--buttonNormal button--withIcon button--withSvgIcon button--activity js-notificationsButton u-marginRight16 u-xs-marginRight5 u-lineHeight0 is-active is-counter" title="Notifications" aria-label="Notifications" data-action="open-notifications"><span class="button-defaultState"><span class="svgIcon svgIcon--bell svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-293 409 25 25"><path d="M-273.327 423.67l-1.673-1.52v-3.646a5.5 5.5 0 0 0-6.04-5.474c-2.86.273-4.96 2.838-4.96 5.71v3.41l-1.68 1.553c-.204.19-.32.456-.32.734V427a1 1 0 0 0 1 1h3.49a3.079 3.079 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59c0-.28-.12-.55-.327-.74zm-7.173 5.63c-.842 0-1.55-.546-1.812-1.3h3.624a1.92 1.92 0 0 1-1.812 1.3zm6.35-2.45h-12.7v-2.347l1.63-1.51c.236-.216.37-.522.37-.843v-3.41c0-2.35 1.72-4.356 3.92-4.565a4.353 4.353 0 0 1 4.78 4.33v3.645c0 .324.137.633.376.85l1.624 1.477v2.373z"></path></svg></span></span><span class="button-activeState"><span class="button-text">3</span><span class="u-textScreenReader">New notifications: 3</span></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-marginLeft4 is-inSiteNavBar js-userActions" aria-haspopup="true" data-action="open-userActions"><div class="avatar"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_P-t7h_lDOjJiWVxI" class="avatar-image avatar-image--icon" alt="陈辰"></div></button></div></div></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors" lang="en"><header class="container u-maxWidth740"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="uiScale uiScale-ui--regular uiScale-caption--regular postMetaLockup postMetaLockup--authorWithBio u-flexCenter js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@arseny_info?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="e64a1ed25336" data-action-type="hover" data-user-id="e64a1ed25336" dir="auto"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_uf2wBS0ahK7CUnFXEFM63g.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Arseny Kravchenko"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-lineHeightTightest"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker" href="https://medium.com/@arseny_info?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="e64a1ed25336" data-action-type="hover" data-user-id="e64a1ed25336" dir="auto">Arseny Kravchenko</a><span class="followState js-followState" data-user-id="e64a1ed25336"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide" data-action="toggle-block-user" data-action-value="e64a1ed25336" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-xs-hide" data-action="toggle-subscribe-user" data-action-value="e64a1ed25336" data-action-source="post_header_lockup-e64a1ed25336-------------------------follow_byline" data-subscribe-source="post_header_lockup" data-follow-context-entity-id="8b94f870706a"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption ui-xs-clamp2 postMetaInline">Sceptical data cruncher.</div><div class="ui-caption postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2018-03-12T11:01:01.240Z">Mar 12</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="22 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="8b94f870706a" data-source="post_page" data-collection-id="b76595fb6cfc" data-tracking-context="postPage" data-scroll="native"><section name="a518" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="0152" id="0152" class="graf graf--h3 graf--leading graf--title">Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection</h1><figure name="23d8" id="23d8" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 454px; max-height: 491px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 108.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*NZRVMpxF8oSBwumh." data-width="454" data-height="491" data-is-featured="true" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_NZRVMpxF8oSBwumh" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="70" height="75"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*NZRVMpxF8oSBwumh." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_NZRVMpxF8oSBwumh(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*NZRVMpxF8oSBwumh."></noscript></div></div></figure><p name="a9db" id="a9db" class="graf graf--p graf-after--figure">In this course, we have already seen several key machine learning algorithms. However, before moving on to the more fancy ones, we’d like to take a small detour and talk about data preparation. The well-known concept of “garbage in — garbage out” applies 100% to any task in machine learning. Any experienced professional can recall numerous times when a simple model trained on high-quality data was proven to be better than a complicated multi-model ensemble built on data that wasn’t clean.</p><p name="de9e" id="de9e" class="graf graf--p graf-after--p">To start, I wanted to review three similar but different tasks:</p><ul class="postList"><li name="a8e8" id="a8e8" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">feature extraction</strong> and <strong class="markup--strong markup--li-strong">feature engineering</strong>: transformation of raw data into features suitable for modeling;</li><li name="7a33" id="7a33" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">feature transformation</strong>: transformation of data to improve the accuracy of the algorithm;</li><li name="6dc8" id="6dc8" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">feature selection</strong>: removing unnecessary features.</li></ul><p name="cd97" id="cd97" class="graf graf--p graf-after--li">This article will contain almost no math, but there will be a fair amount of code. (<a href="https://github.com/Yorko/mlcourse_open/blob/master/jupyter_english/topic06_features/topic6_feature_engineering_feature_selection.ipynb" data-href="https://github.com/Yorko/mlcourse_open/blob/master/jupyter_english/topic06_features/topic6_feature_engineering_feature_selection.ipynb" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Jupyter</a> version). Some examples will use the dataset from Renthop company, which is used in the <a href="https://www.kaggle.com/c/two-sigma-connect-rental-listing-inquiries" data-href="https://www.kaggle.com/c/two-sigma-connect-rental-listing-inquiries" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">Two Sigma Connect: Rental Listing Inquiries Kaggle competition</a>. In this task, you need to predict the popularity of a new rental listing, i.e. classify the listing into three classes: <code class="markup--code markup--p-code">['low', 'medium'&nbsp;, 'high']</code>. To evaluate the solutions, we will use the log loss metric (the smaller, the better). Those who do not have a Kaggle account, will have to register; you will also need to accept the rules of the competition in order to download the data.</p><pre name="bd66" id="bd66" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">json</strong><br><strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">pandas</strong> <strong class="markup--strong markup--pre-strong">as</strong> <strong class="markup--strong markup--pre-strong">pd</strong><br><br><em class="markup--em markup--pre-em"># Let's load the dataset from Renthop right away</em><br><strong class="markup--strong markup--pre-strong">with</strong> open('train.json', 'r') <strong class="markup--strong markup--pre-strong">as</strong> raw_data:<br>    data = json.load(raw_data)<br>    df = pd.DataFrame(data)</pre><figure name="6e9a" id="6e9a" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 593px; max-height: 343px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 57.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*9hnjnSWUMMwg7AkfceIeTA.png" data-width="593" data-height="343" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_9hnjnSWUMMwg7AkfceIeTA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="42"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*9hnjnSWUMMwg7AkfceIeTA.png" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_9hnjnSWUMMwg7AkfceIeTA(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*9hnjnSWUMMwg7AkfceIeTA.png"></noscript></div></div></figure><h3 name="b52b" id="b52b" class="graf graf--h3 graf-after--figure">Article outline</h3><p name="9068" id="9068" class="graf graf--p graf-after--h3">1. Feature Extraction<br>1.1. Texts<br>1.2. Images<br>1.3. Geospatial data<br>1.4. Date and time<br>1.5. Time series, web, etc.</p><p name="0f7f" id="0f7f" class="graf graf--p graf-after--p">2. Feature transformations<br>2.1. Normalization and changing distribution<br>2.2. Interactions<br>2.3. Filling in the missing values</p><p name="ae6d" id="ae6d" class="graf graf--p graf-after--p">3. Feature selection<br>3.1. Statistical approaches<br>3.2. Selection by modeling<br>3.3. Grid search</p><h3 name="68c4" id="68c4" class="graf graf--h3 graf-after--p">1. Feature Extraction</h3><p name="931e" id="931e" class="graf graf--p graf-after--h3">In practice, data rarely comes in the form of ready-to-use matrices. That's why every task begins with feature extraction. Sometimes, it can be enough to read the csv file and convert it into <code class="markup--code markup--p-code">numpy.array</code>, but this is a rare exception. Let's look at some of the popular types of data from which features can be extracted.</p><h3 name="5195" id="5195" class="graf graf--h3 graf-after--p">1.1. Texts</h3><p name="3425" id="3425" class="graf graf--p graf-after--h3">Text is a type of data that can come in different formats; there are so many text processing methods that cannot fit in a single article. Nevertheless, we will review the most popular ones.</p><p name="7e48" id="7e48" class="graf graf--p graf-after--p">Before working with text, one must tokenize it. Tokenization implies splitting the text into units (hence, tokens). Most simply, tokens are just the words. But splitting by word can lose some of the meaning -- "Santa Barbara" is one token, not two, but "rock'n'roll" should not be split into two tokens. There are ready-to-use tokenizers that take into account peculiarities of the language, but they make mistakes as well, especially when you work with specific sources of text (newspapers, slang, misspellings, typos).</p><p name="6d48" id="6d48" class="graf graf--p graf-after--p">After tokenization, you will normalize the data. For text, this is about stemming and/or lemmatization; these are similar processes used to process different forms of a word. One can read about the difference between them <a href="http://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html" data-href="http://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a>.</p><p name="f6c3" id="f6c3" class="graf graf--p graf-after--p">So, now that we have turned the document into a sequence of words, we can represent it with vectors. The easiest approach is called Bag of Words: we create a vector with the length of the dictionary, compute the number of occurrences of each word in the text, and place that number of occurrences in the appropriate position in the vector. The process described looks simpler in code:</p><pre name="f44c" id="f44c" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">functools</strong> <strong class="markup--strong markup--pre-strong">import</strong> reduce <br><strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">numpy</strong> <strong class="markup--strong markup--pre-strong">as</strong> <strong class="markup--strong markup--pre-strong">np</strong><br><br>texts = [['i', 'have', 'a', 'cat'], <br>        ['he', 'have', 'a', 'dog'], <br>        ['he', 'and', 'i', 'have', 'a', 'cat', 'and', 'a', 'dog']]<br><br>dictionary = list(enumerate(set(list(reduce(<strong class="markup--strong markup--pre-strong">lambda</strong> x, y: x + y, texts)))))<br><br><strong class="markup--strong markup--pre-strong">def</strong> vectorize(text): <br>    vector = np.zeros(len(dictionary)) <br>    <strong class="markup--strong markup--pre-strong">for</strong> i, word <strong class="markup--strong markup--pre-strong">in</strong> dictionary: <br>        num = 0 <br>        <strong class="markup--strong markup--pre-strong">for</strong> w <strong class="markup--strong markup--pre-strong">in</strong> text: <br>            <strong class="markup--strong markup--pre-strong">if</strong> w == word: <br>                num += 1 <br>        <strong class="markup--strong markup--pre-strong">if</strong> num: <br>            vector[i] = num <br>    <strong class="markup--strong markup--pre-strong">return</strong> vector<br><br><strong class="markup--strong markup--pre-strong">for</strong> t <strong class="markup--strong markup--pre-strong">in</strong> texts: <br>    <strong class="markup--strong markup--pre-strong">print</strong>(vectorize(t))</pre><p name="f022" id="f022" class="graf graf--p graf-after--pre">Expected result:</p><pre name="0ac8" id="0ac8" class="graf graf--pre graf-after--p">[0. 1. 0. 1. 1. 0. 1.]<br>[0. 1. 1. 0. 1. 1. 0.]<br>[2. 1. 1. 1. 2. 1. 1.]</pre><p name="aa58" id="aa58" class="graf graf--p graf-after--pre">Here is an illustration of the process:</p><figure name="13d6" id="13d6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 401px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 57.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*XAUdLzs_GQ4YWjA3dk5Geg.png" data-width="779" data-height="446" data-action="zoom" data-action-value="1*XAUdLzs_GQ4YWjA3dk5Geg.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_XAUdLzs_GQ4YWjA3dk5Geg.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="42"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*XAUdLzs_GQ4YWjA3dk5Geg.png" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_XAUdLzs_GQ4YWjA3dk5Geg(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*XAUdLzs_GQ4YWjA3dk5Geg.png"></noscript></div></div></figure><p name="202b" id="202b" class="graf graf--p graf-after--figure">This is an extremely naive implementation. In practice, you need to consider stop words, the maximum length of the dictionary, more efficient data structures (usually text data is converted to a sparse vector), etc.</p><p name="e741" id="e741" class="graf graf--p graf-after--p">When using algorithms like Bag of Words, we lose the order of the words in the text, which means that the texts "i have no cows" and "no, i have cows" will appear identical after vectorization when, in fact, they have the opposite meaning. To avoid this problem, we can revisit our tokenization step and use N-grams (the <em class="markup--em markup--p-em">sequence</em> of N consecutive tokens) instead.</p><pre name="08e8" id="08e8" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.feature_extraction.text</strong> <strong class="markup--strong markup--pre-strong">import</strong> CountVectorizer<br><br>In : vect = CountVectorizer(ngram_range=(1,1))<br><br>In : vect.fit_transform(['no i have cows', 'i have no cows']).toarray() <br>Out: <br>array([[1, 1, 1],<br>      [1, 1, 1]], dtype=int64)<br><br>In : vect.vocabulary_ <br>Out: {'cows': 0, 'have': 1, 'no': 2}<br><br>In : vect = CountVectorizer(ngram_range=(1,2))<br><br>In : vect.fit_transform(['no i have cows', 'i have no cows']).toarray() <br>Out: <br>array([[1, 1, 1, 0, 1, 0, 1], <br>      [1, 1, 0, 1, 1, 1, 0]], dtype=int64)<br><br>In : vect.vocabulary_ <br>Out: {'cows': 0, <br>      'have': 1,<br>      'have cows': 2,<br>      'have no': 3,<br>      'no': 4,<br>      'no cows': 5,<br>      'no have': 6}</pre><p name="8c03" id="8c03" class="graf graf--p graf-after--pre">Also note that one does not have to use only words. In some cases, it is possible to generate N-grams of characters. This approach would be able to account for similarity of related words or handle typos.</p><pre name="1aa8" id="1aa8" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">scipy.spatial.distance</strong> <strong class="markup--strong markup--pre-strong">import</strong> euclidean<br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.feature_extraction.text</strong> <strong class="markup--strong markup--pre-strong">import</strong> CountVectorizer<br><br>vect = CountVectorizer(ngram_range=(3,3), analyzer='char_wb')<br><br>n1, n2, n3, n4 = vect.fit_transform(['andersen', 'petersen', 'petrov', 'smith']).toarray()<br><br>euclidean(n1, n2), euclidean(n2, n3), euclidean(n3, n4)<br># (2.8284271247461903, 3.1622776601683795, 3.3166247903554)</pre><p name="6860" id="6860" class="graf graf--p graf-after--pre">Adding onto the Bag of Words idea: words that are rarely found in the corpus (in all the documents of this dataset) but are present in this particular document might be more important. Then it makes sense to increase the weight of more domain-specific words to separate them out from common words. This approach is called TF-IDF (term frequency-inverse document frequency), which cannot be written in a few lines, so you should look into the details in references such as <a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf" data-href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this wiki</a>. The default option is as follows:</p><figure name="8221" id="8221" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 362px; max-height: 179px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 49.4%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*0GBn_uP9KZNHLkvUXu4hgA.png" data-width="362" data-height="179" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_0GBn_uP9KZNHLkvUXu4hgA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="36"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*0GBn_uP9KZNHLkvUXu4hgA.png" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_0GBn_uP9KZNHLkvUXu4hgA(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*0GBn_uP9KZNHLkvUXu4hgA.png"></noscript></div></div></figure><p name="f35a" id="f35a" class="graf graf--p graf-after--figure">Analogs of Bag of Words can be found outside of text problems e.g. bag of sites in the <a href="https://inclass.kaggle.com/c/catch-me-if-you-can-intruder-detection-through-webpage-session-tracking" data-href="https://inclass.kaggle.com/c/catch-me-if-you-can-intruder-detection-through-webpage-session-tracking" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Catch Me If You Can competition</a>, <a href="https://www.kaggle.com/xiaoml/talkingdata-mobile-user-demographics/bag-of-app-id-python-2-27392" data-href="https://www.kaggle.com/xiaoml/talkingdata-mobile-user-demographics/bag-of-app-id-python-2-27392" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">bag of apps</a>, <a href="http://www.interdigital.com/download/58540a46e3b9659c9f000372" data-href="http://www.interdigital.com/download/58540a46e3b9659c9f000372" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">bag of events</a>, etc.</p><figure name="9f86" id="9f86" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 401px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 57.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*XAUdLzs_GQ4YWjA3dk5Geg.png" data-width="779" data-height="446" data-action="zoom" data-action-value="1*XAUdLzs_GQ4YWjA3dk5Geg.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_XAUdLzs_GQ4YWjA3dk5Geg.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="42"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*XAUdLzs_GQ4YWjA3dk5Geg.png" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_XAUdLzs_GQ4YWjA3dk5Geg(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*XAUdLzs_GQ4YWjA3dk5Geg.png"></noscript></div></div></figure><p name="eff9" id="eff9" class="graf graf--p graf-after--figure">Using these algorithms, it is possible to obtain a working solution for a simple problem, which can serve as a baseline. However, for those who do not like the classics, there are new approaches. The most popular method in the new wave is Word2Vec, but there are a few alternatives as well (GloVe, Fasttext, etc.).</p><p name="4be9" id="4be9" class="graf graf--p graf-after--p">Word2Vec is a special case of the word embedding algorithms. Using Word2Vec and similar models, we can not only vectorize words in a high-dimensional space (typically a few hundred dimensions) but also compare their semantic similarity. This is a classic example of operations that can be performed on vectorized concepts: king - man + woman = queen.</p><figure name="3ed6" id="3ed6" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 336px; max-height: 336px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 100%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*K5X4N-MJKt8FGFtrTHwidg.gif" data-width="336" data-height="336" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_K5X4N-MJKt8FGFtrTHwidg.gif" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*K5X4N-MJKt8FGFtrTHwidg.gif" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_K5X4N-MJKt8FGFtrTHwidg(1).gif"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*K5X4N-MJKt8FGFtrTHwidg.gif"></noscript></div></div></figure><p name="78fc" id="78fc" class="graf graf--p graf-after--figure">It is worth noting that this model does not comprehend the meaning of the words but simply tries to position the vectors such that words used in common context are close to each other. If this is not taken into account, a lot of fun examples will come up.</p><p name="8369" id="8369" class="graf graf--p graf-after--p">Such models need to be trained on very large datasets in order for the vector coordinates to capture the semantics. A pretrained model for your own tasks can be downloaded <a href="https://github.com/3Top/word2vec-api#where-to-get-a-pretrained-models" data-href="https://github.com/3Top/word2vec-api#where-to-get-a-pretrained-models" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">here</a>.</p><p name="96cd" id="96cd" class="graf graf--p graf-after--p">Similar methods are applied in other areas such as bioinformatics. An unexpected application is <a href="https://jaan.io/food2vec-augmented-cooking-machine-intelligence/" data-href="https://jaan.io/food2vec-augmented-cooking-machine-intelligence/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">food2vec</a>. You can probably think of a few other fresh ideas; the concept is universal enough.</p><h3 name="295c" id="295c" class="graf graf--h3 graf-after--p">1.2. Images</h3><p name="e2c8" id="e2c8" class="graf graf--p graf-after--h3">Working with images is easier and harder at the same time. It is easier because it is possible to just use one of the popular pretrained networks without much thinking but harder because, if you need to dig into the details, you may end up going really deep. Let's start from the beginning.</p><p name="35f9" id="35f9" class="graf graf--p graf-after--p">In a time when GPUs were weaker and the "renaissance of neural networks" had not happened yet, feature generation from images was its own complex field. One had to work at a low level, determining corners, borders of regions, color distributions statistics, and so on. Experienced specialists in computer vision could draw a lot of parallels between older approaches and neural networks; in particular, convolutional layers in today's networks are similar to <a href="https://habrahabr.ru/post/208092/" data-href="https://habrahabr.ru/post/208092/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Haar cascades</a>. If you are interested in reading more, here are a couple of links to some interesting libraries: <code class="markup--code markup--p-code"><a href="http://scikit-image.org/docs/stable/api/skimage.feature.html" data-href="http://scikit-image.org/docs/stable/api/skimage.feature.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">skimage</a></code> and <code class="markup--code markup--p-code"><a href="http://simplecv.readthedocs.io/en/latest/SimpleCV.Features.html" data-href="http://simplecv.readthedocs.io/en/latest/SimpleCV.Features.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">SimpleCV</a></code>.</p><p name="d1de" id="d1de" class="graf graf--p graf-after--p">Often for problems associated with images, a convolutional neural network is used. You do not have to come up with the architecture and train a network from scratch. Instead, download a pretrained state-of-the-art network with the weights from public sources. Data scientists often do so-called fine-tuning to adapt these networks to their needs by "detaching" the last fully connected layers of the network, adding new layers chosen for a specific task, and then training the network on new data. If your task is to just vectorize the image (for example, to use some non-network classifier), you only need to remove the last layers and use the output from the previous layers:</p><pre name="ecff" id="ecff" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">keras.applications.resnet50</strong> <strong class="markup--strong markup--pre-strong">import</strong> ResNet50, preprocess_input<br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">keras.preprocessing</strong> <strong class="markup--strong markup--pre-strong">import</strong> image <br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">scipy.misc</strong> <strong class="markup--strong markup--pre-strong">import</strong> face <br><strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">numpy</strong> <strong class="markup--strong markup--pre-strong">as</strong> <strong class="markup--strong markup--pre-strong">np</strong><br><br>resnet_settings = {'include_top': False, 'weights': 'imagenet'}<br>resnet = ResNet50(**resnet_settings)<br><br>img = image.array_to_img(face())<br><br><em class="markup--em markup--pre-em"># What a cute raccoon!</em><br><br>img = img.resize((224, 224))<br><br><em class="markup--em markup--pre-em"># In real life, you may need to pay more attention to resizing</em><br><br>x = image.img_to_array(img) <br>x = np.expand_dims(x, axis=0)<br>x = preprocess_input(x)<br><br><em class="markup--em markup--pre-em"># Need an extra dimension because model is designed to work with an array of images - i.e. tensor shaped (batch_size, width, height, n_channels)</em><br><br>features = resnet.predict(x)</pre><figure name="2a28" id="2a28" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 331px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 47.199999999999996%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*Iw_cKFwLkTVO2SPrOZU2rQ.png" data-width="1920" data-height="907" data-action="zoom" data-action-value="1*Iw_cKFwLkTVO2SPrOZU2rQ.png" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_Iw_cKFwLkTVO2SPrOZU2rQ.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="35"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*Iw_cKFwLkTVO2SPrOZU2rQ.png" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_Iw_cKFwLkTVO2SPrOZU2rQ(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*Iw_cKFwLkTVO2SPrOZU2rQ.png"></noscript></div></div></figure><p name="2084" id="2084" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Here's a classifier trained on one dataset and adapted for a different one by "detaching" the last layer and adding a new one instead.</em></p><p name="3a54" id="3a54" class="graf graf--p graf-after--p">Nevertheless, we should not focus too much on neural network techniques. Features generated by hand are still very useful: for example, for predicting the popularity of a rental listing, we can assume that bright apartments attract more attention and create a feature such as "the average value of the pixel". You can find some inspiring examples in the documentation of <a href="http://pillow.readthedocs.io/en/3.1.x/reference/ImageStat.html" data-href="http://pillow.readthedocs.io/en/3.1.x/reference/ImageStat.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">relevant libraries</a>.</p><p name="c4b8" id="c4b8" class="graf graf--p graf-after--p">If there is text on the image, you can read it without unraveling a complicated neural network. For example, check out <code class="markup--code markup--p-code"><a href="https://github.com/madmaze/pytesseract" data-href="https://github.com/madmaze/pytesseract" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">pytesseract</a></code>.</p><pre name="b77c" id="b77c" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">pytesseract</strong><br><br>In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">PIL</strong> <strong class="markup--strong markup--pre-strong">import</strong> Image<br><br>In : <strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">requests</strong><br><br>In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">io</strong> <strong class="markup--strong markup--pre-strong">import</strong> BytesIO<br><br>In : img = 'http://ohscurrent.org/wp-content/uploads/2015/09/domus-01-google.jpg'<br><br><em class="markup--em markup--pre-em">##### Just a random picture from search</em><br><br>In : img = requests.get(img) <br>...: img = Image.open(BytesIO(img.content)) <br>...: text = pytesseract.image_to_string(img) <br>...:<br><br>In : text <br>Out: 'Google'</pre><p name="d6f2" id="d6f2" class="graf graf--p graf-after--pre">One must understand that <code class="markup--code markup--p-code">pytesseract</code> is not a solution for everything.</p><pre name="06a7" id="06a7" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">##### This time we take a picture from Renthop</em><br><br>In : img = requests.get('https://photos.renthop.com/2/8393298_6acaf11f030217d05f3a5604b9a2f70f.jpg') <br>...: img = Image.open(BytesIO(img.content)) <br>...: pytesseract.image_to_string(img) <br>...:<br><br>Out: 'Cunveztible to 4}»'</pre><p name="e24d" id="e24d" class="graf graf--p graf-after--pre">Another case where neural networks cannot help is extracting features from meta-information. For images, EXIF stores many useful meta-information: manufacturer and camera model, resolution, use of the flash, geographic coordinates of shooting, software used to process image and more.</p><h3 name="cd89" id="cd89" class="graf graf--h3 graf-after--p">1.3. Geospatial data</h3><p name="d9a4" id="d9a4" class="graf graf--p graf-after--h3">Geographic data is not so often found in problems, but it is still useful to master the basic techniques for working with it, especially since there are quite a number of ready-to-use solutions in this field.</p><p name="708d" id="708d" class="graf graf--p graf-after--p">Geospatial data is often presented in the form of addresses or coordinates of (Latitude, Longitude). Depending on the task, you may need two mutually-inverse operations: geocoding (recovering a point from an address) and reverse geocoding (recovering an address from a point). Both operations are accessible in practice via external APIs from Google Maps or OpenStreetMap. Different geocoders have their own characteristics, and the quality varies from region to region. Fortunately, there are universal libraries like <code class="markup--code markup--p-code"><a href="https://github.com/geopy/geopy" data-href="https://github.com/geopy/geopy" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">geopy</a></code> that act as wrappers for these external services.</p><p name="3ea8" id="3ea8" class="graf graf--p graf-after--p">If you have a lot of data, you will quickly reach the limits of external API. Besides, it is not always the fastest to receive information via HTTP. Therefore, it is necessary to consider using a local version of OpenStreetMap.</p><p name="c417" id="c417" class="graf graf--p graf-after--p">If you have a small amount of data, enough time, and no desire to extract fancy features, you can use <code class="markup--code markup--p-code">reverse_geocoder</code> in lieu of OpenStreetMap:</p><pre name="fcae" id="fcae" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">reverse_geocoder</strong> <strong class="markup--strong markup--pre-strong">as</strong> <strong class="markup--strong markup--pre-strong">revgc</strong><br><br>In : revgc.search((df.latitude, df.longitude)) <br>Loading formatted geocoded file... <br>Out: [OrderedDict([('lat', '40.74482'), <br>                   ('lon', '-73.94875'), <br>                   ('name', 'Long Island City'), <br>                   ('admin1', 'New York'), <br>                   ('admin2', 'Queens County'), <br>                   ('cc', 'US')])]</pre><p name="467f" id="467f" class="graf graf--p graf-after--pre">When working with geoсoding, we must not forget that addresses may contain typos, which makes the data cleaning step necessary. Coordinates contain fewer misprints, but its position can be incorrect due to GPS noise or bad accuracy in places like tunnels, downtown areas, etc. If the data source is a mobile device, the geolocation may not be determined by GPS but by WiFi networks in the area, which leads to holes in space and teleportation. While traveling along in Manhattan, there can suddenly be a WiFi location from Chicago.</p><blockquote name="ac19" id="ac19" class="graf graf--blockquote graf-after--p">WiFi location tracking is based on the combination of SSID and MAC-addresses, which may correspond to different points e.g. federal provider standardizes the firmware of routers up to MAC-address and places them in different cities. Even a company's move to another office with its routers can cause issues.</blockquote><p name="40e0" id="40e0" class="graf graf--p graf-after--blockquote">The point is usually located among infrastructure. Here, you can really unleash your imagination and invent features based on your life experience and domain knowledge: the proximity of a point to the subway, the number of stories in the building, the distance to the nearest store, the number of ATMs around, etc. For any task, you can easily come up with dozens of features and extract them from various external sources. For problems outside an urban environment, you may consider features from more specific sources e.g. the height above sea level.</p><p name="453a" id="453a" class="graf graf--p graf-after--p">If two or more points are interconnected, it may be worthwhile to extract features from the route between them. In that case, distances (great circle distance and road distance calculated by the routing graph), number of turns with the ratio of left to right turns, number of traffic lights, junctions, and bridges will be useful. In one of my own tasks, I generated a feature called "the complexity of the road", which computed the graph-calculated distance divided by the GCD.</p><h3 name="c36f" id="c36f" class="graf graf--h3 graf-after--p">1.4. Date and&nbsp;time</h3><p name="52db" id="52db" class="graf graf--p graf-after--h3">You would think that date and time are standardized because of their prevalence, but, nevertheless, some pitfalls remain.</p><p name="ab7e" id="ab7e" class="graf graf--p graf-after--p">Let's start with the day of the week, which are easy to turn into 7 dummy variables using one-hot encoding. In addition, we will also create a separate binary feature for the weekend called <code class="markup--code markup--p-code">is_weekend</code>.</p><pre name="630a" id="630a" class="graf graf--pre graf-after--p">df['dow'] = df['created'].apply(<strong class="markup--strong markup--pre-strong">lambda</strong> x: x.date().weekday())<br>df['is_weekend'] = df['created'].apply(<strong class="markup--strong markup--pre-strong">lambda</strong> x: 1 <strong class="markup--strong markup--pre-strong">if</strong> x.date().weekday() <strong class="markup--strong markup--pre-strong">in</strong> (5, 6) <strong class="markup--strong markup--pre-strong">else</strong> 0)</pre><p name="a6d6" id="a6d6" class="graf graf--p graf-after--pre">Some tasks may require additional calendar features. For example, cash withdrawals can be linked to a pay day; the purchase of a metro card, to the beginning of the month. In general, when working with time series data, it is a good idea to have a calendar with public holidays, abnormal weather conditions, and other important events.</p><blockquote name="771b" id="771b" class="graf graf--blockquote graf-after--p">Q: What do Chinese New Year, the New York marathon, and the Trump inauguration have in common?</blockquote><blockquote name="f731" id="f731" class="graf graf--blockquote graf-after--blockquote">A: They all need to be put on the calendar of potential anomalies.</blockquote><p name="e1cc" id="e1cc" class="graf graf--p graf-after--blockquote">Dealing with hour (minute, day of the month&nbsp;...) is not as simple as it seems. If you use the hour as a real variable, we slightly contradict the nature of data: <code class="markup--code markup--p-code">0&lt;23</code> while <code class="markup--code markup--p-code">0:00:00 02.01&gt; 01.01 23:00:00</code>. For some problems, this can be critical. At the same time, if you encode them as categorical variables, you'll breed a large numbers of features and lose information about proximity -- the difference between 22 and 23 will be the same as the difference between 22 and 7.</p><p name="e331" id="e331" class="graf graf--p graf-after--p">There also exist some more esoteric approaches to such data like projecting the time onto a circle and using the two coordinates.</p><pre name="1cb2" id="1cb2" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">def</strong> make_harmonic_features(value, period=24):<br>    value *= 2 * np.pi / period <br>    <strong class="markup--strong markup--pre-strong">return</strong> np.cos(value), np.sin(value)</pre><p name="597c" id="597c" class="graf graf--p graf-after--pre">This transformation preserves the distance between points, which is important for algorithms that estimate distance (kNN, SVM, k-means&nbsp;...)</p><pre name="650e" id="650e" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">scipy.spatial</strong> <strong class="markup--strong markup--pre-strong">import</strong> distance<br><br>In : euclidean(make_harmonic_features(23), make_harmonic_features(1)) <br>Out: 0.5176380902050424<br><br>In : euclidean(make_harmonic_features(9), make_harmonic_features(11)) <br>Out: 0.5176380902050414<br><br>In : euclidean(make_harmonic_features(9), make_harmonic_features(21)) <br>Out: 2.0</pre><p name="4754" id="4754" class="graf graf--p graf-after--pre">However, the difference between such coding methods is down to the third decimal place in the metric.</p><h3 name="0a96" id="0a96" class="graf graf--h3 graf-after--p">1.5. Time series, web,&nbsp;etc.</h3><p name="ae07" id="ae07" class="graf graf--p graf-after--h3">Regarding time series — we will not go into too much detail here (mostly due to my personal lack of experience), but I will point you to <a href="https://github.com/blue-yonder/tsfresh" data-href="https://github.com/blue-yonder/tsfresh" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">a useful library that automatically generates features for time series</a>.</p><p name="8fba" id="8fba" class="graf graf--p graf-after--p">If you are working with web data, then you usually have information about the user's User Agent. It is a wealth of information. First, one needs to extract the operating system from it. Secondly, make a feature <code class="markup--code markup--p-code">is_mobile</code>. Third, look at the browser.</p><pre name="b9fb" id="b9fb" class="graf graf--pre graf-after--p">In : ua = 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/56.0.2924.76 Chrome/ <br>...: 56.0.2924.76 Safari/537.36'<br><br>In : <strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">user_agents</strong><br><br>In : ua = user_agents.parse(ua)<br><br>In : ua.is_bot <br>Out: False<br><br>In : ua.is_mobile <br>Out: False<br><br>In : ua.is_pc <br>Out: True<br><br>In : ua.os.family <br>Out: 'Ubuntu'<br><br>In : ua.os.version <br>Out: ()<br><br>In : ua.browser.family <br>Out: 'Chromium'<br><br>In : ua.os.version <br>Out: ()<br><br>In : ua.browser.version <br>Out: (56, 0, 2924)</pre><blockquote name="355d" id="355d" class="graf graf--blockquote graf-after--pre">As in other domains, you can come up with your own features based on intuition about the nature of the data. At the time of this writing, Chromium 56 was new, but, after some time, only users who haven't rebooted their browser for a long time will have this version. In this case, why not introduce a feature called "lag behind the latest version of the browser"?</blockquote><p name="1e21" id="1e21" class="graf graf--p graf-after--blockquote">In addition to the operating system and browser, you can look at the referrer (not always available), <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language" data-href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">http_accept_language</a>, and other meta information.</p><p name="c0bb" id="c0bb" class="graf graf--p graf-after--p">The next useful piece of information is the IP-address, from which you can extract the country and possibly the city, provider, and connection type (mobile/stationary). You need to understand that there is a variety of proxy and outdated databases, so this feature can contain noise. Network administration gurus may try to extract even fancier features like suggestions for <a href="https://habrahabr.ru/post/216295/" data-href="https://habrahabr.ru/post/216295/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">using VPN</a>. By the way, the data from the IP-address is well combined with <code class="markup--code markup--p-code">http_accept_language</code>: if the user is sitting at the Chilean proxies and browser locale is <code class="markup--code markup--p-code">ru_RU</code>, something is unclean and worth a look in the corresponding column in the table (<code class="markup--code markup--p-code">is_traveler_or_proxy_user</code>).</p><p name="a8c1" id="a8c1" class="graf graf--p graf-after--p">Any given area has so many specifics that it is too much for an individual to absorb completely. Therefore, I invite everyone to share their experiences and discuss feature extraction and generation in the comments section.</p><h3 name="d6b1" id="d6b1" class="graf graf--h3 graf-after--p">2. Feature transformations</h3><h3 name="35fb" id="35fb" class="graf graf--h3 graf-after--h3">2.1. Normalization and changing distribution</h3><p name="afe2" id="afe2" class="graf graf--p graf-after--h3">Monotonic feature transformation is critical for some algorithms and has no effect on others. This is one of the reasons for the increased popularity of decision trees and all its derivative algorithms (random forest, gradient boosting). Not everyone can or want to tinker with transformations, and these algorithms are robust to unusual distributions.</p><p name="6b28" id="6b28" class="graf graf--p graf-after--p">There are also purely engineering reasons: <code class="markup--code markup--p-code">np.log</code> is a way of dealing with large numbers that do not fit in <code class="markup--code markup--p-code">np.float64</code>. This is an exception rather than a rule; often it's driven by the desire to adapt the dataset to the requirements of the algorithm. Parametric methods usually require a minimum of symmetric and unimodal distribution of data, which is not always given in real data. There may be more stringent requirements; recall <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-4-linear-classification-and-regression-44a41b9b5220" data-href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-4-linear-classification-and-regression-44a41b9b5220" class="markup--anchor markup--p-anchor" target="_blank">our earlier article about linear models</a>.</p><p name="dca0" id="dca0" class="graf graf--p graf-after--p">However, data requirements are imposed not only by parametric methods; <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-3-classification-decision-trees-and-k-nearest-neighbors-8613c6b6d2cd" data-href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-3-classification-decision-trees-and-k-nearest-neighbors-8613c6b6d2cd" class="markup--anchor markup--p-anchor" target="_blank">K nearest neighbors</a> will predict complete nonsense if features are not normalized e.g. when one distribution is located in the vicinity of zero and does not go beyond (-1, 1) while the other’s range is on the order of hundreds of thousands.</p><p name="b537" id="b537" class="graf graf--p graf-after--p">A simple example: suppose that the task is to predict the cost of an apartment from two variables — the distance from city center and the number of rooms. The number of rooms rarely exceeds 5 whereas the distance from city center can easily be in the thousands of meters.</p><p name="f112" id="f112" class="graf graf--p graf-after--p">The simplest transformation is Standard Scaling (or Z-score normalization):</p><figure name="a947" id="a947" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 142px; max-height: 78px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 54.900000000000006%;"></div><img class="graf-image" data-image-id="1*l3GMKe44JVe8YKQi8ZdWgQ.png" data-width="142" data-height="78" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_l3GMKe44JVe8YKQi8ZdWgQ.png"></div></figure><p name="de0d" id="de0d" class="graf graf--p graf-after--figure">Note that Standard Scaling does not make the distribution normal in the strict sense.</p><pre name="e55d" id="e55d" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.preprocessing</strong> <strong class="markup--strong markup--pre-strong">import</strong> StandardScaler</pre><pre name="6637" id="6637" class="graf graf--pre graf-after--pre">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">scipy.stats</strong> <strong class="markup--strong markup--pre-strong">import</strong> beta</pre><pre name="0223" id="0223" class="graf graf--pre graf-after--pre">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">scipy.stats</strong> <strong class="markup--strong markup--pre-strong">import</strong> shapiro</pre><pre name="11f9" id="11f9" class="graf graf--pre graf-after--pre">In : data = beta(1, 10).rvs(1000).reshape(-1, 1)</pre><pre name="9cd9" id="9cd9" class="graf graf--pre graf-after--pre">In : shapiro(data) <br>Out: (0.8783774375915527, 3.0409122263582326e-27)</pre><pre name="5bee" id="5bee" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em"># Value of the statistic, p-value</em></pre><pre name="9bfd" id="9bfd" class="graf graf--pre graf-after--pre">In : shapiro(StandardScaler().fit_transform(data)) <br>Out: (0.8783774375915527, 3.0409122263582326e-27)</pre><pre name="e598" id="e598" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em"># With such p-value we'd have to reject the null hypothesis of normality of the data</em></pre><p name="a5d3" id="a5d3" class="graf graf--p graf-after--pre">But, to some extent, it protects against outliers:</p><pre name="f39b" id="f39b" class="graf graf--pre graf-after--p">In : data = np.array([1, 1, 0, -1, 2, 1, 2, 3, -2, 4, 100]).reshape(-1, 1).astype(np.float64)</pre><pre name="46c5" id="46c5" class="graf graf--pre graf-after--pre">In : StandardScaler().fit_transform(data) <br>Out: <br>array([[-0.31922662], <br>       [-0.31922662],<br>       [-0.35434155],<br>       [-0.38945648],<br>       [-0.28411169],<br>       [-0.31922662],<br>       [-0.28411169],<br>       [-0.24899676],<br>       [-0.42457141],<br>       [-0.21388184],<br>       [ 3.15715128]])</pre><pre name="28c2" id="28c2" class="graf graf--pre graf-after--pre">In : (data – data.mean()) / data.std() <br>Out: <br>array([[-0.31922662], <br>       [-0.31922662],<br>       [-0.35434155],<br>       [-0.38945648],<br>       [-0.28411169],<br>       [-0.31922662],<br>       [-0.28411169],<br>       [-0.24899676],<br>       [-0.42457141],<br>       [-0.21388184],<br>       [ 3.15715128]])</pre><p name="f2d8" id="f2d8" class="graf graf--p graf-after--pre">Another fairly popular option is MinMax Scaling, which brings all the points within a predetermined interval (typically (0, 1)).</p><figure name="499f" id="499f" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 282px; max-height: 101px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 35.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*-MkabcMqk1Cm1HjCg59G_Q.png" data-width="282" data-height="101" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_-MkabcMqk1Cm1HjCg59G_Q.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="26"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*-MkabcMqk1Cm1HjCg59G_Q.png" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_-MkabcMqk1Cm1HjCg59G_Q(1).png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*-MkabcMqk1Cm1HjCg59G_Q.png"></noscript></div></div></figure><pre name="a448" id="a448" class="graf graf--pre graf-after--figure">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.preprocessing</strong> <strong class="markup--strong markup--pre-strong">import</strong> MinMaxScaler</pre><pre name="b8f3" id="b8f3" class="graf graf--pre graf-after--pre">In : MinMaxScaler().fit_transform(data) <br>Out: <br>array([[ 0.02941176],<br>       [ 0.02941176],<br>       [ 0.01960784],<br>       [ 0.00980392],<br>       [ 0.03921569],<br>       [ 0.02941176],<br>       [ 0.03921569],<br>       [ 0.04901961],<br>       [ 0. ],<br>       [ 0.05882353],<br>       [ 1. ]])</pre><pre name="709e" id="709e" class="graf graf--pre graf-after--pre">In : (data – data.min()) / (data.max() – data.min()) <br>Out: <br>array([[ 0.02941176],<br>       [ 0.02941176],<br>       [ 0.01960784],<br>       [ 0.00980392],<br>       [ 0.03921569],<br>       [ 0.02941176],<br>       [ 0.03921569],<br>       [ 0.04901961],<br>       [ 0. ],<br>       [ 0.05882353],<br>       [ 1. ]])</pre><p name="a6e5" id="a6e5" class="graf graf--p graf-after--pre">StandardScaling and MinMax Scaling have similar applications and are often more or less interchangeable. However, if the algorithm involves the calculation of distances between points or vectors, the default choice is StandardScaling. But MinMax Scaling is useful for visualization by bringing features within the interval (0, 255).</p><p name="ae2c" id="ae2c" class="graf graf--p graf-after--p">If we assume that some data is not normally distributed but is described by the <a href="https://ru.wikipedia.org/wiki/%D0%9B%D0%BE%D0%B3%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5" data-href="https://ru.wikipedia.org/wiki/%D0%9B%D0%BE%D0%B3%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">log-normal distribution</a>, it can easily be transformed to a normal distribution:</p><pre name="f30e" id="f30e" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">scipy.stats</strong> <strong class="markup--strong markup--pre-strong">import</strong> lognorm</pre><pre name="2465" id="2465" class="graf graf--pre graf-after--pre">In : data = lognorm(s=1).rvs(1000)</pre><pre name="7a47" id="7a47" class="graf graf--pre graf-after--pre">In : shapiro(data)<br>Out: (0.05714237689971924, 0.0)</pre><pre name="234e" id="234e" class="graf graf--pre graf-after--pre">In : shapiro(np.log(data))<br>Out: (0.9980740547180176, 0.3150389492511749)</pre><p name="cd37" id="cd37" class="graf graf--p graf-after--pre">The lognormal distribution is suitable for describing salaries, price of securities, urban population, number of comments on articles on the internet, etc. However, to apply this procedure, the underlying distribution does not necessarily have to be lognormal; you can try to apply this transformation to any distribution with a heavy right tail. Furthermore, one can try to use other similar transformations, formulating their own hypotheses on how to approximate the available distribution to a normal. Examples of such transformations are <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html" data-href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Box-Cox transformation</a> (logarithm is a special case of the Box-Cox transformation) or <a href="https://gist.github.com/mesgarpour/f24769cd186e2db853957b10ff6b7a95" data-href="https://gist.github.com/mesgarpour/f24769cd186e2db853957b10ff6b7a95" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Yeo-Johnson transformation</a> (extends the range of applicability to negative numbers). In addition, you can also try adding a constant to the feature — <code class="markup--code markup--p-code">np.log (x + const)</code>.</p><p name="ca29" id="ca29" class="graf graf--p graf-after--p">In the examples above, we have worked with synthetic data and strictly tested normality using the Shapiro-Wilk test. Let’s try to look at some real data and test for normality using a less formal method — <a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot" data-href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Q-Q plot</a>. For a normal distribution, it will look like a smooth diagonal line, and visual anomalies should be intuitively understandable.</p><figure name="34b4" id="34b4" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 640px; max-height: 480px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*AQtlE1Lo2GJjS6L2." data-width="640" data-height="480" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_AQtlE1Lo2GJjS6L2" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*AQtlE1Lo2GJjS6L2." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_AQtlE1Lo2GJjS6L2(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*AQtlE1Lo2GJjS6L2."></noscript></div></div></figure><p name="d2b6" id="d2b6" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Q-Q plot for lognormal distribution</em></p><figure name="69e8" id="69e8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 640px; max-height: 480px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*_BEpFh1qqEn1yxvf." data-width="640" data-height="480" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0__BEpFh1qqEn1yxvf" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*_BEpFh1qqEn1yxvf." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0__BEpFh1qqEn1yxvf(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*_BEpFh1qqEn1yxvf."></noscript></div></div></figure><p name="622c" id="622c" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Q-Q plot for the same distribution after taking the logarithm</em></p><pre name="8648" id="8648" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em"># Let's draw plots!</em><br>In : <strong class="markup--strong markup--pre-strong">import</strong> <strong class="markup--strong markup--pre-strong">statsmodels.api</strong> <strong class="markup--strong markup--pre-strong">as</strong> <strong class="markup--strong markup--pre-strong">sm</strong></pre><pre name="8ba6" id="8ba6" class="graf graf--pre graf-after--pre">Let's take the price feature from Renthop dataset and filter by hands the most extreme values for clarity</pre><pre name="09ad" id="09ad" class="graf graf--pre graf-after--pre">In : price = df.price[(df.price &lt;= 20000) &amp; (df.price &gt; 500)]</pre><pre name="4dca" id="4dca" class="graf graf--pre graf-after--pre">In : price_log = np.log(price)</pre><pre name="e0db" id="e0db" class="graf graf--pre graf-after--pre">In : price_mm = MinMaxScaler().fit_transform(price.values.reshape(-1, 1).astype(np.float64)).flatten()</pre><pre name="a43a" id="a43a" class="graf graf--pre graf-after--pre">A lot of gestures so that sklearn didn't shower us with warnings</pre><pre name="4ff6" id="4ff6" class="graf graf--pre graf-after--pre">In : price_z = StandardScaler().fit_transform(price.values.reshape(-1, 1).astype(np.float64)).flatten()</pre><pre name="89c2" id="89c2" class="graf graf--pre graf-after--pre">In : sm.qqplot(price_log, loc=price_log.mean(), scale=price_log.std()).savefig('qq_price_log.png')</pre><pre name="0b7c" id="0b7c" class="graf graf--pre graf-after--pre">In : sm.qqplot(price_mm, loc=price_mm.mean(), scale=price_mm.std()).savefig('qq_price_mm.png')</pre><pre name="9cfd" id="9cfd" class="graf graf--pre graf-after--pre">In : sm.qqplot(price_z, loc=price_z.mean(), scale=price_z.std()).savefig('qq_price_z.png')</pre><figure name="0e0d" id="0e0d" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 640px; max-height: 480px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*Sa6wnbq4GNZY4kIP." data-width="640" data-height="480" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_Sa6wnbq4GNZY4kIP" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*Sa6wnbq4GNZY4kIP." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_Sa6wnbq4GNZY4kIP(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*Sa6wnbq4GNZY4kIP."></noscript></div></div></figure><p name="0e69" id="0e69" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Q-Q plot of the initial feature</em></p><figure name="af4c" id="af4c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 640px; max-height: 480px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*YU-B3B5n3NoVDMmF." data-width="640" data-height="480" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_YU-B3B5n3NoVDMmF" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*YU-B3B5n3NoVDMmF." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_YU-B3B5n3NoVDMmF(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*YU-B3B5n3NoVDMmF."></noscript></div></div></figure><p name="423c" id="423c" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Q-Q plot after StandardScaler. Shape doesn’t change</em></p><figure name="5211" id="5211" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 640px; max-height: 480px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*bbF0MNcLyvls0dSC." data-width="640" data-height="480" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_bbF0MNcLyvls0dSC" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*bbF0MNcLyvls0dSC." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_bbF0MNcLyvls0dSC(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*bbF0MNcLyvls0dSC."></noscript></div></div></figure><p name="3137" id="3137" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Q-Q plot after MinMaxScaler. Shape doesn’t change</em></p><figure name="7921" id="7921" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 640px; max-height: 480px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*Jt57qDq80k1yr5Sv." data-width="640" data-height="480" data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_Jt57qDq80k1yr5Sv" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*Jt57qDq80k1yr5Sv." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_Jt57qDq80k1yr5Sv(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*Jt57qDq80k1yr5Sv."></noscript></div></div></figure><p name="f518" id="f518" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Q-Q plot after taking the logarithm. Things are getting better!</em></p><p name="24ea" id="24ea" class="graf graf--p graf-after--p">Let’s see whether transformations can somehow help the real model. There is no silver bullet here.</p><h3 name="a6ef" id="a6ef" class="graf graf--h3 graf-after--p">2.2. Interactions</h3><p name="eb52" id="eb52" class="graf graf--p graf-after--h3">If previous transformations seemed rather math-driven, this part is more about the nature of the data; it can be attributed to both feature transformations and feature creation.</p><p name="fdf8" id="fdf8" class="graf graf--p graf-after--p">Let’s come back again to the Two Sigma Connect: Rental Listing Inquiries problem. Among the features in this problem are the number of rooms and the price. Logic suggests that the cost per single room is more indicative than the total cost, so we can generate such a feature.</p><pre name="9750" id="9750" class="graf graf--pre graf-after--p">rooms = df["bedrooms"].apply(<strong class="markup--strong markup--pre-strong">lambda</strong> x: max(x, .5))</pre><pre name="75e6" id="75e6" class="graf graf--pre graf-after--pre"># Avoid division by zero; .5 <strong class="markup--strong markup--pre-strong">is</strong> chosen more <strong class="markup--strong markup--pre-strong">or</strong> less arbitrarily</pre><pre name="ef38" id="ef38" class="graf graf--pre graf-after--pre">df["price_per_bedroom"] = df["price"] / rooms</pre><p name="e672" id="e672" class="graf graf--p graf-after--pre">You should limit yourself in this process. If there are a limited number of features, it is possible to generate all the possible interactions and then weed out the unnecessary ones using the techniques described in the next section. In addition, not all interactions between features must have a physical meaning; for example, polynomial features (see <code class="markup--code markup--p-code"><a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html" data-href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">sklearn.preprocessing.PolynomialFeatures</a></code>) are often used in linear models and are almost impossible to interpret.</p><h3 name="edd4" id="edd4" class="graf graf--h3 graf-after--p">2.3. Filling in the missing&nbsp;values</h3><p name="0d04" id="0d04" class="graf graf--p graf-after--h3">Not many algorithms can work with missing values, and the real world often provides data with gaps. Fortunately, this is one of the tasks for which one doesn’t need any creativity. Both key python libraries for data analysis provide easy-to-use solutions: <code class="markup--code markup--p-code"><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html" data-href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">pandas.DataFrame.fillna</a></code> and <code class="markup--code markup--p-code"><a href="http://scikit-learn.org/stable/modules/preprocessing.html#imputation" data-href="http://scikit-learn.org/stable/modules/preprocessing.html#imputation" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">sklearn.preprocessing.Imputer</a></code>.</p><p name="fc46" id="fc46" class="graf graf--p graf-after--p">These solutions do not have any magic happening behind the scenes. Approaches to handling missing values are pretty straightforward:</p><ul class="postList"><li name="78ba" id="78ba" class="graf graf--li graf-after--p">encode missing values with a separate blank value like <code class="markup--code markup--li-code">"n/a"</code> (for categorical variables);</li><li name="7aab" id="7aab" class="graf graf--li graf-after--li">use the most probable value of the feature (mean or median for the numerical variables, the most common value for categorical variables);</li><li name="6638" id="6638" class="graf graf--li graf-after--li">or, conversely, encode with some extreme value (good for decision-tree models since it allows the model to make a partition between the missing and non-missing values);</li><li name="ec3b" id="ec3b" class="graf graf--li graf-after--li">for ordered data (e.g. time series), take the adjacent value — next or previous.</li></ul><figure name="b878" id="b878" class="graf graf--figure graf-after--li"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 201px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 28.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="0*Ps-v8F0fBgmnG36S." data-width="802" data-height="230" data-action="zoom" data-action-value="0*Ps-v8F0fBgmnG36S." data-scroll="native"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_Ps-v8F0fBgmnG36S" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="21"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/0*Ps-v8F0fBgmnG36S." src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_Ps-v8F0fBgmnG36S(1)"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/0*Ps-v8F0fBgmnG36S."></noscript></div></div></figure><p name="0c5c" id="0c5c" class="graf graf--p graf-after--figure">Easy-to-use library solutions sometimes suggest sticking to something like <code class="markup--code markup--p-code">df = df.fillna(0)</code> and not sweat the gaps. But this is not the best solution: data preparation takes more time than building models, so thoughtless gap-filling may hide a bug in processing and damage the model.</p><h3 name="4628" id="4628" class="graf graf--h3 graf-after--p">3. Feature selection</h3><p name="ccef" id="ccef" class="graf graf--p graf-after--h3">Why would it even be necessary to select features? To some, this idea may seem counterintuitive, but there are at least two important reasons to get rid of unimportant features. The first is clear to every engineer: the more data, the higher the computational complexity. As long as we work with toy datasets, the size of the data is not a problem, but, for real loaded production systems, hundreds of extra features will be quite tangible. The second reason is that some algorithms take noise (non-informative features) as a signal and overfit.</p><h3 name="8c45" id="8c45" class="graf graf--h3 graf-after--p">3.1. Statistical approaches</h3><p name="c413" id="c413" class="graf graf--p graf-after--h3">The most obvious candidate for removal is a feature whose value remains unchanged, i.e., it contains no information at all. If we build on this thought, it is reasonable to say that features with low variance are worse than those with high variance. So, one can consider cutting features with variance below a certain threshold.</p><pre name="c1f8" id="c1f8" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.feature_selection</strong> <strong class="markup--strong markup--pre-strong">import</strong> VarianceThreshold</pre><pre name="f246" id="f246" class="graf graf--pre graf-after--pre">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.datasets</strong> <strong class="markup--strong markup--pre-strong">import</strong> make_classification</pre><pre name="9dd8" id="9dd8" class="graf graf--pre graf-after--pre">In : x_data_generated, y_data_generated = make_classification()</pre><pre name="d956" id="d956" class="graf graf--pre graf-after--pre">In : x_data_generated.shape Out: (100, 20)</pre><pre name="70a8" id="70a8" class="graf graf--pre graf-after--pre">In : VarianceThreshold(.7).fit_transform(x_data_generated).shape Out: (100, 19)</pre><pre name="b153" id="b153" class="graf graf--pre graf-after--pre">In : VarianceThreshold(.8).fit_transform(x_data_generated).shape Out: (100, 18)</pre><pre name="c3cf" id="c3cf" class="graf graf--pre graf-after--pre">In : VarianceThreshold(.9).fit_transform(x_data_generated).shape Out: (100, 15)</pre><p name="07a9" id="07a9" class="graf graf--p graf-after--pre">There are other ways that are also <a href="http://scikit-learn.org/stable/modules/feature_selection.html#univariate-feature-selection" data-href="http://scikit-learn.org/stable/modules/feature_selection.html#univariate-feature-selection" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">based on classical statistics</a>.</p><pre name="fc84" id="fc84" class="graf graf--pre graf-after--p">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.feature_selection</strong> <strong class="markup--strong markup--pre-strong">import</strong> SelectKBest, f_classif</pre><pre name="f5ba" id="f5ba" class="graf graf--pre graf-after--pre">In : x_data_kbest = SelectKBest(f_classif, k=5).fit_transform(x_data_generated, y_data_generated)</pre><pre name="bf29" id="bf29" class="graf graf--pre graf-after--pre">In : x_data_varth = VarianceThreshold(.9).fit_transform(x_data_generated)</pre><pre name="2a33" id="2a33" class="graf graf--pre graf-after--pre">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.linear_model</strong> <strong class="markup--strong markup--pre-strong">import</strong> LogisticRegression</pre><pre name="4ee3" id="4ee3" class="graf graf--pre graf-after--pre">In : <strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.model_selection</strong> <strong class="markup--strong markup--pre-strong">import</strong> cross_val_score</pre><pre name="95d9" id="95d9" class="graf graf--pre graf-after--pre">In : cross_val_score(LogisticRegression(), x_data_generated, y_data_generated, scoring='neg_log_loss').mean() Out: -0.45367136377981693</pre><pre name="1ff0" id="1ff0" class="graf graf--pre graf-after--pre">In : cross_val_score(LogisticRegression(), x_data_kbest, y_data_generated, scoring='neg_log_loss').mean() Out: -0.35775228616521798</pre><pre name="7ea2" id="7ea2" class="graf graf--pre graf-after--pre">In : cross_val_score(LogisticRegression(), x_data_varth, y_data_generated, scoring='neg_log_loss').mean() Out: -0.44033042718359772</pre><p name="2225" id="2225" class="graf graf--p graf-after--pre">We can see that our selected features have improved the quality of the classifier. Of course, this example is <em class="markup--em markup--p-em">purely</em> artificial; however, it is worth using for real problems.</p><h3 name="37a9" id="37a9" class="graf graf--h3 graf-after--p">3.2. Selection by&nbsp;modeling</h3><p name="a7f8" id="a7f8" class="graf graf--p graf-after--h3">Another approach is to use some baseline model for feature evaluation because the model will clearly show the importance of the features. Two types of models are usually used: some “wooden” composition such as <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-5-ensembles-of-algorithms-and-random-forest-8e05246cbba7" data-href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-5-ensembles-of-algorithms-and-random-forest-8e05246cbba7" class="markup--anchor markup--p-anchor" target="_blank">Random Forest</a> or a linear model with Lasso regularization so that it is prone to nullify weights of weak features. The logic is intuitive: if features are clearly useless in a simple model, there is no need to drag them to a more complex one.</p><pre name="b1d9" id="b1d9" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em"># Synthetic example</em></pre><pre name="6234" id="6234" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.datasets</strong> <strong class="markup--strong markup--pre-strong">import</strong> make_classification<br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.linear_model</strong> <strong class="markup--strong markup--pre-strong">import</strong> LogisticRegression<br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.ensemble</strong> <strong class="markup--strong markup--pre-strong">import</strong> RandomForestClassifier<br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.feature_selection</strong> <strong class="markup--strong markup--pre-strong">import</strong> SelectFromModel<br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.model_selection</strong> <strong class="markup--strong markup--pre-strong">import</strong> cross_val_score<br><strong class="markup--strong markup--pre-strong">from</strong> <strong class="markup--strong markup--pre-strong">sklearn.pipeline</strong> <strong class="markup--strong markup--pre-strong">import</strong> make_pipeline</pre><pre name="cfe3" id="cfe3" class="graf graf--pre graf-after--pre">x_data_generated, y_data_generated = make_classification()</pre><pre name="bab2" id="bab2" class="graf graf--pre graf-after--pre">pipe = make_pipeline(SelectFromModel(estimator=RandomForestClassifier()), LogisticRegression())</pre><pre name="c624" id="c624" class="graf graf--pre graf-after--pre">lr = LogisticRegression()<br>rf = RandomForestClassifier()</pre><pre name="6815" id="6815" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">print</strong>(cross_val_score(lr, x_data_generated, y_data_generated, scoring='neg_log_loss').mean())<br><strong class="markup--strong markup--pre-strong">print</strong>(cross_val_score(rf, x_data_generated, y_data_generated, scoring='neg_log_loss').mean())<br><strong class="markup--strong markup--pre-strong">print</strong>(cross_val_score(pipe, x_data_generated, y_data_generated, scoring='neg_log_loss').mean())</pre><pre name="76b8" id="76b8" class="graf graf--pre graf-after--pre"># -0.455661299521484<br># -0.6817083161800542<br># -0.28572375767268404</pre><p name="89d1" id="89d1" class="graf graf--p graf-after--pre">We must not forget that this is not a silver bullet again — it can make the performance worse.</p><pre name="4406" id="4406" class="graf graf--pre graf-after--p">x_data, y_data = get_data() x_data = x_data.values</pre><pre name="5642" id="5642" class="graf graf--pre graf-after--pre">pipe1 = make_pipeline(StandardScaler(), SelectFromModel(estimator=RandomForestClassifier()), LogisticRegression())</pre><pre name="737a" id="737a" class="graf graf--pre graf-after--pre">pipe2 = make_pipeline(StandardScaler(), LogisticRegression())</pre><pre name="0cab" id="0cab" class="graf graf--pre graf-after--pre">rf = RandomForestClassifier()</pre><pre name="721d" id="721d" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">print</strong>('LR + selection: ', cross_val_score(pipe1, x_data, y_data, scoring='neg_log_loss').mean())<br><strong class="markup--strong markup--pre-strong">print</strong>('LR: ', cross_val_score(pipe2, x_data, y_data, scoring='neg_log_loss').mean())<br><strong class="markup--strong markup--pre-strong">print</strong>('RF: ', cross_val_score(rf, x_data, y_data, scoring='neg_log_loss').mean())</pre><pre name="91b6" id="91b6" class="graf graf--pre graf-after--pre"># LR + selection: -0.714208124619<br># LR: -0.669572736183</pre><pre name="d0c7" id="d0c7" class="graf graf--pre graf-after--pre"># It got worse!</pre><pre name="e8d4" id="e8d4" class="graf graf--pre graf-after--pre"># RF: -2.13486716798</pre><h3 name="3615" id="3615" class="graf graf--h3 graf-after--pre">3.3. Grid&nbsp;search</h3><p name="20ef" id="20ef" class="graf graf--p graf-after--h3">Finally, we get to the most reliable method, which is also the most computationally complex: trivial grid search. Train a model on a subset of features, store results, repeat for different subsets, and compare the quality of models to identify the best feature set. This approach is called <a href="http://rasbt.github.io/mlxtend/user_guide/feature_selection/ExhaustiveFeatureSelector/" data-href="http://rasbt.github.io/mlxtend/user_guide/feature_selection/ExhaustiveFeatureSelector/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Exhaustive Feature Selection</a>.</p><p name="abd8" id="abd8" class="graf graf--p graf-after--p">Searching all combinations usually takes too long, so you can try to reduce the search space. Fix a small number N, iterate through all combinations of N features, choose the best combination, and then iterate through the combinations of (N + 1) features so that the previous best combination of features is fixed and only a single new feature is considered. It is possible to iterate until we hit a maximum number of characteristics or until the quality of the model ceases to increase significantly. This algorithm is called <a href="http://rasbt.github.io/mlxtend/user_guide/feature_selection/SequentialFeatureSelector/" data-href="http://rasbt.github.io/mlxtend/user_guide/feature_selection/SequentialFeatureSelector/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Sequential Feature Selection</a>.</p><p name="67c8" id="67c8" class="graf graf--p graf-after--p">This algorithm can be reversed: start with the complete feature space and remove features one by one until it does not impair the quality of the model or until the desired number of features is reached.</p><pre name="df0d" id="df0d" class="graf graf--pre graf-after--p">In : selector = SequentialFeatureSelector(LogisticRegression(), scoring='neg_log_loss', verbose=2, k_features=3, forward=False, n_jobs=-1)</pre><pre name="85b9" id="85b9" class="graf graf--pre graf-after--pre">In : selector.fit(x_data_scaled, y_data)</pre><pre name="a37c" id="a37c" class="graf graf--pre graf-after--pre">In : selector.fit(x_data_scaled, y_data)</pre><pre name="0159" id="0159" class="graf graf--pre graf-after--pre">[2017-03-30 01:42:24] Features: 45/3 -- score: -0.682830838803 [2017-03-30 01:44:40] Features: 44/3 -- score: -0.682779463265 [2017-03-30 01:46:47] Features: 43/3 -- score: -0.682727480522 [2017-03-30 01:48:54] Features: 42/3 -- score: -0.682680521828 [2017-03-30 01:50:52] Features: 41/3 -- score: -0.68264297879<br>[2017-03-30 01:52:46] Features: 40/3 -- score: -0.682607753617 [2017-03-30 01:54:37] Features: 39/3 -- score: -0.682570678346 [2017-03-30 01:56:21] Features: 38/3 -- score: -0.682536314625 [2017-03-30 01:58:02] Features: 37/3 -- score: -0.682520258804 [2017-03-30 01:59:39] Features: 36/3 -- score: -0.68250862986<br>[2017-03-30 02:01:17] Features: 35/3 -- score: -0.682498213174<br>...<br>[2017-03-30 02:21:09] Features: 10/3 -- score: -0.68657335969<br>[2017-03-30 02:21:18] Features: 9/3 -- score: -0.688405548594<br>[2017-03-30 02:21:26] Features: 8/3 -- score: -0.690213724719<br>[2017-03-30 02:21:32] Features: 7/3 -- score: -0.692383588303<br>[2017-03-30 02:21:36] Features: 6/3 -- score: -0.695321584506<br>[2017-03-30 02:21:40] Features: 5/3 -- score: -0.698519960477<br>[2017-03-30 02:21:42] Features: 4/3 -- score: -0.704095390444<br>[2017-03-30 02:21:44] Features: 3/3 -- score: -0.713788301404</pre><pre name="97df" id="97df" class="graf graf--pre graf-after--pre">But improvement couldn’t last forever</pre><p name="19bd" id="19bd" class="graf graf--p graf-after--pre">Take a look how this approach was done in one <a href="https://www.kaggle.com/arsenyinfo/easy-feature-selection-pipeline-0-55-at-lb" data-href="https://www.kaggle.com/arsenyinfo/easy-feature-selection-pipeline-0-55-at-lb" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">simple yet elegant Kaggle kernel</a>.</p><h3 name="fb6a" id="fb6a" class="graf graf--h3 graf-after--p">4. Assignment #6</h3><p name="a73b" id="a73b" class="graf graf--p graf-after--h3">A demo version is to appear soon (~ in the end of June 2018). Full version will be available in the new session of the course (starting on October, 1).</p><p name="f387" id="f387" class="graf graf--p graf-after--p graf--trailing">Open Data Science wishes you good luck with the assignment as well as clean data and useful features in your real work!</p></div></div></section><section name="ed84" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="ef18" id="ef18" class="graf graf--p graf--leading graf--trailing"><em class="markup--em markup--p-em">Author: </em><a href="http://arseny.info/pages/about-me.html" data-href="http://arseny.info/pages/about-me.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Arseny Kravchenko</em></a><em class="markup--em markup--p-em">. Translated and edited by </em><a href="https://www.linkedin.com/in/christinabutsko/" data-href="https://www.linkedin.com/in/christinabutsko/" class="markup--anchor markup--p-anchor" rel="nofollow noopener noopener noopener nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Christina Butsko</em></a><em class="markup--em markup--p-em">, </em><a href="https://www.linkedin.com/in/festline/" data-href="https://www.linkedin.com/in/festline/" class="markup--anchor markup--p-anchor" rel="noopener nofollow nofollow noopener noopener noopener nofollow noopener noopener noopener noopener nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Yury Kashnitsky</em></a><em class="markup--em markup--p-em">, </em><a href="https://www.linkedin.com/in/anna-larionova-74434689/" data-href="https://www.linkedin.com/in/anna-larionova-74434689/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Anna Larionova</em></a><em class="markup--em markup--p-em">, </em><a href="https://www.linkedin.com/in/anastasiamanokhina/" data-href="https://www.linkedin.com/in/anastasiamanokhina/" class="markup--anchor markup--p-anchor" rel="nofollow noopener noopener noopener nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Anastasia Manokhina</em></a><em class="markup--em markup--p-em">, </em><a href="https://www.linkedin.com/in/evgenysushko/" data-href="https://www.linkedin.com/in/evgenysushko/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Evgeny Sushko</em></a><em class="markup--em markup--p-em">, </em><a href="https://www.linkedin.com/in/egor-polusmak/" data-href="https://www.linkedin.com/in/egor-polusmak/" class="markup--anchor markup--p-anchor" rel="noopener nofollow noopener noopener nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Egor Polusmak</em></a><em class="markup--em markup--p-em">, and </em><a href="https://www.linkedin.com/in/yuanyuanpao/" data-href="https://www.linkedin.com/in/yuanyuanpao/" class="markup--anchor markup--p-anchor" rel="noopener nofollow nofollow noopener noopener noopener nofollow noopener noopener noopener nofollow noopener" target="_blank"><em class="markup--em markup--p-em">Yuanyuan Pao</em></a><em class="markup--em markup--p-em">.</em></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/data-science?source=post" data-action-source="post">Data Science</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/feature-engineering?source=post" data-action-source="post">Feature Engineering</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/feature-extraction?source=post" data-action-source="post">Feature Extraction</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/feature-selection?source=post" data-action-source="post">Feature Selection</a></li></ul></div></div></div><section class="uiScale uiScale-ui--small uiScale-caption--regular u-borderTopLightest u-marginTop10 u-paddingTop20"><div class="ui-h3 u-textColorDarker u-fontSize22">Like what you read? Give Arseny Kravchenko a round of applause.</div><p class="ui-body u-marginBottom20 u-textColorDark u-fontSize16">From a quick cheer to a standing ovation, clap to show how much you enjoyed this story.</p></section><div class="postActions js-postActionsFooter"><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter u-width60" data-post-id="8b94f870706a" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----8b94f870706a---------------------clap_footer"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboardingcollection" data-action="multivote" data-action-value="8b94f870706a" data-action-type="long-press" data-action-source="post_actions_footer-----8b94f870706a---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="8b94f870706a"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft10"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="8b94f870706a">1.7K</button></span></div></div><div class="buttonSet u-flex0"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="respond" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="scroll-to-responses">2</button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="8b94f870706a" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton" title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size6of12 u-xs-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="e64a1ed25336"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="toggle-block-user" data-action-value="e64a1ed25336" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="toggle-subscribe-user" data-action-value="e64a1ed25336" data-action-source="footer_card-e64a1ed25336-------------------------follow_footer" data-subscribe-source="footer_card" data-follow-context-entity-id="8b94f870706a"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar" href="https://medium.com/@arseny_info?source=footer_card" title="Go to the profile of Arseny Kravchenko" aria-label="Go to the profile of Arseny Kravchenko" data-action-source="footer_card" data-user-id="e64a1ed25336" dir="auto"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_uf2wBS0ahK7CUnFXEFM63g.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Arseny Kravchenko"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@arseny_info" property="cc:attributionName" title="Go to the profile of Arseny Kravchenko" aria-label="Go to the profile of Arseny Kravchenko" rel="author cc:attributionUrl" data-user-id="e64a1ed25336" dir="auto">Arseny Kravchenko</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Sceptical data cruncher.</p></div></li></div><div class="col u-size6of12 u-xs-size12of12 u-xs-marginTop30"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardCollection"><div class="u-marginLeft20 u-floatRight"><button class="button button--primary button--filled button--small button--withChrome u-accentColor--buttonNormal button--withIcon button--withSvgIcon button--withIconRight button--withIconAndLabel js-relationshipButton" data-action="show-more-collection-actions" data-collection-id="b76595fb6cfc"><span class="button-label  js-buttonLabel">Following</span><span class="svgIcon svgIcon--arrowDown svgIcon--21px"><svg class="svgIcon-use" width="21" height="21" viewBox="0 0 21 21"><path d="M4 7.331l6.032 6.67.495.547.495-.547 5.973-6.603-.989-.895-5.974 6.603h.99l-6.033-6.67z" fill-rule="evenodd"></path></svg></span></button></div><div class="u-tableCell "><a class="link u-baseColor--link avatar avatar--roundedRectangle" href="https://medium.com/open-machine-learning-course?source=footer_card" title="Go to Open Machine Learning Course" aria-label="Go to Open Machine Learning Course" data-action-source="footer_card"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_b5pfoCQz20rjh79OPSQWQg.jpeg" class="avatar-image u-size60x60" alt="Open Machine Learning Course"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/open-machine-learning-course?source=footer_card" rel="collection" data-action-source="footer_card">Open Machine Learning Course</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.</p><div class="buttonSet"></div></div></li></div></div></div><div class="js-postFooterPlacements"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1000 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="c53e972e801e" data-source="placement_card_footer_grid---------0-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/@rakshithvasudev/how-i-installed-xgboost-after-a-lot-of-hassels-on-my-windows-machine-c53e972e801e?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*f8cvrgv1oa_7k4fpveEQxQ.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/@rakshithvasudev/how-i-installed-xgboost-after-a-lot-of-hassels-on-my-windows-machine-c53e972e801e?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">How I Installed XGBoost after a lot of Hassles on my Windows Machine.</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@rakshithvasudev" data-action="show-user-card" data-action-value="4ed456ddae20" data-action-type="hover" data-user-id="4ed456ddae20" dir="auto"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_c5Bh8h5qKWnCQ1o6tJTAWQ.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Rakshith Vasudev"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@rakshithvasudev?source=placement_card_footer_grid---------0-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-60" data-action-value="4ed456ddae20" data-action-type="hover" data-user-id="4ed456ddae20" dir="auto">Rakshith Vasudev</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="3 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="c53e972e801e" data-is-label-padded="true" data-source="placement_card_footer_grid-----c53e972e801e----0-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="c53e972e801e" data-action-type="long-press" data-action-source="placement_card_footer_grid-----c53e972e801e----0-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="c53e972e801e">475</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="c53e972e801e" data-action-source="placement_card_footer_grid-----c53e972e801e----0-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="9a0454ce2961" data-source="placement_card_footer_grid---------1-43" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/building-ibotta/feature-engineering-at-ibotta-9a0454ce2961?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*11TcFwuNcu7eBo9kNAP7wg.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/building-ibotta/feature-engineering-at-ibotta-9a0454ce2961?source=placement_card_footer_grid---------1-43" data-action-source="placement_card_footer_grid---------1-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Feature Engineering</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Feature Engineering at Ibotta</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@jcfoley" data-action="show-user-card" data-action-value="262814c0266e" data-action-type="hover" data-user-id="262814c0266e" dir="auto"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_j2fUHicRWR15nAcn" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of James Foley"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@jcfoley?source=placement_card_footer_grid---------1-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-43" data-action-value="262814c0266e" data-action-type="hover" data-user-id="262814c0266e" dir="auto">James Foley</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="6 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="9a0454ce2961" data-is-label-padded="true" data-source="placement_card_footer_grid-----9a0454ce2961----1-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="9a0454ce2961" data-action-type="long-press" data-action-source="placement_card_footer_grid-----9a0454ce2961----1-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="9a0454ce2961">126</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="9a0454ce2961" data-action-source="placement_card_footer_grid-----9a0454ce2961----1-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="d1e7de432df3" data-source="placement_card_footer_grid---------2-43" data-tracking-context="placement" data-scroll="native"><div class="u-padding15 u-borderBox u-flexColumn u-sizeFull"><a class="link link--noUnderline u-baseColor--link u-flex1 u-flexColumn" href="https://medium.com/@scottdandrews/the-curse-of-dimensionality-d1e7de432df3?source=placement_card_footer_grid---------2-43" data-action-source="placement_card_footer_grid---------2-43"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Also tagged Feature Selection</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">The Curse of Dimensionality</div><div class="ui-body ui-clamp2 u-lineClamp2 u-textOverflowEllipsis u-maxHeight2LineHeightTighter">One of the new characteristics that separates modern data science from much of the earlier work is the large number of features used…</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@scottdandrews" data-action="show-user-card" data-action-value="c3fa2cefdb18" data-action-type="hover" data-user-id="c3fa2cefdb18" dir="auto"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/1_dmbNkD5D-u45r44go_cf0g.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Scott Andrews"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@scottdandrews?source=placement_card_footer_grid---------2-43" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-43" data-action-value="c3fa2cefdb18" data-action-type="hover" data-user-id="c3fa2cefdb18" dir="auto">Scott Andrews</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="3 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="d1e7de432df3" data-is-label-padded="true" data-source="placement_card_footer_grid-----d1e7de432df3----2-43----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="d1e7de432df3" data-action-type="long-press" data-action-source="placement_card_footer_grid-----d1e7de432df3----2-43----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="d1e7de432df3">2</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="d1e7de432df3" data-action-source="placement_card_footer_grid-----d1e7de432df3----2-43----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container responsesStream-title u-paddingTop15"><div class="row"><header class="heading"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="responsesStream-editor cardChromeless u-marginBottom20 u-paddingLeft20 u-paddingRight20 js-responsesStreamEditor"><div class="inlineNewPostControl js-inlineNewPostControl" data-action-scope="_actionscope_6"><div class="inlineEditor is-collapsed is-postEditMode js-inlineEditor" data-action="focus-editor"><div class="u-paddingTop20 js-block js-inlineEditorContent"><div class="inlineEditor-header"><div class="inlineEditor-avatar u-paddingRight20"><div class="avatar u-inline"><img src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/0_P-t7h_lDOjJiWVxI(1)" class="avatar-image u-size36x36 u-xs-size32x32" alt="陈辰"></div></div><div class="inlineEditor-headerContent"><div class="inlineEditor-placeholder js-inlineEditorPrompt">Write a response…</div><div class="inlineEditor-author u-accentColor--textNormal">陈辰</div></div></div></div></div></div></div><div class="responsesStream js-responsesStream"></div><div class="container js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-sizeFullWidth u-marginVertical20 u-heightAuto" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1000 js-postLeftSidebar"><div class="u-foreground u-top0 u-sm-hide u-marginLeftNegative12 js-postShareWidget u-transition--fadeIn300 u-fixed" data-scroll="fixed" style="transform: translateY(150px);"><ul><li class="u-textAlignCenter u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexColumn u-marginBottom10 u-width60" data-post-id="8b94f870706a" data-is-icon-29px="true" data-is-vertical="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_share_widget-----8b94f870706a---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal" data-action="multivote" data-action-value="8b94f870706a" data-action-type="long-press" data-action-source="post_share_widget-----8b94f870706a---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" viewBox="0 0 33 33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Spring u-background--brandSageLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="8b94f870706a"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-flexOrderNegative1 u-height20 u-marginBottom7"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-block u-marginAuto" data-action="show-recommends" data-action-value="8b94f870706a">1.7K</button></span></div></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></li><li class="u-textAlignCenter u-marginVertical10"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="8b94f870706a" data-action-source="post_share_widget-----8b94f870706a---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li></ul></div></aside><div class="postActionsBar uiScale uiScale-ui--regular uiScale-caption--regular js-postActionsBar is-visible"><div class="postActionsBar-container container"><div class="postActionsBar-content row u-boxShadowNormal js-postActionsBarContent"><div class="postActions"><div class="u-height44 u-maxWidth1250 u-marginAuto u-relative"><div class="u-absolute u-right0 u-marginRight20 u-sizeFullHeight u-flexCenter"><div class="u-floatLeft"><div class="u-floatRight buttonSet"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="respond" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="scroll-to-responses">2</button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-hide" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_bar"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="8b94f870706a" data-action-source="post_actions_bar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></div></div><div class="u-xs-hide u-width255 u-height44 u-floatLeft js-readNextMetabarRight"><div class="streamItem streamItem--placementCardMetabar js-streamItem"><div class="readNextPromo readNextPromo--chromeless"><div class="buttonSet-separator u-floatLeft"></div><div class="js-trackedPost" data-post-id="4cf2614ae791" data-source="read_next_metabar----------44" data-tracking-context="placement" data-scroll="fixed"><a class="link link--noUnderline u-baseColor--link u-block" href="https://medium.com/@arseny_info/im-an-impostor-aren-t-i-4cf2614ae791?source=read_next_metabar----------44"><div class="uiScale uiScale-ui--small uiScale-caption--small readNextPromo-postInfo"><div class="ui-caption u-marginTop5 readNextPromo-callToAction u-accentColor--textNormal u-uiTextBold">Next story</div><h4 class="ui-h4 readNextPromo-postTitle u-block u-noWrapWithEllipsis u-contentSansBold">I’m An Impostor, Aren’t I?</h4></div></a></div></div></div></div></div><div class="container u-maxWidth740 u-sizeFullHeight u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="8b94f870706a" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_actions_bar-----8b94f870706a---------------------clap_footer"><div class="u-relative u-foreground"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton" data-action="multivote" data-action-value="8b94f870706a" data-action-type="long-press" data-action-source="post_actions_bar-----8b94f870706a---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><g fill-rule="evenodd"><path d="M13.739 1l.761 2.966L15.261 1z"></path><path d="M16.815 4.776l1.84-2.551-1.43-.471z"></path><path d="M10.378 2.224l1.84 2.551-.408-3.022z"></path><path d="M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><g fill-rule="evenodd"><path d="M13.738 1l.762 2.966L15.262 1z"></path><path d="M18.634 2.224l-1.432-.47-.408 3.022z"></path><path d="M11.79 1.754l-1.431.47 1.84 2.552z"></path><path d="M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z"></path></g></svg></span></span></button></div><span class="u-textAlignCenter u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="8b94f870706a">1.7K</button></span></div></div></div></div></div></div></div></div><style class="js-collectionStyle">
.u-accentColor--borderLight {border-color: #02B875 !important;}
.u-accentColor--borderNormal {border-color: #02B875 !important;}
.u-accentColor--borderDark {border-color: #1C9963 !important;}
.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #02B875 !important;}
.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #02B875 !important;}
.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #1C9963 !important;}
.u-accentColor--textNormal {color: #1C9963 !important;}
.u-accentColor--hoverTextNormal:hover {color: #1C9963 !important;}
.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #1C9963 !important;}
.u-accentColor--textDark {color: #1C9963 !important;}
.u-accentColor--backgroundLight {background-color: #02B875 !important;}
.u-accentColor--backgroundNormal {background-color: #02B875 !important;}
.u-accentColor--backgroundDark {background-color: #1C9963 !important;}
.u-accentColor--buttonDark {border-color: #1C9963 !important; color: #1C9963 !important;}
.u-accentColor--buttonDark:hover {border-color: #1C9963 !important;}
.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #1C9963 !important; fill: #1C9963 !important;}
.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #02B875 !important; color: #1C9963 !important;}
.u-accentColor--buttonNormal:hover {border-color: #1C9963 !important;}
.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #02B875 !important; fill: #02B875 !important;}
.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #1C9963 !important; border-color: #1C9963 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #02B875 !important; border-color: #02B875 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #1C9963 !important;}
.u-accentColor--highlightFaint {background-color: rgba(233, 253, 240, 1) !important;}
.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(125, 255, 179, 1) !important;}
.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(233, 253, 240, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(233, 253, 240, 1), rgba(233, 253, 240, 1));}
.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(173, 255, 207, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(173, 255, 207, 1), rgba(173, 255, 207, 1));}
.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(125, 255, 179, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}
.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(125, 255, 179, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}
.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(125, 255, 179, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(125, 255, 179, 1), rgba(125, 255, 179, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class="js-collectionStyleConstant">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}
.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(255, 255, 255, 0.4) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(255, 255, 255, 0.4980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}
.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}
.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(1) {stroke: none !important; fill: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(2) {stroke: none !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(3) {stroke: none !important; fill: rgba(0, 0, 0, 0.4) !important;}
.u-resetSpectrum .svgIcon--logoNew path:nth-child(4) {stroke: none !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style><div class="highlightMenu" data-action-scope="_actionscope_3" style="left: 753px; top: 141px;"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="quote" data-action-source="quote_menu--------------------------highlight_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="quote-respond" data-action-source="quote_menu--------------------------respond_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="twitter" data-action-source="quote_menu" data-skip-onboarding="true"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="highlight" data-action-source="quote_menu--------------------------privatenote_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"33768-9b43f89","currentUser":{"userId":"a988255767e5","username":"0109chenchen","name":"陈辰","email":"0109chenchen@gmail.com","imageId":"0*P-t7h_lDOjJiWVxI.","twitterScreenName":"0109chenchen","createdAt":1463006784997,"isVerified":true,"subscriberEmail":"","onboardingStatus":1,"googleAccountId":"104969029311726520174","googleEmail":"0109chenchen@gmail.com","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":true,"hightowerLastLockedAt":0},"currentUserHasUnverifiedEmail":false,"isAuthenticated":true,"isCurrentUserVerified":true,"language":"zh-cn","mediumTwitterScreenName":"medium","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.8adUEAltnSo_9je5Uu_UfQ.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.8XzrsTBv650SH5jN4fxn-w.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.mGIs_7TGlpyW6I49DIf2eQ.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.eE5K1hr2vcT7pv9sJtqJUw.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.SYOh_phDGF7bEzLN40m0NQ.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.0wfedgTNnhCPCkt5jNAAMA.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.TIOR5g3WqgmDbN5i4nuTPQ.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.0rX7DYaAn0NL2uJ0ymiXkQ.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.jphKZ0rslOE3AQ5oohSpdg.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.4EHu8x518JAA9YAXlyGILA.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.BeUE5gTl17lA5D59owt5TA.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1526797312077:99f38a7d95a2","useragent":{"browser":"chrome","family":"chrome","os":"mac","version":66,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":5,"isSearchBot":false,"isSyndicationBot":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"enable_export_members":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","enable_sms":true,"disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"disable_followed_tag_fan_out":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"enable_sequence_carousel":true,"enable_multirecommends":true,"enable_post_monger_v2":true,"enable_post_monger_v3":true,"enable_hightower_editor_copy_v2":true,"enable_user_post_metering":true,"max_premium_content_per_user_under_metering":3,"tag_intercom_user_on_metering_count":3,"enable_topic_writer_onboarding":true,"enable_strong_graph_chp_reorder":true,"enable_unsplash_images":true,"enable_top_stories_for_you":true,"enable_ios_member_post_labeling":true,"enable_lite_profile":true,"enable_li_search_collection":true,"enable_homepage_remodel":true,"enable_signin_wall_custom_domain":true,"enable_standalone_profile_edit_page":true,"enable_standalone_user_follow_pages":true,"enable_post_footer_copy":true,"app_download_email_template":"control","enable_topic_lifecycle_email":true,"enable_marketing_emails":true,"enable_curation_post_locking":true,"ios_hide_avatars_on_home":true,"raise_editors_picks_digest":"control","android_disable_author_avatars":true,"enable_persistent_user_id_for_dnt":true,"enable_truncated_rss_for_tags_and_topics":true,"enable_ios_related_reads_api_change":true,"enable_ios_related_reads_ui_large":true,"enable_ios_responses_collapsed":true,"enable_latin_font_subset":true,"enable_creator_landing_updates":true},"xsrfToken":"ILm3dIW5nR7c","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/si/latin/e/sb/latin/e/sbi/latin/e/ssr/latin/e/ssb/latin/e/ai/latin/e/mkt/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/e/mkt/latin/m2.css"},{"id":12,"url":"https://glyph.medium.com/css/e/sr/latin/e/si/latin/e/sb/latin/e/sbi/latin/e/ssr/latin/e/ssb/latin/e/ai/latin/e/mkt/latin/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"},{"id":10,"url":"https://glyph.medium.com/css/e/mkt/latin/elv8.css"},{"id":13,"url":"https://glyph.medium.com/css/e/sr/latin/e/si/latin/e/sb/latin/e/sbi/latin/e/ssr/latin/e/ssb/latin/e/mkt/latin/e/elv8r/latin/elv8.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"3728be6b4235ff02\",\"ot-tracer-traceid\":\"7e81ef9d0c699157\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email","user_friends"],"connect":["public_profile","email","user_friends"],"login":["public_profile","email","user_friends"],"share":["public_profile","email","user_friends","publish_actions"]}},"mailingListArchiveUploadSizeMb":2,"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com","buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":1,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"li_post_page","type":0,"url":"www.calendly.com"},{"promptId":"li_home_page","type":1,"url":"mediumuserfeedback.typeform.com/to/GcFjEO"},{"promptId":"li_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","paypalClientMode":"production","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"CA","bypassMeter":false}
// ]]></script><script charset="UTF-8" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/main-base.bundle.8adUEAltnSo_9je5Uu_UfQ.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"8b94f870706a","versionId":"f3c2e7dbc78b","creatorId":"e64a1ed25336","creator":{"userId":"e64a1ed25336","name":"Arseny Kravchenko","username":"arseny_info","createdAt":1395741064924,"lastPostCreatedAt":1520804193033,"imageId":"1*uf2wBS0ahK7CUnFXEFM63g.jpeg","backgroundImageId":"","bio":"Sceptical data cruncher.","twitterScreenName":"arseny_info","socialStats":{"userId":"e64a1ed25336","usersFollowedCount":80,"usersFollowedByCount":256,"type":"SocialStats"},"social":{"userId":"a988255767e5","targetUserId":"e64a1ed25336","type":"Social"},"facebookAccountId":"","allowNotes":1,"isNsfw":false,"type":"User"},"homeCollection":{"id":"b76595fb6cfc","name":"Open Machine Learning Course","slug":"open-machine-learning-course","tags":["MACHINE LEARNING","DATA SCIENCE","DATA ANALYSIS","EDUCATION","KAGGLE"],"creatorId":"5572ec600139","description":"A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.","shortDescription":"A series of articles on basics of Machine Learning.","image":{"imageId":"1*b5pfoCQz20rjh79OPSQWQg.jpeg","filter":"","backgroundSize":"","originalWidth":271,"originalHeight":271,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":1490,"activeAt":1523869737051},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":true,"isNewsletterSubscribed":true,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*MxsqShnPs3RXMScwl5HhsQ.jpeg","filter":"","backgroundSize":"","originalWidth":1479,"originalHeight":822,"strategy":"resample","height":0,"width":0},"twitterUsername":"odsai_en","facebookPageName":"DataChallenges","publicEmail":"yury.kashnitsky@gmail.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":6,"number":10,"postIds":[]}}],"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF02B875","point":0},{"color":"#FF00AB6B","point":0.1},{"color":"#FF1C9963","point":0.2},{"color":"#FF092E20","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFE9FDF0","point":0.1},{"color":"#FFE2FAEE","point":0.2},{"color":"#FFADFFCF","point":0.6},{"color":"#FF7DFFB3","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"},"homeCollectionId":"b76595fb6cfc","title":"Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection","detectedLanguage":"en","latestVersion":"f3c2e7dbc78b","latestPublishedVersion":"f3c2e7dbc78b","hasUnpublishedEdits":false,"latestRev":2710,"createdAt":1520804193033,"updatedAt":1526512748464,"acceptedAt":0,"firstPublishedAt":1520852461240,"latestPublishedAt":1525725927796,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"In this course, we have already seen several key machine learning algorithms. However, before moving on to the more fancy ones, we’d like…","bodyModel":{"paragraphs":[{"name":"0152","type":3,"text":"Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection","markups":[]},{"name":"23d8","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*NZRVMpxF8oSBwumh.","originalWidth":454,"originalHeight":491,"isFeatured":true}},{"name":"a9db","type":1,"text":"In this course, we have already seen several key machine learning algorithms. However, before moving on to the more fancy ones, we’d like to take a small detour and talk about data preparation. The well-known concept of “garbage in — garbage out” applies 100% to any task in machine learning. Any experienced professional can recall numerous times when a simple model trained on high-quality data was proven to be better than a complicated multi-model ensemble built on data that wasn’t clean.","markups":[]},{"name":"de9e","type":1,"text":"To start, I wanted to review three similar but different tasks:","markups":[]},{"name":"a8e8","type":9,"text":"feature extraction and feature engineering: transformation of raw data into features suitable for modeling;","markups":[{"type":1,"start":0,"end":18},{"type":1,"start":23,"end":42}]},{"name":"7a33","type":9,"text":"feature transformation: transformation of data to improve the accuracy of the algorithm;","markups":[{"type":1,"start":0,"end":22}]},{"name":"6dc8","type":9,"text":"feature selection: removing unnecessary features.","markups":[{"type":1,"start":0,"end":17}]},{"name":"cd97","type":1,"text":"This article will contain almost no math, but there will be a fair amount of code. (Jupyter version). Some examples will use the dataset from Renthop company, which is used in the Two Sigma Connect: Rental Listing Inquiries Kaggle competition. In this task, you need to predict the popularity of a new rental listing, i.e. classify the listing into three classes: ['low', 'medium' , 'high']. To evaluate the solutions, we will use the log loss metric (the smaller, the better). Those who do not have a Kaggle account, will have to register; you will also need to accept the rules of the competition in order to download the data.","markups":[{"type":10,"start":364,"end":390},{"type":3,"start":84,"end":91,"href":"https://github.com/Yorko/mlcourse_open/blob/master/jupyter_english/topic06_features/topic6_feature_engineering_feature_selection.ipynb","title":"","rel":"","anchorType":0},{"type":3,"start":180,"end":242,"href":"https://www.kaggle.com/c/two-sigma-connect-rental-listing-inquiries","title":"","rel":"noopener","anchorType":0}]},{"name":"bd66","type":8,"text":"import json\nimport pandas as pd\n\n# Let's load the dataset from Renthop right away\nwith open('train.json', 'r') as raw_data:\n    data = json.load(raw_data)\n    df = pd.DataFrame(data)","markups":[{"type":1,"start":0,"end":6},{"type":1,"start":7,"end":11},{"type":1,"start":12,"end":18},{"type":1,"start":19,"end":25},{"type":1,"start":26,"end":28},{"type":1,"start":29,"end":31},{"type":1,"start":82,"end":86},{"type":1,"start":111,"end":113},{"type":2,"start":33,"end":81}]},{"name":"6e9a","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*9hnjnSWUMMwg7AkfceIeTA.png","originalWidth":593,"originalHeight":343}},{"name":"b52b","type":3,"text":"Article outline","markups":[]},{"name":"9068","type":1,"text":"1. Feature Extraction\n1.1. Texts\n1.2. Images\n1.3. Geospatial data\n1.4. Date and time\n1.5. Time series, web, etc.","markups":[]},{"name":"0f7f","type":1,"text":"2. Feature transformations\n2.1. Normalization and changing distribution\n2.2. Interactions\n2.3. Filling in the missing values","markups":[]},{"name":"ae6d","type":1,"text":"3. Feature selection\n3.1. Statistical approaches\n3.2. Selection by modeling\n3.3. Grid search","markups":[]},{"name":"68c4","type":3,"text":"1. Feature Extraction","markups":[]},{"name":"931e","type":1,"text":"In practice, data rarely comes in the form of ready-to-use matrices. That's why every task begins with feature extraction. Sometimes, it can be enough to read the csv file and convert it into numpy.array, but this is a rare exception. Let's look at some of the popular types of data from which features can be extracted.","markups":[{"type":10,"start":192,"end":203}]},{"name":"5195","type":3,"text":"1.1. Texts","markups":[]},{"name":"3425","type":1,"text":"Text is a type of data that can come in different formats; there are so many text processing methods that cannot fit in a single article. Nevertheless, we will review the most popular ones.","markups":[]},{"name":"7e48","type":1,"text":"Before working with text, one must tokenize it. Tokenization implies splitting the text into units (hence, tokens). Most simply, tokens are just the words. But splitting by word can lose some of the meaning -- \"Santa Barbara\" is one token, not two, but \"rock'n'roll\" should not be split into two tokens. There are ready-to-use tokenizers that take into account peculiarities of the language, but they make mistakes as well, especially when you work with specific sources of text (newspapers, slang, misspellings, typos).","markups":[]},{"name":"6d48","type":1,"text":"After tokenization, you will normalize the data. For text, this is about stemming and/or lemmatization; these are similar processes used to process different forms of a word. One can read about the difference between them here.","markups":[{"type":3,"start":222,"end":226,"href":"http://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html","title":"","rel":"","anchorType":0}]},{"name":"f6c3","type":1,"text":"So, now that we have turned the document into a sequence of words, we can represent it with vectors. The easiest approach is called Bag of Words: we create a vector with the length of the dictionary, compute the number of occurrences of each word in the text, and place that number of occurrences in the appropriate position in the vector. The process described looks simpler in code:","markups":[]},{"name":"f44c","type":8,"text":"from functools import reduce \nimport numpy as np\n\ntexts = [['i', 'have', 'a', 'cat'], \n        ['he', 'have', 'a', 'dog'], \n        ['he', 'and', 'i', 'have', 'a', 'cat', 'and', 'a', 'dog']]\n\ndictionary = list(enumerate(set(list(reduce(lambda x, y: x + y, texts)))))\n\ndef vectorize(text): \n    vector = np.zeros(len(dictionary)) \n    for i, word in dictionary: \n        num = 0 \n        for w in text: \n            if w == word: \n                num += 1 \n        if num: \n            vector[i] = num \n    return vector\n\nfor t in texts: \n    print(vectorize(t))","markups":[{"type":1,"start":0,"end":4},{"type":1,"start":5,"end":14},{"type":1,"start":15,"end":21},{"type":1,"start":30,"end":36},{"type":1,"start":37,"end":42},{"type":1,"start":43,"end":45},{"type":1,"start":46,"end":48},{"type":1,"start":236,"end":242},{"type":1,"start":268,"end":271},{"type":1,"start":334,"end":337},{"type":1,"start":346,"end":348},{"type":1,"start":387,"end":390},{"type":1,"start":393,"end":395},{"type":1,"start":415,"end":417},{"type":1,"start":464,"end":466},{"type":1,"start":506,"end":512},{"type":1,"start":521,"end":524},{"type":1,"start":527,"end":529},{"type":1,"start":542,"end":547}]},{"name":"f022","type":1,"text":"Expected result:","markups":[]},{"name":"0ac8","type":8,"text":"[0. 1. 0. 1. 1. 0. 1.]\n[0. 1. 1. 0. 1. 1. 0.]\n[2. 1. 1. 1. 2. 1. 1.]","markups":[]},{"name":"aa58","type":1,"text":"Here is an illustration of the process:","markups":[]},{"name":"13d6","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*XAUdLzs_GQ4YWjA3dk5Geg.png","originalWidth":779,"originalHeight":446}},{"name":"202b","type":1,"text":"This is an extremely naive implementation. In practice, you need to consider stop words, the maximum length of the dictionary, more efficient data structures (usually text data is converted to a sparse vector), etc.","markups":[]},{"name":"e741","type":1,"text":"When using algorithms like Bag of Words, we lose the order of the words in the text, which means that the texts \"i have no cows\" and \"no, i have cows\" will appear identical after vectorization when, in fact, they have the opposite meaning. To avoid this problem, we can revisit our tokenization step and use N-grams (the sequence of N consecutive tokens) instead.","markups":[{"type":2,"start":321,"end":329}]},{"name":"08e8","type":8,"text":"In : from sklearn.feature_extraction.text import CountVectorizer\n\nIn : vect = CountVectorizer(ngram_range=(1,1))\n\nIn : vect.fit_transform(['no i have cows', 'i have no cows']).toarray() \nOut: \narray([[1, 1, 1],\n      [1, 1, 1]], dtype=int64)\n\nIn : vect.vocabulary_ \nOut: {'cows': 0, 'have': 1, 'no': 2}\n\nIn : vect = CountVectorizer(ngram_range=(1,2))\n\nIn : vect.fit_transform(['no i have cows', 'i have no cows']).toarray() \nOut: \narray([[1, 1, 1, 0, 1, 0, 1], \n      [1, 1, 0, 1, 1, 1, 0]], dtype=int64)\n\nIn : vect.vocabulary_ \nOut: {'cows': 0, \n      'have': 1,\n      'have cows': 2,\n      'have no': 3,\n      'no': 4,\n      'no cows': 5,\n      'no have': 6}","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":41},{"type":1,"start":42,"end":48}]},{"name":"8c03","type":1,"text":"Also note that one does not have to use only words. In some cases, it is possible to generate N-grams of characters. This approach would be able to account for similarity of related words or handle typos.","markups":[]},{"name":"1aa8","type":8,"text":"from scipy.spatial.distance import euclidean\nfrom sklearn.feature_extraction.text import CountVectorizer\n\nvect = CountVectorizer(ngram_range=(3,3), analyzer='char_wb')\n\nn1, n2, n3, n4 = vect.fit_transform(['andersen', 'petersen', 'petrov', 'smith']).toarray()\n\neuclidean(n1, n2), euclidean(n2, n3), euclidean(n3, n4)\n# (2.8284271247461903, 3.1622776601683795, 3.3166247903554)","markups":[{"type":1,"start":0,"end":4},{"type":1,"start":5,"end":27},{"type":1,"start":28,"end":34},{"type":1,"start":45,"end":49},{"type":1,"start":50,"end":81},{"type":1,"start":82,"end":88}]},{"name":"6860","type":1,"text":"Adding onto the Bag of Words idea: words that are rarely found in the corpus (in all the documents of this dataset) but are present in this particular document might be more important. Then it makes sense to increase the weight of more domain-specific words to separate them out from common words. This approach is called TF-IDF (term frequency-inverse document frequency), which cannot be written in a few lines, so you should look into the details in references such as this wiki. The default option is as follows:","markups":[{"type":3,"start":472,"end":481,"href":"https://en.wikipedia.org/wiki/Tf%E2%80%93idf","title":"","rel":"","anchorType":0}]},{"name":"8221","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*0GBn_uP9KZNHLkvUXu4hgA.png","originalWidth":362,"originalHeight":179}},{"name":"f35a","type":1,"text":"Analogs of Bag of Words can be found outside of text problems e.g. bag of sites in the Catch Me If You Can competition, bag of apps, bag of events, etc.","markups":[{"type":3,"start":87,"end":118,"href":"https://inclass.kaggle.com/c/catch-me-if-you-can-intruder-detection-through-webpage-session-tracking","title":"","rel":"","anchorType":0},{"type":3,"start":120,"end":131,"href":"https://www.kaggle.com/xiaoml/talkingdata-mobile-user-demographics/bag-of-app-id-python-2-27392","title":"","rel":"","anchorType":0},{"type":3,"start":133,"end":146,"href":"http://www.interdigital.com/download/58540a46e3b9659c9f000372","title":"","rel":"","anchorType":0}]},{"name":"9f86","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*XAUdLzs_GQ4YWjA3dk5Geg.png","originalWidth":779,"originalHeight":446}},{"name":"eff9","type":1,"text":"Using these algorithms, it is possible to obtain a working solution for a simple problem, which can serve as a baseline. However, for those who do not like the classics, there are new approaches. The most popular method in the new wave is Word2Vec, but there are a few alternatives as well (GloVe, Fasttext, etc.).","markups":[]},{"name":"4be9","type":1,"text":"Word2Vec is a special case of the word embedding algorithms. Using Word2Vec and similar models, we can not only vectorize words in a high-dimensional space (typically a few hundred dimensions) but also compare their semantic similarity. This is a classic example of operations that can be performed on vectorized concepts: king - man + woman = queen.","markups":[]},{"name":"3ed6","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*K5X4N-MJKt8FGFtrTHwidg.gif","originalWidth":336,"originalHeight":336}},{"name":"78fc","type":1,"text":"It is worth noting that this model does not comprehend the meaning of the words but simply tries to position the vectors such that words used in common context are close to each other. If this is not taken into account, a lot of fun examples will come up.","markups":[]},{"name":"8369","type":1,"text":"Such models need to be trained on very large datasets in order for the vector coordinates to capture the semantics. A pretrained model for your own tasks can be downloaded here.","markups":[{"type":3,"start":172,"end":176,"href":"https://github.com/3Top/word2vec-api#where-to-get-a-pretrained-models","title":"","rel":"","anchorType":0}]},{"name":"96cd","type":1,"text":"Similar methods are applied in other areas such as bioinformatics. An unexpected application is food2vec. You can probably think of a few other fresh ideas; the concept is universal enough.","markups":[{"type":3,"start":96,"end":104,"href":"https://jaan.io/food2vec-augmented-cooking-machine-intelligence/","title":"","rel":"","anchorType":0}]},{"name":"295c","type":3,"text":"1.2. Images","markups":[]},{"name":"e2c8","type":1,"text":"Working with images is easier and harder at the same time. It is easier because it is possible to just use one of the popular pretrained networks without much thinking but harder because, if you need to dig into the details, you may end up going really deep. Let's start from the beginning.","markups":[]},{"name":"35f9","type":1,"text":"In a time when GPUs were weaker and the \"renaissance of neural networks\" had not happened yet, feature generation from images was its own complex field. One had to work at a low level, determining corners, borders of regions, color distributions statistics, and so on. Experienced specialists in computer vision could draw a lot of parallels between older approaches and neural networks; in particular, convolutional layers in today's networks are similar to Haar cascades. If you are interested in reading more, here are a couple of links to some interesting libraries: skimage and SimpleCV.","markups":[{"type":10,"start":571,"end":578},{"type":10,"start":583,"end":591},{"type":3,"start":459,"end":472,"href":"https://habrahabr.ru/post/208092/","title":"","rel":"","anchorType":0},{"type":3,"start":571,"end":578,"href":"http://scikit-image.org/docs/stable/api/skimage.feature.html","title":"","rel":"","anchorType":0},{"type":3,"start":583,"end":591,"href":"http://simplecv.readthedocs.io/en/latest/SimpleCV.Features.html","title":"","rel":"","anchorType":0}]},{"name":"d1de","type":1,"text":"Often for problems associated with images, a convolutional neural network is used. You do not have to come up with the architecture and train a network from scratch. Instead, download a pretrained state-of-the-art network with the weights from public sources. Data scientists often do so-called fine-tuning to adapt these networks to their needs by \"detaching\" the last fully connected layers of the network, adding new layers chosen for a specific task, and then training the network on new data. If your task is to just vectorize the image (for example, to use some non-network classifier), you only need to remove the last layers and use the output from the previous layers:","markups":[]},{"name":"ecff","type":8,"text":"from keras.applications.resnet50 import ResNet50, preprocess_input\nfrom keras.preprocessing import image \nfrom scipy.misc import face \nimport numpy as np\n\nresnet_settings = {'include_top': False, 'weights': 'imagenet'}\nresnet = ResNet50(**resnet_settings)\n\nimg = image.array_to_img(face())\n\n# What a cute raccoon!\n\nimg = img.resize((224, 224))\n\n# In real life, you may need to pay more attention to resizing\n\nx = image.img_to_array(img) \nx = np.expand_dims(x, axis=0)\nx = preprocess_input(x)\n\n# Need an extra dimension because model is designed to work with an array of images - i.e. tensor shaped (batch_size, width, height, n_channels)\n\nfeatures = resnet.predict(x)","markups":[{"type":1,"start":0,"end":4},{"type":1,"start":5,"end":32},{"type":1,"start":33,"end":39},{"type":1,"start":67,"end":71},{"type":1,"start":72,"end":91},{"type":1,"start":92,"end":98},{"type":1,"start":106,"end":110},{"type":1,"start":111,"end":121},{"type":1,"start":122,"end":128},{"type":1,"start":135,"end":141},{"type":1,"start":142,"end":147},{"type":1,"start":148,"end":150},{"type":1,"start":151,"end":153},{"type":2,"start":291,"end":313},{"type":2,"start":345,"end":407},{"type":2,"start":493,"end":637}]},{"name":"2a28","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*Iw_cKFwLkTVO2SPrOZU2rQ.png","originalWidth":1920,"originalHeight":907}},{"name":"2084","type":1,"text":"Here's a classifier trained on one dataset and adapted for a different one by \"detaching\" the last layer and adding a new one instead.","markups":[{"type":2,"start":0,"end":134}]},{"name":"3a54","type":1,"text":"Nevertheless, we should not focus too much on neural network techniques. Features generated by hand are still very useful: for example, for predicting the popularity of a rental listing, we can assume that bright apartments attract more attention and create a feature such as \"the average value of the pixel\". You can find some inspiring examples in the documentation of relevant libraries.","markups":[{"type":3,"start":371,"end":389,"href":"http://pillow.readthedocs.io/en/3.1.x/reference/ImageStat.html","title":"","rel":"","anchorType":0}]},{"name":"c4b8","type":1,"text":"If there is text on the image, you can read it without unraveling a complicated neural network. For example, check out pytesseract.","markups":[{"type":10,"start":119,"end":130},{"type":3,"start":119,"end":130,"href":"https://github.com/madmaze/pytesseract","title":"","rel":"","anchorType":0}]},{"name":"b77c","type":8,"text":"In : import pytesseract\n\nIn : from PIL import Image\n\nIn : import requests\n\nIn : from io import BytesIO\n\nIn : img = 'http://ohscurrent.org/wp-content/uploads/2015/09/domus-01-google.jpg'\n\n##### Just a random picture from search\n\nIn : img = requests.get(img) \n...: img = Image.open(BytesIO(img.content)) \n...: text = pytesseract.image_to_string(img) \n...:\n\nIn : text \nOut: 'Google'","markups":[{"type":1,"start":5,"end":11},{"type":1,"start":12,"end":23},{"type":1,"start":30,"end":34},{"type":1,"start":35,"end":38},{"type":1,"start":39,"end":45},{"type":1,"start":58,"end":64},{"type":1,"start":65,"end":73},{"type":1,"start":80,"end":84},{"type":1,"start":85,"end":87},{"type":1,"start":88,"end":94},{"type":2,"start":187,"end":226}]},{"name":"d6f2","type":1,"text":"One must understand that pytesseract is not a solution for everything.","markups":[{"type":10,"start":25,"end":36}]},{"name":"06a7","type":8,"text":"##### This time we take a picture from Renthop\n\nIn : img = requests.get('https://photos.renthop.com/2/8393298_6acaf11f030217d05f3a5604b9a2f70f.jpg') \n...: img = Image.open(BytesIO(img.content)) \n...: pytesseract.image_to_string(img) \n...:\n\nOut: 'Cunveztible to 4}»'","markups":[{"type":2,"start":0,"end":46}]},{"name":"e24d","type":1,"text":"Another case where neural networks cannot help is extracting features from meta-information. For images, EXIF stores many useful meta-information: manufacturer and camera model, resolution, use of the flash, geographic coordinates of shooting, software used to process image and more.","markups":[]},{"name":"cd89","type":3,"text":"1.3. Geospatial data","markups":[]},{"name":"d9a4","type":1,"text":"Geographic data is not so often found in problems, but it is still useful to master the basic techniques for working with it, especially since there are quite a number of ready-to-use solutions in this field.","markups":[]},{"name":"708d","type":1,"text":"Geospatial data is often presented in the form of addresses or coordinates of (Latitude, Longitude). Depending on the task, you may need two mutually-inverse operations: geocoding (recovering a point from an address) and reverse geocoding (recovering an address from a point). Both operations are accessible in practice via external APIs from Google Maps or OpenStreetMap. Different geocoders have their own characteristics, and the quality varies from region to region. Fortunately, there are universal libraries like geopy that act as wrappers for these external services.","markups":[{"type":10,"start":519,"end":524},{"type":3,"start":519,"end":524,"href":"https://github.com/geopy/geopy","title":"","rel":"","anchorType":0}]},{"name":"3ea8","type":1,"text":"If you have a lot of data, you will quickly reach the limits of external API. Besides, it is not always the fastest to receive information via HTTP. Therefore, it is necessary to consider using a local version of OpenStreetMap.","markups":[]},{"name":"c417","type":1,"text":"If you have a small amount of data, enough time, and no desire to extract fancy features, you can use reverse_geocoder in lieu of OpenStreetMap:","markups":[{"type":10,"start":102,"end":118}]},{"name":"fcae","type":8,"text":"In : import reverse_geocoder as revgc\n\nIn : revgc.search((df.latitude, df.longitude)) \nLoading formatted geocoded file... \nOut: [OrderedDict([('lat', '40.74482'), \n                   ('lon', '-73.94875'), \n                   ('name', 'Long Island City'), \n                   ('admin1', 'New York'), \n                   ('admin2', 'Queens County'), \n                   ('cc', 'US')])]","markups":[{"type":1,"start":5,"end":11},{"type":1,"start":12,"end":28},{"type":1,"start":29,"end":31},{"type":1,"start":32,"end":37}]},{"name":"467f","type":1,"text":"When working with geoсoding, we must not forget that addresses may contain typos, which makes the data cleaning step necessary. Coordinates contain fewer misprints, but its position can be incorrect due to GPS noise or bad accuracy in places like tunnels, downtown areas, etc. If the data source is a mobile device, the geolocation may not be determined by GPS but by WiFi networks in the area, which leads to holes in space and teleportation. While traveling along in Manhattan, there can suddenly be a WiFi location from Chicago.","markups":[]},{"name":"ac19","type":6,"text":"WiFi location tracking is based on the combination of SSID and MAC-addresses, which may correspond to different points e.g. federal provider standardizes the firmware of routers up to MAC-address and places them in different cities. Even a company's move to another office with its routers can cause issues.","markups":[]},{"name":"40e0","type":1,"text":"The point is usually located among infrastructure. Here, you can really unleash your imagination and invent features based on your life experience and domain knowledge: the proximity of a point to the subway, the number of stories in the building, the distance to the nearest store, the number of ATMs around, etc. For any task, you can easily come up with dozens of features and extract them from various external sources. For problems outside an urban environment, you may consider features from more specific sources e.g. the height above sea level.","markups":[]},{"name":"453a","type":1,"text":"If two or more points are interconnected, it may be worthwhile to extract features from the route between them. In that case, distances (great circle distance and road distance calculated by the routing graph), number of turns with the ratio of left to right turns, number of traffic lights, junctions, and bridges will be useful. In one of my own tasks, I generated a feature called \"the complexity of the road\", which computed the graph-calculated distance divided by the GCD.","markups":[]},{"name":"c36f","type":3,"text":"1.4. Date and time","markups":[]},{"name":"52db","type":1,"text":"You would think that date and time are standardized because of their prevalence, but, nevertheless, some pitfalls remain.","markups":[]},{"name":"ab7e","type":1,"text":"Let's start with the day of the week, which are easy to turn into 7 dummy variables using one-hot encoding. In addition, we will also create a separate binary feature for the weekend called is_weekend.","markups":[{"type":10,"start":190,"end":200}]},{"name":"630a","type":8,"text":"df['dow'] = df['created'].apply(lambda x: x.date().weekday())\ndf['is_weekend'] = df['created'].apply(lambda x: 1 if x.date().weekday() in (5, 6) else 0)","markups":[{"type":1,"start":32,"end":38},{"type":1,"start":101,"end":107},{"type":1,"start":113,"end":115},{"type":1,"start":135,"end":137},{"type":1,"start":145,"end":149}]},{"name":"a6d6","type":1,"text":"Some tasks may require additional calendar features. For example, cash withdrawals can be linked to a pay day; the purchase of a metro card, to the beginning of the month. In general, when working with time series data, it is a good idea to have a calendar with public holidays, abnormal weather conditions, and other important events.","markups":[]},{"name":"771b","type":6,"text":"Q: What do Chinese New Year, the New York marathon, and the Trump inauguration have in common?","markups":[]},{"name":"f731","type":6,"text":"A: They all need to be put on the calendar of potential anomalies.","markups":[]},{"name":"e1cc","type":1,"text":"Dealing with hour (minute, day of the month ...) is not as simple as it seems. If you use the hour as a real variable, we slightly contradict the nature of data: 0\x3c23 while 0:00:00 02.01\x3e 01.01 23:00:00. For some problems, this can be critical. At the same time, if you encode them as categorical variables, you'll breed a large numbers of features and lose information about proximity -- the difference between 22 and 23 will be the same as the difference between 22 and 7.","markups":[{"type":10,"start":162,"end":166},{"type":10,"start":173,"end":202}]},{"name":"e331","type":1,"text":"There also exist some more esoteric approaches to such data like projecting the time onto a circle and using the two coordinates.","markups":[]},{"name":"1cb2","type":8,"text":"def make_harmonic_features(value, period=24):\n    value *= 2 * np.pi / period \n    return np.cos(value), np.sin(value)","markups":[{"type":1,"start":0,"end":3},{"type":1,"start":83,"end":89}]},{"name":"597c","type":1,"text":"This transformation preserves the distance between points, which is important for algorithms that estimate distance (kNN, SVM, k-means ...)","markups":[]},{"name":"650e","type":8,"text":"In : from scipy.spatial import distance\n\nIn : euclidean(make_harmonic_features(23), make_harmonic_features(1)) \nOut: 0.5176380902050424\n\nIn : euclidean(make_harmonic_features(9), make_harmonic_features(11)) \nOut: 0.5176380902050414\n\nIn : euclidean(make_harmonic_features(9), make_harmonic_features(21)) \nOut: 2.0","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":23},{"type":1,"start":24,"end":30}]},{"name":"4754","type":1,"text":"However, the difference between such coding methods is down to the third decimal place in the metric.","markups":[]},{"name":"0a96","type":3,"text":"1.5. Time series, web, etc.","markups":[]},{"name":"ae07","type":1,"text":"Regarding time series — we will not go into too much detail here (mostly due to my personal lack of experience), but I will point you to a useful library that automatically generates features for time series.","markups":[{"type":3,"start":137,"end":207,"href":"https://github.com/blue-yonder/tsfresh","title":"","rel":"","anchorType":0}]},{"name":"8fba","type":1,"text":"If you are working with web data, then you usually have information about the user's User Agent. It is a wealth of information. First, one needs to extract the operating system from it. Secondly, make a feature is_mobile. Third, look at the browser.","markups":[{"type":10,"start":211,"end":220}]},{"name":"b9fb","type":8,"text":"In : ua = 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/56.0.2924.76 Chrome/ \n...: 56.0.2924.76 Safari/537.36'\n\nIn : import user_agents\n\nIn : ua = user_agents.parse(ua)\n\nIn : ua.is_bot \nOut: False\n\nIn : ua.is_mobile \nOut: False\n\nIn : ua.is_pc \nOut: True\n\nIn : ua.os.family \nOut: 'Ubuntu'\n\nIn : ua.os.version \nOut: ()\n\nIn : ua.browser.family \nOut: 'Chromium'\n\nIn : ua.os.version \nOut: ()\n\nIn : ua.browser.version \nOut: (56, 0, 2924)","markups":[{"type":1,"start":159,"end":165},{"type":1,"start":166,"end":177}]},{"name":"355d","type":6,"text":"As in other domains, you can come up with your own features based on intuition about the nature of the data. At the time of this writing, Chromium 56 was new, but, after some time, only users who haven't rebooted their browser for a long time will have this version. In this case, why not introduce a feature called \"lag behind the latest version of the browser\"?","markups":[]},{"name":"1e21","type":1,"text":"In addition to the operating system and browser, you can look at the referrer (not always available), http_accept_language, and other meta information.","markups":[{"type":3,"start":102,"end":122,"href":"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language","title":"","rel":"","anchorType":0}]},{"name":"c0bb","type":1,"text":"The next useful piece of information is the IP-address, from which you can extract the country and possibly the city, provider, and connection type (mobile/stationary). You need to understand that there is a variety of proxy and outdated databases, so this feature can contain noise. Network administration gurus may try to extract even fancier features like suggestions for using VPN. By the way, the data from the IP-address is well combined with http_accept_language: if the user is sitting at the Chilean proxies and browser locale is ru_RU, something is unclean and worth a look in the corresponding column in the table (is_traveler_or_proxy_user).","markups":[{"type":10,"start":449,"end":469},{"type":10,"start":539,"end":544},{"type":10,"start":626,"end":651},{"type":3,"start":375,"end":384,"href":"https://habrahabr.ru/post/216295/","title":"","rel":"","anchorType":0}]},{"name":"a8c1","type":1,"text":"Any given area has so many specifics that it is too much for an individual to absorb completely. Therefore, I invite everyone to share their experiences and discuss feature extraction and generation in the comments section.","markups":[]},{"name":"d6b1","type":3,"text":"2. Feature transformations","markups":[]},{"name":"35fb","type":3,"text":"2.1. Normalization and changing distribution","markups":[]},{"name":"afe2","type":1,"text":"Monotonic feature transformation is critical for some algorithms and has no effect on others. This is one of the reasons for the increased popularity of decision trees and all its derivative algorithms (random forest, gradient boosting). Not everyone can or want to tinker with transformations, and these algorithms are robust to unusual distributions.","markups":[]},{"name":"6b28","type":1,"text":"There are also purely engineering reasons: np.log is a way of dealing with large numbers that do not fit in np.float64. This is an exception rather than a rule; often it's driven by the desire to adapt the dataset to the requirements of the algorithm. Parametric methods usually require a minimum of symmetric and unimodal distribution of data, which is not always given in real data. There may be more stringent requirements; recall our earlier article about linear models.","markups":[{"type":10,"start":43,"end":49},{"type":10,"start":108,"end":118},{"type":3,"start":434,"end":473,"href":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-4-linear-classification-and-regression-44a41b9b5220","title":"","rel":"","anchorType":0}]},{"name":"dca0","type":1,"text":"However, data requirements are imposed not only by parametric methods; K nearest neighbors will predict complete nonsense if features are not normalized e.g. when one distribution is located in the vicinity of zero and does not go beyond (-1, 1) while the other’s range is on the order of hundreds of thousands.","markups":[{"type":3,"start":71,"end":90,"href":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-3-classification-decision-trees-and-k-nearest-neighbors-8613c6b6d2cd","title":"","rel":"","anchorType":0}]},{"name":"b537","type":1,"text":"A simple example: suppose that the task is to predict the cost of an apartment from two variables — the distance from city center and the number of rooms. The number of rooms rarely exceeds 5 whereas the distance from city center can easily be in the thousands of meters.","markups":[]},{"name":"f112","type":1,"text":"The simplest transformation is Standard Scaling (or Z-score normalization):","markups":[]},{"name":"a947","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*l3GMKe44JVe8YKQi8ZdWgQ.png","originalWidth":142,"originalHeight":78}},{"name":"de0d","type":1,"text":"Note that Standard Scaling does not make the distribution normal in the strict sense.","markups":[]},{"name":"e55d","type":8,"text":"In : from sklearn.preprocessing import StandardScaler","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":31},{"type":1,"start":32,"end":38}]},{"name":"6637","type":8,"text":"In : from scipy.stats import beta","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":21},{"type":1,"start":22,"end":28}]},{"name":"0223","type":8,"text":"In : from scipy.stats import shapiro","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":21},{"type":1,"start":22,"end":28}]},{"name":"11f9","type":8,"text":"In : data = beta(1, 10).rvs(1000).reshape(-1, 1)","markups":[]},{"name":"9cd9","type":8,"text":"In : shapiro(data) \nOut: (0.8783774375915527, 3.0409122263582326e-27)","markups":[]},{"name":"5bee","type":8,"text":"# Value of the statistic, p-value","markups":[{"type":2,"start":0,"end":33}]},{"name":"9bfd","type":8,"text":"In : shapiro(StandardScaler().fit_transform(data)) \nOut: (0.8783774375915527, 3.0409122263582326e-27)","markups":[]},{"name":"e598","type":8,"text":"# With such p-value we'd have to reject the null hypothesis of normality of the data","markups":[{"type":2,"start":0,"end":84}]},{"name":"a5d3","type":1,"text":"But, to some extent, it protects against outliers:","markups":[]},{"name":"f39b","type":8,"text":"In : data = np.array([1, 1, 0, -1, 2, 1, 2, 3, -2, 4, 100]).reshape(-1, 1).astype(np.float64)","markups":[]},{"name":"46c5","type":8,"text":"In : StandardScaler().fit_transform(data) \nOut: \narray([[-0.31922662], \n       [-0.31922662],\n       [-0.35434155],\n       [-0.38945648],\n       [-0.28411169],\n       [-0.31922662],\n       [-0.28411169],\n       [-0.24899676],\n       [-0.42457141],\n       [-0.21388184],\n       [ 3.15715128]])","markups":[]},{"name":"28c2","type":8,"text":"In : (data – data.mean()) / data.std() \nOut: \narray([[-0.31922662], \n       [-0.31922662],\n       [-0.35434155],\n       [-0.38945648],\n       [-0.28411169],\n       [-0.31922662],\n       [-0.28411169],\n       [-0.24899676],\n       [-0.42457141],\n       [-0.21388184],\n       [ 3.15715128]])","markups":[]},{"name":"f2d8","type":1,"text":"Another fairly popular option is MinMax Scaling, which brings all the points within a predetermined interval (typically (0, 1)).","markups":[]},{"name":"499f","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*-MkabcMqk1Cm1HjCg59G_Q.png","originalWidth":282,"originalHeight":101}},{"name":"a448","type":8,"text":"In : from sklearn.preprocessing import MinMaxScaler","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":31},{"type":1,"start":32,"end":38}]},{"name":"b8f3","type":8,"text":"In : MinMaxScaler().fit_transform(data) \nOut: \narray([[ 0.02941176],\n       [ 0.02941176],\n       [ 0.01960784],\n       [ 0.00980392],\n       [ 0.03921569],\n       [ 0.02941176],\n       [ 0.03921569],\n       [ 0.04901961],\n       [ 0. ],\n       [ 0.05882353],\n       [ 1. ]])","markups":[]},{"name":"709e","type":8,"text":"In : (data – data.min()) / (data.max() – data.min()) \nOut: \narray([[ 0.02941176],\n       [ 0.02941176],\n       [ 0.01960784],\n       [ 0.00980392],\n       [ 0.03921569],\n       [ 0.02941176],\n       [ 0.03921569],\n       [ 0.04901961],\n       [ 0. ],\n       [ 0.05882353],\n       [ 1. ]])","markups":[]},{"name":"a6e5","type":1,"text":"StandardScaling and MinMax Scaling have similar applications and are often more or less interchangeable. However, if the algorithm involves the calculation of distances between points or vectors, the default choice is StandardScaling. But MinMax Scaling is useful for visualization by bringing features within the interval (0, 255).","markups":[]},{"name":"ae2c","type":1,"text":"If we assume that some data is not normally distributed but is described by the log-normal distribution, it can easily be transformed to a normal distribution:","markups":[{"type":3,"start":80,"end":103,"href":"https://ru.wikipedia.org/wiki/%D0%9B%D0%BE%D0%B3%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5","title":"","rel":"","anchorType":0}]},{"name":"f30e","type":8,"text":"In : from scipy.stats import lognorm","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":21},{"type":1,"start":22,"end":28}]},{"name":"2465","type":8,"text":"In : data = lognorm(s=1).rvs(1000)","markups":[]},{"name":"7a47","type":8,"text":"In : shapiro(data)\nOut: (0.05714237689971924, 0.0)","markups":[]},{"name":"234e","type":8,"text":"In : shapiro(np.log(data))\nOut: (0.9980740547180176, 0.3150389492511749)","markups":[]},{"name":"cd37","type":1,"text":"The lognormal distribution is suitable for describing salaries, price of securities, urban population, number of comments on articles on the internet, etc. However, to apply this procedure, the underlying distribution does not necessarily have to be lognormal; you can try to apply this transformation to any distribution with a heavy right tail. Furthermore, one can try to use other similar transformations, formulating their own hypotheses on how to approximate the available distribution to a normal. Examples of such transformations are Box-Cox transformation (logarithm is a special case of the Box-Cox transformation) or Yeo-Johnson transformation (extends the range of applicability to negative numbers). In addition, you can also try adding a constant to the feature — np.log (x + const).","markups":[{"type":10,"start":778,"end":796},{"type":3,"start":542,"end":564,"href":"https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html","title":"","rel":"","anchorType":0},{"type":3,"start":628,"end":654,"href":"https://gist.github.com/mesgarpour/f24769cd186e2db853957b10ff6b7a95","title":"","rel":"","anchorType":0}]},{"name":"ca29","type":1,"text":"In the examples above, we have worked with synthetic data and strictly tested normality using the Shapiro-Wilk test. Let’s try to look at some real data and test for normality using a less formal method — Q-Q plot. For a normal distribution, it will look like a smooth diagonal line, and visual anomalies should be intuitively understandable.","markups":[{"type":3,"start":205,"end":213,"href":"https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot","title":"","rel":"","anchorType":0}]},{"name":"34b4","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*AQtlE1Lo2GJjS6L2.","originalWidth":640,"originalHeight":480}},{"name":"d2b6","type":1,"text":"Q-Q plot for lognormal distribution","markups":[{"type":2,"start":0,"end":35}]},{"name":"69e8","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*_BEpFh1qqEn1yxvf.","originalWidth":640,"originalHeight":480}},{"name":"622c","type":1,"text":"Q-Q plot for the same distribution after taking the logarithm","markups":[{"type":2,"start":0,"end":61}]},{"name":"8648","type":8,"text":"# Let's draw plots!\nIn : import statsmodels.api as sm","markups":[{"type":1,"start":25,"end":31},{"type":1,"start":32,"end":47},{"type":1,"start":48,"end":50},{"type":1,"start":51,"end":53},{"type":2,"start":0,"end":19}]},{"name":"8ba6","type":8,"text":"Let's take the price feature from Renthop dataset and filter by hands the most extreme values for clarity","markups":[]},{"name":"09ad","type":8,"text":"In : price = df.price[(df.price \x3c= 20000) & (df.price \x3e 500)]","markups":[]},{"name":"4dca","type":8,"text":"In : price_log = np.log(price)","markups":[]},{"name":"e0db","type":8,"text":"In : price_mm = MinMaxScaler().fit_transform(price.values.reshape(-1, 1).astype(np.float64)).flatten()","markups":[]},{"name":"a43a","type":8,"text":"A lot of gestures so that sklearn didn't shower us with warnings","markups":[]},{"name":"4ff6","type":8,"text":"In : price_z = StandardScaler().fit_transform(price.values.reshape(-1, 1).astype(np.float64)).flatten()","markups":[]},{"name":"89c2","type":8,"text":"In : sm.qqplot(price_log, loc=price_log.mean(), scale=price_log.std()).savefig('qq_price_log.png')","markups":[]},{"name":"0b7c","type":8,"text":"In : sm.qqplot(price_mm, loc=price_mm.mean(), scale=price_mm.std()).savefig('qq_price_mm.png')","markups":[]},{"name":"9cfd","type":8,"text":"In : sm.qqplot(price_z, loc=price_z.mean(), scale=price_z.std()).savefig('qq_price_z.png')","markups":[]},{"name":"0e0d","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*Sa6wnbq4GNZY4kIP.","originalWidth":640,"originalHeight":480}},{"name":"0e69","type":1,"text":"Q-Q plot of the initial feature","markups":[{"type":2,"start":0,"end":31}]},{"name":"af4c","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*YU-B3B5n3NoVDMmF.","originalWidth":640,"originalHeight":480}},{"name":"423c","type":1,"text":"Q-Q plot after StandardScaler. Shape doesn’t change","markups":[{"type":2,"start":0,"end":51}]},{"name":"5211","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*bbF0MNcLyvls0dSC.","originalWidth":640,"originalHeight":480}},{"name":"3137","type":1,"text":"Q-Q plot after MinMaxScaler. Shape doesn’t change","markups":[{"type":2,"start":0,"end":49}]},{"name":"7921","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*Jt57qDq80k1yr5Sv.","originalWidth":640,"originalHeight":480}},{"name":"f518","type":1,"text":"Q-Q plot after taking the logarithm. Things are getting better!","markups":[{"type":2,"start":0,"end":63}]},{"name":"24ea","type":1,"text":"Let’s see whether transformations can somehow help the real model. There is no silver bullet here.","markups":[]},{"name":"a6ef","type":3,"text":"2.2. Interactions","markups":[]},{"name":"eb52","type":1,"text":"If previous transformations seemed rather math-driven, this part is more about the nature of the data; it can be attributed to both feature transformations and feature creation.","markups":[]},{"name":"fdf8","type":1,"text":"Let’s come back again to the Two Sigma Connect: Rental Listing Inquiries problem. Among the features in this problem are the number of rooms and the price. Logic suggests that the cost per single room is more indicative than the total cost, so we can generate such a feature.","markups":[]},{"name":"9750","type":8,"text":"rooms = df[\"bedrooms\"].apply(lambda x: max(x, .5))","markups":[{"type":1,"start":29,"end":35}]},{"name":"75e6","type":8,"text":"# Avoid division by zero; .5 is chosen more or less arbitrarily","markups":[{"type":1,"start":29,"end":31},{"type":1,"start":44,"end":46}]},{"name":"ef38","type":8,"text":"df[\"price_per_bedroom\"] = df[\"price\"] / rooms","markups":[]},{"name":"e672","type":1,"text":"You should limit yourself in this process. If there are a limited number of features, it is possible to generate all the possible interactions and then weed out the unnecessary ones using the techniques described in the next section. In addition, not all interactions between features must have a physical meaning; for example, polynomial features (see sklearn.preprocessing.PolynomialFeatures) are often used in linear models and are almost impossible to interpret.","markups":[{"type":10,"start":353,"end":393},{"type":3,"start":353,"end":393,"href":"http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html","title":"","rel":"","anchorType":0}]},{"name":"edd4","type":3,"text":"2.3. Filling in the missing values","markups":[]},{"name":"0d04","type":1,"text":"Not many algorithms can work with missing values, and the real world often provides data with gaps. Fortunately, this is one of the tasks for which one doesn’t need any creativity. Both key python libraries for data analysis provide easy-to-use solutions: pandas.DataFrame.fillna and sklearn.preprocessing.Imputer.","markups":[{"type":10,"start":256,"end":279},{"type":10,"start":284,"end":313},{"type":3,"start":256,"end":279,"href":"http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html","title":"","rel":"","anchorType":0},{"type":3,"start":284,"end":313,"href":"http://scikit-learn.org/stable/modules/preprocessing.html#imputation","title":"","rel":"","anchorType":0}]},{"name":"fc46","type":1,"text":"These solutions do not have any magic happening behind the scenes. Approaches to handling missing values are pretty straightforward:","markups":[]},{"name":"78ba","type":9,"text":"encode missing values with a separate blank value like \"n/a\" (for categorical variables);","markups":[{"type":10,"start":55,"end":60}]},{"name":"7aab","type":9,"text":"use the most probable value of the feature (mean or median for the numerical variables, the most common value for categorical variables);","markups":[]},{"name":"6638","type":9,"text":"or, conversely, encode with some extreme value (good for decision-tree models since it allows the model to make a partition between the missing and non-missing values);","markups":[]},{"name":"ec3b","type":9,"text":"for ordered data (e.g. time series), take the adjacent value — next or previous.","markups":[]},{"name":"b878","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*Ps-v8F0fBgmnG36S.","originalWidth":802,"originalHeight":230}},{"name":"0c5c","type":1,"text":"Easy-to-use library solutions sometimes suggest sticking to something like df = df.fillna(0) and not sweat the gaps. But this is not the best solution: data preparation takes more time than building models, so thoughtless gap-filling may hide a bug in processing and damage the model.","markups":[{"type":10,"start":75,"end":92}]},{"name":"4628","type":3,"text":"3. Feature selection","markups":[]},{"name":"ccef","type":1,"text":"Why would it even be necessary to select features? To some, this idea may seem counterintuitive, but there are at least two important reasons to get rid of unimportant features. The first is clear to every engineer: the more data, the higher the computational complexity. As long as we work with toy datasets, the size of the data is not a problem, but, for real loaded production systems, hundreds of extra features will be quite tangible. The second reason is that some algorithms take noise (non-informative features) as a signal and overfit.","markups":[]},{"name":"8c45","type":3,"text":"3.1. Statistical approaches","markups":[]},{"name":"c413","type":1,"text":"The most obvious candidate for removal is a feature whose value remains unchanged, i.e., it contains no information at all. If we build on this thought, it is reasonable to say that features with low variance are worse than those with high variance. So, one can consider cutting features with variance below a certain threshold.","markups":[]},{"name":"c1f8","type":8,"text":"In : from sklearn.feature_selection import VarianceThreshold","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":35},{"type":1,"start":36,"end":42}]},{"name":"f246","type":8,"text":"In : from sklearn.datasets import make_classification","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":26},{"type":1,"start":27,"end":33}]},{"name":"9dd8","type":8,"text":"In : x_data_generated, y_data_generated = make_classification()","markups":[]},{"name":"d956","type":8,"text":"In : x_data_generated.shape Out: (100, 20)","markups":[]},{"name":"70a8","type":8,"text":"In : VarianceThreshold(.7).fit_transform(x_data_generated).shape Out: (100, 19)","markups":[]},{"name":"b153","type":8,"text":"In : VarianceThreshold(.8).fit_transform(x_data_generated).shape Out: (100, 18)","markups":[]},{"name":"c3cf","type":8,"text":"In : VarianceThreshold(.9).fit_transform(x_data_generated).shape Out: (100, 15)","markups":[]},{"name":"07a9","type":1,"text":"There are other ways that are also based on classical statistics.","markups":[{"type":3,"start":35,"end":64,"href":"http://scikit-learn.org/stable/modules/feature_selection.html#univariate-feature-selection","title":"","rel":"","anchorType":0}]},{"name":"fc84","type":8,"text":"In : from sklearn.feature_selection import SelectKBest, f_classif","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":35},{"type":1,"start":36,"end":42}]},{"name":"f5ba","type":8,"text":"In : x_data_kbest = SelectKBest(f_classif, k=5).fit_transform(x_data_generated, y_data_generated)","markups":[]},{"name":"bf29","type":8,"text":"In : x_data_varth = VarianceThreshold(.9).fit_transform(x_data_generated)","markups":[]},{"name":"2a33","type":8,"text":"In : from sklearn.linear_model import LogisticRegression","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":30},{"type":1,"start":31,"end":37}]},{"name":"4ee3","type":8,"text":"In : from sklearn.model_selection import cross_val_score","markups":[{"type":1,"start":5,"end":9},{"type":1,"start":10,"end":33},{"type":1,"start":34,"end":40}]},{"name":"95d9","type":8,"text":"In : cross_val_score(LogisticRegression(), x_data_generated, y_data_generated, scoring='neg_log_loss').mean() Out: -0.45367136377981693","markups":[]},{"name":"1ff0","type":8,"text":"In : cross_val_score(LogisticRegression(), x_data_kbest, y_data_generated, scoring='neg_log_loss').mean() Out: -0.35775228616521798","markups":[]},{"name":"7ea2","type":8,"text":"In : cross_val_score(LogisticRegression(), x_data_varth, y_data_generated, scoring='neg_log_loss').mean() Out: -0.44033042718359772","markups":[]},{"name":"2225","type":1,"text":"We can see that our selected features have improved the quality of the classifier. Of course, this example is purely artificial; however, it is worth using for real problems.","markups":[{"type":2,"start":110,"end":116}]},{"name":"37a9","type":3,"text":"3.2. Selection by modeling","markups":[]},{"name":"a7f8","type":1,"text":"Another approach is to use some baseline model for feature evaluation because the model will clearly show the importance of the features. Two types of models are usually used: some “wooden” composition such as Random Forest or a linear model with Lasso regularization so that it is prone to nullify weights of weak features. The logic is intuitive: if features are clearly useless in a simple model, there is no need to drag them to a more complex one.","markups":[{"type":3,"start":210,"end":223,"href":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-5-ensembles-of-algorithms-and-random-forest-8e05246cbba7","title":"","rel":"","anchorType":0}]},{"name":"b1d9","type":8,"text":"# Synthetic example","markups":[{"type":2,"start":0,"end":19}]},{"name":"6234","type":8,"text":"from sklearn.datasets import make_classification\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.feature_selection import SelectFromModel\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.pipeline import make_pipeline","markups":[{"type":1,"start":0,"end":4},{"type":1,"start":5,"end":21},{"type":1,"start":22,"end":28},{"type":1,"start":49,"end":53},{"type":1,"start":54,"end":74},{"type":1,"start":75,"end":81},{"type":1,"start":101,"end":105},{"type":1,"start":106,"end":122},{"type":1,"start":123,"end":129},{"type":1,"start":153,"end":157},{"type":1,"start":158,"end":183},{"type":1,"start":184,"end":190},{"type":1,"start":207,"end":211},{"type":1,"start":212,"end":235},{"type":1,"start":236,"end":242},{"type":1,"start":259,"end":263},{"type":1,"start":264,"end":280},{"type":1,"start":281,"end":287}]},{"name":"cfe3","type":8,"text":"x_data_generated, y_data_generated = make_classification()","markups":[]},{"name":"bab2","type":8,"text":"pipe = make_pipeline(SelectFromModel(estimator=RandomForestClassifier()), LogisticRegression())","markups":[]},{"name":"c624","type":8,"text":"lr = LogisticRegression()\nrf = RandomForestClassifier()","markups":[]},{"name":"6815","type":8,"text":"print(cross_val_score(lr, x_data_generated, y_data_generated, scoring='neg_log_loss').mean())\nprint(cross_val_score(rf, x_data_generated, y_data_generated, scoring='neg_log_loss').mean())\nprint(cross_val_score(pipe, x_data_generated, y_data_generated, scoring='neg_log_loss').mean())","markups":[{"type":1,"start":0,"end":5},{"type":1,"start":94,"end":99},{"type":1,"start":188,"end":193}]},{"name":"76b8","type":8,"text":"# -0.455661299521484\n# -0.6817083161800542\n# -0.28572375767268404","markups":[]},{"name":"89d1","type":1,"text":"We must not forget that this is not a silver bullet again — it can make the performance worse.","markups":[]},{"name":"4406","type":8,"text":"x_data, y_data = get_data() x_data = x_data.values","markups":[]},{"name":"5642","type":8,"text":"pipe1 = make_pipeline(StandardScaler(), SelectFromModel(estimator=RandomForestClassifier()), LogisticRegression())","markups":[]},{"name":"737a","type":8,"text":"pipe2 = make_pipeline(StandardScaler(), LogisticRegression())","markups":[]},{"name":"0cab","type":8,"text":"rf = RandomForestClassifier()","markups":[]},{"name":"721d","type":8,"text":"print('LR + selection: ', cross_val_score(pipe1, x_data, y_data, scoring='neg_log_loss').mean())\nprint('LR: ', cross_val_score(pipe2, x_data, y_data, scoring='neg_log_loss').mean())\nprint('RF: ', cross_val_score(rf, x_data, y_data, scoring='neg_log_loss').mean())","markups":[{"type":1,"start":0,"end":5},{"type":1,"start":97,"end":102},{"type":1,"start":182,"end":187}]},{"name":"91b6","type":8,"text":"# LR + selection: -0.714208124619\n# LR: -0.669572736183","markups":[]},{"name":"d0c7","type":8,"text":"# It got worse!","markups":[]},{"name":"e8d4","type":8,"text":"# RF: -2.13486716798","markups":[]},{"name":"3615","type":3,"text":"3.3. Grid search","markups":[]},{"name":"20ef","type":1,"text":"Finally, we get to the most reliable method, which is also the most computationally complex: trivial grid search. Train a model on a subset of features, store results, repeat for different subsets, and compare the quality of models to identify the best feature set. This approach is called Exhaustive Feature Selection.","markups":[{"type":3,"start":290,"end":318,"href":"http://rasbt.github.io/mlxtend/user_guide/feature_selection/ExhaustiveFeatureSelector/","title":"","rel":"","anchorType":0}]},{"name":"abd8","type":1,"text":"Searching all combinations usually takes too long, so you can try to reduce the search space. Fix a small number N, iterate through all combinations of N features, choose the best combination, and then iterate through the combinations of (N + 1) features so that the previous best combination of features is fixed and only a single new feature is considered. It is possible to iterate until we hit a maximum number of characteristics or until the quality of the model ceases to increase significantly. This algorithm is called Sequential Feature Selection.","markups":[{"type":3,"start":527,"end":555,"href":"http://rasbt.github.io/mlxtend/user_guide/feature_selection/SequentialFeatureSelector/","title":"","rel":"","anchorType":0}]},{"name":"67c8","type":1,"text":"This algorithm can be reversed: start with the complete feature space and remove features one by one until it does not impair the quality of the model or until the desired number of features is reached.","markups":[]},{"name":"df0d","type":8,"text":"In : selector = SequentialFeatureSelector(LogisticRegression(), scoring='neg_log_loss', verbose=2, k_features=3, forward=False, n_jobs=-1)","markups":[]},{"name":"85b9","type":8,"text":"In : selector.fit(x_data_scaled, y_data)","markups":[]},{"name":"a37c","type":8,"text":"In : selector.fit(x_data_scaled, y_data)","markups":[]},{"name":"0159","type":8,"text":"[2017-03-30 01:42:24] Features: 45/3 -- score: -0.682830838803 [2017-03-30 01:44:40] Features: 44/3 -- score: -0.682779463265 [2017-03-30 01:46:47] Features: 43/3 -- score: -0.682727480522 [2017-03-30 01:48:54] Features: 42/3 -- score: -0.682680521828 [2017-03-30 01:50:52] Features: 41/3 -- score: -0.68264297879\n[2017-03-30 01:52:46] Features: 40/3 -- score: -0.682607753617 [2017-03-30 01:54:37] Features: 39/3 -- score: -0.682570678346 [2017-03-30 01:56:21] Features: 38/3 -- score: -0.682536314625 [2017-03-30 01:58:02] Features: 37/3 -- score: -0.682520258804 [2017-03-30 01:59:39] Features: 36/3 -- score: -0.68250862986\n[2017-03-30 02:01:17] Features: 35/3 -- score: -0.682498213174\n...\n[2017-03-30 02:21:09] Features: 10/3 -- score: -0.68657335969\n[2017-03-30 02:21:18] Features: 9/3 -- score: -0.688405548594\n[2017-03-30 02:21:26] Features: 8/3 -- score: -0.690213724719\n[2017-03-30 02:21:32] Features: 7/3 -- score: -0.692383588303\n[2017-03-30 02:21:36] Features: 6/3 -- score: -0.695321584506\n[2017-03-30 02:21:40] Features: 5/3 -- score: -0.698519960477\n[2017-03-30 02:21:42] Features: 4/3 -- score: -0.704095390444\n[2017-03-30 02:21:44] Features: 3/3 -- score: -0.713788301404","markups":[]},{"name":"97df","type":8,"text":"But improvement couldn’t last forever","markups":[]},{"name":"19bd","type":1,"text":"Take a look how this approach was done in one simple yet elegant Kaggle kernel.","markups":[{"type":3,"start":46,"end":78,"href":"https://www.kaggle.com/arsenyinfo/easy-feature-selection-pipeline-0-55-at-lb","title":"","rel":"","anchorType":0}]},{"name":"fb6a","type":3,"text":"4. Assignment #6","markups":[]},{"name":"a73b","type":1,"text":"A demo version is to appear soon (~ in the end of June 2018). Full version will be available in the new session of the course (starting on October, 1).","markups":[]},{"name":"f387","type":1,"text":"Open Data Science wishes you good luck with the assignment as well as clean data and useful features in your real work!","markups":[]},{"name":"ef18","type":1,"text":"Author: Arseny Kravchenko. Translated and edited by Christina Butsko, Yury Kashnitsky, Anna Larionova, Anastasia Manokhina, Evgeny Sushko, Egor Polusmak, and Yuanyuan Pao.","markups":[{"type":3,"start":8,"end":25,"href":"http://arseny.info/pages/about-me.html","title":"","rel":"","anchorType":0},{"type":3,"start":52,"end":68,"href":"https://www.linkedin.com/in/christinabutsko/","title":"","rel":"nofollow noopener noopener noopener","anchorType":0},{"type":3,"start":70,"end":85,"href":"https://www.linkedin.com/in/festline/","title":"","rel":"noopener nofollow nofollow noopener noopener noopener nofollow noopener noopener noopener noopener","anchorType":0},{"type":3,"start":87,"end":101,"href":"https://www.linkedin.com/in/anna-larionova-74434689/","title":"","rel":"","anchorType":0},{"type":3,"start":103,"end":122,"href":"https://www.linkedin.com/in/anastasiamanokhina/","title":"","rel":"nofollow noopener noopener noopener","anchorType":0},{"type":3,"start":124,"end":137,"href":"https://www.linkedin.com/in/evgenysushko/","title":"","rel":"","anchorType":0},{"type":3,"start":139,"end":152,"href":"https://www.linkedin.com/in/egor-polusmak/","title":"","rel":"noopener nofollow noopener noopener","anchorType":0},{"type":3,"start":158,"end":170,"href":"https://www.linkedin.com/in/yuanyuanpao/","title":"","rel":"noopener nofollow nofollow noopener noopener noopener nofollow noopener noopener noopener","anchorType":0},{"type":2,"start":0,"end":171}]}],"sections":[{"name":"a518","startIndex":0},{"name":"ed84","startIndex":210}]},"postDisplay":{"coverless":true}},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"0*NZRVMpxF8oSBwumh.","filter":"","backgroundSize":"","originalWidth":454,"originalHeight":491,"strategy":"resample","height":0,"width":0},"wordCount":5417,"imageCount":16,"readingTime":21.991509433962264,"subtitle":"In this course, we have already seen several key machine learning algorithms. However, before moving on to the more fancy ones, we’d like…","userPostRelation":{"userId":"a988255767e5","postId":"8b94f870706a","readAt":1525187957327,"readLaterAddedAt":0,"votedAt":0,"collaboratorAddedAt":0,"notesAddedAt":0,"subscribedAt":0,"lastReadSectionName":"a518","lastReadVersionId":"fe8b2afe79f4","lastReadAt":1525187955083,"lastReadParagraphName":"f387","lastReadPercentage":0.99,"viewedAt":1525187578004,"presentedCountInResponseManagement":0,"clapCount":0,"seriesUpdateNotifsOptedInAt":0,"queuedAt":0,"seriesFirstViewedAt":0,"presentedCountInStream":10,"seriesLastViewedAt":0,"audioProgressSec":0},"publishedInCount":1,"usersBySocialRecommends":[],"recommends":96,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"machine-learning","name":"Machine Learning","postCount":35514,"virtuals":{"isFollowing":false},"metadata":{"followerCount":23739,"postCount":35514,"coverImage":{"id":"1*bhFifratH9DjKqMBTeQG5A.gif","originalWidth":1500,"originalHeight":900,"isFeatured":true}},"type":"Tag"},{"slug":"data-science","name":"Data Science","postCount":23313,"virtuals":{"isFollowing":false},"metadata":{"followerCount":14307,"postCount":23313,"coverImage":{"id":"1*bhFifratH9DjKqMBTeQG5A.gif","originalWidth":1500,"originalHeight":900,"isFeatured":true}},"type":"Tag"},{"slug":"feature-engineering","name":"Feature Engineering","postCount":63,"virtuals":{"isFollowing":false},"metadata":{"followerCount":9,"postCount":63,"coverImage":{"id":"1*_ARjrrFLdgNf-vodDI6PDQ.jpeg","originalWidth":1280,"originalHeight":570,"isFeatured":true}},"type":"Tag"},{"slug":"feature-extraction","name":"Feature Extraction","postCount":9,"virtuals":{"isFollowing":false},"metadata":{"followerCount":2,"postCount":9,"coverImage":{"id":"1*GJKOX1vLnasD30VZxuyKAA.png","originalWidth":3320,"originalHeight":1536,"isFeatured":true}},"type":"Tag"},{"slug":"feature-selection","name":"Feature Selection","postCount":7,"virtuals":{"isFollowing":false},"metadata":{"followerCount":0,"postCount":7,"coverImage":{"id":"0*NZRVMpxF8oSBwumh.","originalWidth":454,"originalHeight":491,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":2,"links":{"entries":[{"url":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-4-linear-classification-and-regression-44a41b9b5220","alts":[{"type":2,"url":"medium://p/44a41b9b5220"},{"type":3,"url":"medium://p/44a41b9b5220"}],"httpStatus":200},{"url":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-3-classification-decision-trees-and-k-nearest-neighbors-8613c6b6d2cd","alts":[{"type":2,"url":"medium://p/8613c6b6d2cd"},{"type":3,"url":"medium://p/8613c6b6d2cd"}],"httpStatus":200},{"url":"https://www.linkedin.com/in/anastasiamanokhina/","alts":[],"httpStatus":999},{"url":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-5-ensembles-of-algorithms-and-random-forest-8e05246cbba7","alts":[{"type":2,"url":"medium://p/8e05246cbba7"},{"type":3,"url":"medium://p/8e05246cbba7"}],"httpStatus":200},{"url":"https://inclass.kaggle.com/c/catch-me-if-you-can-intruder-detection-through-webpage-session-tracking","alts":[],"httpStatus":200},{"url":"https://www.linkedin.com/in/yuanyuanpao/","alts":[],"httpStatus":999},{"url":"https://www.linkedin.com/in/festline/","alts":[],"httpStatus":999},{"url":"https://www.linkedin.com/in/egor-polusmak/","alts":[],"httpStatus":999},{"url":"https://www.linkedin.com/in/christinabutsko/","alts":[],"httpStatus":999},{"url":"https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot","alts":[],"httpStatus":200},{"url":"https://en.wikipedia.org/wiki/Tf%E2%80%93idf","alts":[],"httpStatus":200},{"url":"http://rasbt.github.io/mlxtend/user_guide/feature_selection/ExhaustiveFeatureSelector/","alts":[],"httpStatus":200},{"url":"http://rasbt.github.io/mlxtend/user_guide/feature_selection/SequentialFeatureSelector/","alts":[],"httpStatus":200},{"url":"https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html","alts":[],"httpStatus":200},{"url":"http://scikit-image.org/docs/stable/api/skimage.feature.html","alts":[],"httpStatus":200},{"url":"http://scikit-learn.org/stable/modules/feature_selection.html#univariate-feature-selection","alts":[],"httpStatus":200},{"url":"http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html","alts":[],"httpStatus":200},{"url":"http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html","alts":[],"httpStatus":200},{"url":"http://scikit-learn.org/stable/modules/preprocessing.html#imputation","alts":[],"httpStatus":200},{"url":"https://www.linkedin.com/in/evgenysushko/","alts":[],"httpStatus":999},{"url":"https://www.linkedin.com/in/anna-larionova-74434689/","alts":[],"httpStatus":999},{"url":"https://ru.wikipedia.org/wiki/%D0%9B%D0%BE%D0%B3%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5","alts":[],"httpStatus":200},{"url":"https://jaan.io/food2vec-augmented-cooking-machine-intelligence/","alts":[],"httpStatus":200},{"url":"http://pillow.readthedocs.io/en/3.1.x/reference/ImageStat.html","alts":[],"httpStatus":200},{"url":"http://simplecv.readthedocs.io/en/latest/SimpleCV.Features.html","alts":[],"httpStatus":200},{"url":"https://gist.github.com/mesgarpour/f24769cd186e2db853957b10ff6b7a95","alts":[],"httpStatus":200},{"url":"https://github.com/geopy/geopy","alts":[],"httpStatus":200},{"url":"https://github.com/Yorko/mlcourse_open/blob/master/jupyter_english/topic06_features/topic6_feature_engineering_feature_selection.ipynb","alts":[],"httpStatus":200},{"url":"http://arseny.info/pages/about-me.html","alts":[],"httpStatus":200},{"url":"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language","alts":[],"httpStatus":200},{"url":"https://github.com/madmaze/pytesseract","alts":[],"httpStatus":200},{"url":"https://github.com/blue-yonder/tsfresh","alts":[],"httpStatus":200},{"url":"https://www.kaggle.com/c/two-sigma-connect-rental-listing-inquiries","alts":[],"httpStatus":200},{"url":"https://github.com/3Top/word2vec-api#where-to-get-a-pretrained-models","alts":[],"httpStatus":200},{"url":"http://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html","alts":[],"httpStatus":200},{"url":"http://www.interdigital.com/download/58540a46e3b9659c9f000372","alts":[],"httpStatus":200},{"url":"https://www.kaggle.com/arsenyinfo/easy-feature-selection-pipeline-0-55-at-lb","alts":[],"httpStatus":200},{"url":"https://www.kaggle.com/xiaoml/talkingdata-mobile-user-demographics/bag-of-app-id-python-2-27392","alts":[],"httpStatus":200},{"url":"https://habrahabr.ru/post/208092/","alts":[{"type":3,"url":"habrahabr://post/208092"}],"httpStatus":200},{"url":"https://habrahabr.ru/post/216295/","alts":[{"type":3,"url":"habrahabr://post/216295"}],"httpStatus":200}],"version":"0.3","generatedAt":1525725930269},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":1711,"sectionCount":2,"readingList":0},"coverless":true,"slug":"open-machine-learning-course-topic-6-feature-engineering-and-feature-selection","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"0*NZRVMpxF8oSBwumh.","originalWidth":454,"originalHeight":491,"isFeatured":true}},{"name":"0152","type":3,"text":"Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a","approvedHomeCollectionId":"b76595fb6cfc","approvedHomeCollection":{"id":"b76595fb6cfc","name":"Open Machine Learning Course","slug":"open-machine-learning-course","tags":["MACHINE LEARNING","DATA SCIENCE","DATA ANALYSIS","EDUCATION","KAGGLE"],"creatorId":"5572ec600139","description":"A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.","shortDescription":"A series of articles on basics of Machine Learning.","image":{"imageId":"1*b5pfoCQz20rjh79OPSQWQg.jpeg","filter":"","backgroundSize":"","originalWidth":271,"originalHeight":271,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":1490,"activeAt":1523869737051},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":true,"isNewsletterSubscribed":true,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*MxsqShnPs3RXMScwl5HhsQ.jpeg","filter":"","backgroundSize":"","originalWidth":1479,"originalHeight":822,"strategy":"resample","height":0,"width":0},"twitterUsername":"odsai_en","facebookPageName":"DataChallenges","publicEmail":"yury.kashnitsky@gmail.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":6,"number":10,"postIds":[]}}],"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF02B875","point":0},{"color":"#FF00AB6B","point":0.1},{"color":"#FF1C9963","point":0.2},{"color":"#FF092E20","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFE9FDF0","point":0.1},{"color":"#FFE2FAEE","point":0.2},{"color":"#FFADFFCF","point":0.6},{"color":"#FF7DFFB3","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"},"newsletterId":"","webCanonicalUrl":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a","mediumUrl":"https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-6-feature-engineering-and-feature-selection-8b94f870706a","migrationId":"","notifyFollowers":true,"notifyTwitter":true,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"featureLockRequestMinimumGuaranteeAmount":0,"isElevate":false,"mongerRequestType":1,"type":"Post"},"mentionedUsers":[],"collaborators":[],"membershipPlans":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"e64a1ed25336":{"userId":"e64a1ed25336","name":"Arseny Kravchenko","username":"arseny_info","createdAt":1395741064924,"lastPostCreatedAt":1520804193033,"imageId":"1*uf2wBS0ahK7CUnFXEFM63g.jpeg","backgroundImageId":"","bio":"Sceptical data cruncher.","twitterScreenName":"arseny_info","socialStats":{"userId":"e64a1ed25336","usersFollowedCount":80,"usersFollowedByCount":256,"type":"SocialStats"},"social":{"userId":"a988255767e5","targetUserId":"e64a1ed25336","type":"Social"},"facebookAccountId":"","allowNotes":1,"isNsfw":false,"type":"User"}},"Collection":{"b76595fb6cfc":{"id":"b76595fb6cfc","name":"Open Machine Learning Course","slug":"open-machine-learning-course","tags":["MACHINE LEARNING","DATA SCIENCE","DATA ANALYSIS","EDUCATION","KAGGLE"],"creatorId":"5572ec600139","description":"A series of articles on basics of Machine Learning. Each article is followed by an assignment with a deadline. Several Kaggle Inclass competitions are held throughout the course.","shortDescription":"A series of articles on basics of Machine Learning.","image":{"imageId":"1*b5pfoCQz20rjh79OPSQWQg.jpeg","filter":"","backgroundSize":"","originalWidth":271,"originalHeight":271,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":1490,"activeAt":1523869737051},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false},"isSubscribed":true,"isNewsletterSubscribed":true,"memberOfMembershipPlanId":"","isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*MxsqShnPs3RXMScwl5HhsQ.jpeg","filter":"","backgroundSize":"","originalWidth":1479,"originalHeight":822,"strategy":"resample","height":0,"width":0},"twitterUsername":"odsai_en","facebookPageName":"DataChallenges","publicEmail":"yury.kashnitsky@gmail.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":6,"number":10,"postIds":[]}}],"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF02B875","point":0},{"color":"#FF00AB6B","point":0.1},{"color":"#FF1C9963","point":0.2},{"color":"#FF092E20","point":1}],"backgroundColor":"#FFFFFFFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFFFFFFF","point":0},{"color":"#FFE9FDF0","point":0.1},{"color":"#FFE2FAEE","point":0.2},{"color":"#FFADFFCF","point":0.6},{"color":"#FF7DFFB3","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Open Machine Learning Course","description":"by OpenDataScience","backgroundImage":{"id":"1*ZnqNzhbOlqb19tLgWDn8ww.png","originalWidth":2400,"originalHeight":1200},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"}},"Social":{"e64a1ed25336":{"userId":"a988255767e5","targetUserId":"e64a1ed25336","type":"Social"}},"SocialStats":{"e64a1ed25336":{"userId":"e64a1ed25336","usersFollowedCount":80,"usersFollowedByCount":256,"type":"SocialStats"}}}})
// ]]></script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/main-common-async.bundle.8XzrsTBv650SH5jN4fxn-w.js"></script><script charset="UTF-8" src="./Open Machine Learning Course. Topic 6. Feature Engineering and Feature Selection_files/main-notes.bundle.0wfedgTNnhCPCkt5jNAAMA.js"></script></body></html>